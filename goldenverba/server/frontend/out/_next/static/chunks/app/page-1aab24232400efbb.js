(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8170:function(e,t,s){Promise.resolve().then(s.bind(s,9249))},9249:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return e5}});var l=s(7437),a=s(3786),n=s(2265);let r={DONE:"bg-secondary-verba",ERROR:"bg-warning-verba",READY:"bg-button-verba",STARTING:"bg-button-verba",CHUNKING:"bg-button-verba",LOADING:"bg-button-verba",EMBEDDING:"bg-button-verba",INGESTING:"bg-button-verba",NER:"bg-button-verba",EXTRACTION:"bg-button-verba",SUMMARIZING:"bg-button-verba",WAITING:"bg-button-verba"},i={DONE:"Finished",ERROR:"Failed",READY:"Ready",STARTING:"Importing...",CHUNKING:"Chunking...",LOADING:"Loading...",EMBEDDING:"Embedding...",INGESTING:"Weaviating...",NER:"Extracting NER...",EXTRACTION:"Extraction REL...",SUMMARIZING:"Summarizing...",WAITING:"Uploading..."},c={theme_name:"light",title:{text:"Verba",type:"text",description:"Application title"},subtitle:{text:"Your AI-powered document assistant",type:"text",description:"Application subtitle"},intro_message:{text:"Ask me anything about your documents",type:"text",description:"Introduction message"},image:{src:"/verba.png",type:"image",description:"Application logo"},primary_color:{color:"#000000",type:"color",description:"Primary color"},secondary_color:{color:"#ffffff",type:"color",description:"Secondary color"},warning_color:{color:"#ff0000",type:"color",description:"Warning color"},bg_color:{color:"#ffffff",type:"color",description:"Background color"},bg_alt_color:{color:"#f0f0f0",type:"color",description:"Alternate background color"},text_color:{color:"#111111",type:"color",description:"Text color"},text_alt_color:{color:"#222222",type:"color",description:"Alternate text color"},button_text_color:{color:"#333333",type:"color",description:"Button text color"},button_text_alt_color:{color:"#444444",type:"color",description:"Alternate button text color"},button_color:{color:"#555555",type:"color",description:"Button color"},button_hover_color:{color:"#666666",type:"color",description:"Button hover color"},font:{type:"select",value:"Plus_Jakarta_Sans",description:"Text Font",options:["Inter","Plus_Jakarta_Sans","Open_Sans","PT_Mono"]},theme:"light"},o={...c,theme_name:"dark",theme:"dark",bg_color:{color:"#111111",type:"color",description:"Background color"},bg_alt_color:{color:"#222222",type:"color",description:"Alternate background color"},text_color:{color:"#ffffff",type:"color",description:"Text color"},text_alt_color:{color:"#eeeeee",type:"color",description:"Alternate text color"}},d={...c,theme_name:"weaviate",primary_color:{color:"#FF6D85",type:"color",description:"Primary color"}},x={...c,theme_name:"wcd",primary_color:{color:"#00A6D6",type:"color",description:"Primary color"}};var u=s(6615),m=s(5674),g=s(7230),f=s(3816),p=s(7763),h=s(476),b=e=>{let{title:t="",key:s="Button".concat(t),Icon:a,onClick:n=()=>{},onMouseEnter:r=()=>{},onMouseLeave:i=()=>{},disabled:c=!1,className:o="",text_class_name:d="",selected:x=!1,selected_color:u="bg-button-verba",selected_text_color:m="text-text-verba-button",text_size:g="text-sm",icon_size:f=15,type:p="button",loading:h=!1,circle:b=!1,button_size:v="",onClickParams:j=[]}=e;return(0,l.jsx)("button",{type:p,className:"".concat(o," btn rounded-lg flex-grow items-center justify-center border-none ").concat(b?"btn-circle":""," ").concat(v," hover:bg-button-hover-verba hover:text-text-verba-button ").concat(x?"".concat(u," shadow-md ").concat(m):" bg-button-verba shadow-none text-text-alt-verba-button"," ").concat(c?"opacity-50 cursor-not-allowed":""),onClick:e=>!c&&n(e,...j),disabled:c,onMouseEnter:r,onMouseLeave:i,children:h?(0,l.jsx)("span",{className:"text-text-verba-button loading loading-spinner loading-sm"}):(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[a&&(0,l.jsx)(a,{size:f,className:"w-[20px]"}),t&&(0,l.jsx)("p",{title:t,className:"".concat(g," ").concat(d),children:t})]})})},s)},v=s(3417),j=s(2489),N=s(1810),w=s(7157);function y(e){let{runId:t,onSubmit:s}=e,[a,r]=(0,n.useState)(!1),[i,c]=(0,n.useState)(null),[o,d]=(0,n.useState)(""),x=e=>{"positive"===e?(s(t,e,""),u()):c("negative")},u=()=>{r(!1),c(null),d("")};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b,{title:"Feedback",Icon:v.Z,onClick:()=>r(!0),selected:!1,disabled:!t}),a&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("dialog",{className:"bg-bg-alt-verba rounded-lg p-6 w-96 relative","aria-labelledby":"feedback-title",open:!0,children:[(0,l.jsx)(b,{Icon:j.Z,onClick:u,className:"absolute right-2 top-2",selected:!1,disabled:!1}),(0,l.jsx)("h2",{id:"feedback-title",className:"text-xl font-bold mb-4",children:null===i?"Was this helpful?":"What could we improve?"}),null===i?(0,l.jsxs)("div",{className:"flex justify-center space-x-4 mt-4",children:[(0,l.jsx)(b,{title:"Yes",Icon:N.Z,onClick:()=>x("positive"),selected:!1,disabled:!1,selected_color:"bg-success-verba"}),(0,l.jsx)(b,{title:"No",Icon:w.Z,onClick:()=>x("negative"),selected:!1,disabled:!1,selected_color:"bg-error-verba"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("textarea",{placeholder:"Please provide your feedback...",value:o,onChange:e=>{d(e.target.value)},className:"w-full p-2 rounded bg-bg-verba text-text-verba mt-4"}),(0,l.jsx)(b,{title:"Submit Feedback",onClick:()=>{i&&s(t,i,o),u()},className:"w-full mt-4",selected:!1,disabled:!1,selected_color:"bg-primary-verba"})]})]})})]})}var S=s(257);let C=async e=>{try{return(await fetch(e)).ok}catch(t){return console.error("Failed to fetch from ".concat(e,":"),t),!1}},k=async()=>{{let e=window.location.origin;if(!e.includes("localhost")&&await C("/api/health"))return e}let e=S.env.NEXT_PUBLIC_VERBA_API_URL;if(e&&await C("".concat(e,"/api/health")))return e;if(window.location.origin.includes("localhost")&&await C("http://localhost:8000/api/health"))return"http://localhost:8000";if(await C("/api/health"))return window.location.origin;throw Error("All health checks failed, please check the Verba Server")},_=async e=>{try{let t=await k(),s=await fetch("".concat(t).concat(e),{method:"GET"}),l=await s.json();return l||console.warn("Could not retrieve data from ".concat(e)),l}catch(t){return console.error("Failed to fetch data from ".concat(e,":"),t),null}},E=()=>_("/api/health"),I=async(e,t,s)=>{let l=await k(),a=await fetch("".concat(l,"/api/connect"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credentials:{deployment:e,url:t,key:s}})});return await a.json()},R=async e=>{try{let t=await k(),s=await fetch("".concat(t,"/api/get_rag_config"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await s.json()}catch(e){return console.error("Error retrieving content",e),null}},D=async(e,t)=>{if(!e)return!1;try{let s=await k(),l=await fetch("".concat(s,"/api/set_rag_config"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ragConfig:e,credentials:t})});return 200===l.status}catch(e){return console.error("Error setting config:",e),!1}},O=async(e,t,s)=>{try{let l=await k(),a=await fetch("".concat(l,"/api/set_theme_config"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({themes:e,theme:t,credentials:s})});return 200===a.status}catch(e){return console.error("Error setting config:",e),!1}},T=async(e,t,s,l,a)=>{try{let n=await k(),r=await fetch("".concat(n,"/api/query"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,rag:t,labels:s,documentFilter:l,credentials:a})});return await r.json()}catch(e){return console.error("Error sending query",e),null}},A=async(e,t)=>{if(!e)return null;try{let s=await k(),l=await fetch("".concat(s,"/api/get_document"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:e,credentials:t})});return await l.json()}catch(e){return console.error("Error retrieving selected document",e),null}},M=async(e,t,s)=>{try{let l=await k(),a=await fetch("".concat(l,"/api/get_datacount"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embeddingModel:e,documentFilter:t,credentials:s})});return await a.json()}catch(e){return console.error("Error retrieving content",e),null}},F=async e=>{try{let t=await k(),s=await fetch("".concat(t,"/api/get_labels"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await s.json()}catch(e){return console.error("Error retrieving content",e),null}},z=async(e,t,s,l)=>{if(!e)return null;try{let a=await k(),n=await fetch("".concat(a,"/api/get_content"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:e,page:t,chunkScores:s,credentials:l})});return await n.json()}catch(e){return console.error("Error retrieving content",e),null}},P=async(e,t,s)=>{if(!e)return null;try{let l=await k(),a=await fetch("".concat(l,"/api/get_vectors"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:e,showAll:t,credentials:s})});return await a.json()}catch(e){return console.error("Error retrieving content",e),null}},L=async(e,t,s,l)=>{if(!e)return null;try{let a=await k(),n=await fetch("".concat(a,"/api/get_chunks"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:e,page:t,pageSize:s,credentials:l})});return await n.json()}catch(e){return console.error("Error retrieving content",e),null}},U=async(e,t,s)=>{if(!e)return null;try{let l=await k(),a=await fetch("".concat(l,"/api/get_chunk"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:e,embedder:t,credentials:s})});return await a.json()}catch(e){return console.error("Error retrieving content",e),null}},J=async(e,t,s,l,a)=>{try{let n=await k(),r=await fetch("".concat(n,"/api/get_all_documents"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,labels:t,page:s,pageSize:l,credentials:a})});return await r.json()}catch(e){return console.error("Error retrieving all documents",e),null}},G=async(e,t)=>{try{let s=await k(),l=await fetch("".concat(s,"/api/delete_document"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:e,credentials:t})});return 200===l.status}catch(e){return console.error("Error deleting document",e),!1}},W=async(e,t)=>{try{let s=await k(),l=await fetch("".concat(s,"/api/reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetMode:e,credentials:t})});return 200===l.status}catch(e){return console.error("Error deleting all documents",e),!1}},B=async e=>{try{let t=await k(),s=await fetch("".concat(t,"/api/get_meta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await s.json()}catch(e){return console.error("Error retrieving selected document",e),null}},q=async(e,t,s)=>{try{let l=await k(),a=await fetch("".concat(l,"/api/get_suggestions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,limit:t,credentials:s})});return await a.json()}catch(e){return console.error("Error retrieving suggestions",e),null}},V=async(e,t)=>{try{let s=await k(),l=await fetch("".concat(s,"/api/delete_suggestion"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:e,credentials:t})});return 200===l.status}catch(e){return console.error("Error deleting suggestion",e),!1}},H=async(e,t,s)=>{try{let l=await k(),a=await fetch("".concat(l,"/api/get_all_suggestions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({page:e,pageSize:t,credentials:s})});return await a.json()}catch(e){return console.error("Error retrieving all suggestions",e),null}};var Q=s(2608),K=s.n(Q),Y=s(8268),$=s.n(Y),X=s(1292),Z=s.n(X),ee=s(4352),et=s.n(ee);K(),$(),Z(),et();let es=()=>{let e="https:"===window.location.protocol?"wss:":"ws:",t=window.location.host;return"".concat(e,"//").concat(t,"/ws/generate_stream")},el=e=>{let t=e||document.activeElement;t&&t instanceof HTMLElement&&t.blur()},ea=()=>{let e="https:"===window.location.protocol?"wss:":"ws:",t=window.location.host;return"".concat(e,"//").concat(t,"/ws/import_files")};function en(e,t){new Date().toISOString()}class er{on(e,t){var s;this.listeners.has(e)||this.listeners.set(e,new Set),null===(s=this.listeners.get(e))||void 0===s||s.add(t)}off(e,t){var s;null===(s=this.listeners.get(e))||void 0===s||s.delete(t)}emit(e){for(var t=arguments.length,s=Array(t>1?t-1:0),l=1;l<t;l++)s[l-1]=arguments[l];let a=this.listeners.get(e);a&&a.forEach(t=>{try{t(...s)}catch(t){console.error("Error in ".concat(e," handler:"),t)}})}connect(){var e;if(!this.isDestroyed&&(null===(e=this.ws)||void 0===e?void 0:e.readyState)!==WebSocket.OPEN){this.updateState("CONNECTING");try{let e=es(),t="".concat(e).concat(this.endpoint);this.ws=new WebSocket(t),this.setupEventHandlers()}catch(e){console.error("Failed to create WebSocket:",e),this.handleReconnect()}}}setupEventHandlers(){this.ws&&(this.ws.onopen=()=>{this.updateState("CONNECTED"),this.retryCount=0,this.startHeartbeat(),this.flushMessageQueue(),this.emit("open")},this.ws.onmessage=e=>{try{let t=JSON.parse(e.data);if("pong"===t.type){this.emit("pong");return}this.emit("message",t)}catch(e){console.error("Failed to parse WebSocket message:",e),this.emit("error",e)}},this.ws.onerror=e=>{console.error("WebSocket error:",e),this.updateState("ERROR"),this.emit("error",e)},this.ws.onclose=e=>{if(this.stopHeartbeat(),e.wasClean||this.isDestroyed){this.updateState("DISCONNECTED"),this.emit("close",e);return}this.config.reconnectOnError&&this.retryCount<this.config.maxRetries?this.handleReconnect():(this.updateState("DISCONNECTED"),this.emit("close",e))})}handleReconnect(){if(this.isDestroyed||this.reconnectTimer)return;this.updateState("RECONNECTING"),this.retryCount++;let e=Math.min(this.config.initialRetryDelay*2**(this.retryCount-1),this.config.maxRetryDelay);this.reconnectTimer=setTimeout(()=>{this.reconnectTimer=null,this.connect()},e+.3*Math.random()*e)}send(e){var t;let s={id:crypto.randomUUID(),data:e,timestamp:Date.now(),retries:0};if((null===(t=this.ws)||void 0===t?void 0:t.readyState)===WebSocket.OPEN)try{this.ws.send(JSON.stringify(e)),this.emit("sent",s)}catch(e){console.error("Failed to send message:",e),this.queueMessage(s)}else this.queueMessage(s)}queueMessage(e){if(this.messageQueue.push(e),this.messageQueue.length>this.config.messageQueueSize){let e=this.messageQueue.shift();this.emit("messageDropped",e)}this.emit("messageQueued",e)}flushMessageQueue(){for(var e;this.messageQueue.length>0&&(null===(e=this.ws)||void 0===e?void 0:e.readyState)===WebSocket.OPEN;){let e=this.messageQueue.shift();if(!e)break;try{this.ws.send(JSON.stringify(e.data)),this.emit("sent",e)}catch(t){console.error("Failed to send queued message:",t),e.retries++,e.retries<3?this.messageQueue.unshift(e):this.emit("messageDropped",e);break}}}startHeartbeat(){this.stopHeartbeat(),this.heartbeatTimer=setInterval(()=>{var e;(null===(e=this.ws)||void 0===e?void 0:e.readyState)===WebSocket.OPEN&&this.send({type:"ping"})},this.config.heartbeatInterval)}stopHeartbeat(){this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null)}updateState(e){if(this.connectionState!==e){let t=this.connectionState;this.connectionState=e,this.emit("stateChange",e,t)}}getState(){return this.connectionState}isConnected(){var e;return(null===(e=this.ws)||void 0===e?void 0:e.readyState)===WebSocket.OPEN}disconnect(){this.isDestroyed=!0,this.stopHeartbeat(),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.ws&&(this.ws.close(1e3,"Client disconnect"),this.ws=null),this.messageQueue=[],this.listeners.clear(),this.updateState("DISCONNECTED")}getQueueSize(){return this.messageQueue.length}clearQueue(){this.messageQueue=[],this.emit("queueCleared")}reconnect(){this.retryCount=0,this.ws&&this.ws.close(),this.connect()}constructor(e,t={}){var s,l,a,n,r,i;this.ws=null,this.retryCount=0,this.heartbeatTimer=null,this.reconnectTimer=null,this.messageQueue=[],this.isDestroyed=!1,this.connectionState="DISCONNECTED",this.listeners=new Map,this.endpoint=e,this.config={maxRetries:null!==(s=t.maxRetries)&&void 0!==s?s:5,initialRetryDelay:null!==(l=t.initialRetryDelay)&&void 0!==l?l:1e3,maxRetryDelay:null!==(a=t.maxRetryDelay)&&void 0!==a?a:3e4,heartbeatInterval:null!==(n=t.heartbeatInterval)&&void 0!==n?n:3e4,reconnectOnError:null===(r=t.reconnectOnError)||void 0===r||r,messageQueueSize:null!==(i=t.messageQueueSize)&&void 0!==i?i:100}}}var ei=e=>{let{tooltip_text:t,display_text:s}=e,[a,r]=(0,n.useState)(!1);return(0,l.jsxs)("div",{className:"items-center gap-2 flex",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(b,{title:"",Icon:m.LL$,icon_size:10,disabled:!1,selected:!1,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),circle:!0,button_size:"btn-xs"}),(0,l.jsx)("div",{className:"absolute left-full z-30 p-4 bg-bg-verba text-text-alt-verba text-xs rounded-xl shadow-md w-[300px] transition-opacity duration-300 ".concat(a?"opacity-100":"opacity-0 pointer-events-none"),children:(0,l.jsx)("p",{className:"w-full whitespace-normal",children:t})})]}),(0,l.jsx)("p",{className:"text-sm text-text-alt-verba truncate max-w-[350px]",title:s,children:s})]})},ec=s(9270);let eo=e=>{let{values:t,configTitle:s,updateConfig:a,componentName:r,blocked:i}=e,[c,o]=(0,n.useState)(""),[d,x]=(0,n.useState)(t);(0,n.useEffect)(()=>{a(r,s,d)},[r,s,d,a]);let u=e=>{d.includes(e)||(x(t=>[...t,e]),o(""))},g=e=>{d.includes(e)&&x(t=>t.filter(t=>t!==e))};return(0,l.jsxs)("div",{className:"flex flex-col w-full gap-2",children:[(0,l.jsxs)("div",{className:"flex gap-2 justify-between",children:[(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow w-full",disabled:i,value:c,onChange:e=>{o(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),u(c))}})}),(0,l.jsxs)("button",{onClick:()=>{u(c)},disabled:i,className:"btn flex gap-2 bg-button-verba border-none hover:bg-secondary-verba text-text-verba",children:[(0,l.jsx)(f.Kth,{size:15}),(0,l.jsx)("p",{children:"Add"})]})]}),(0,l.jsx)("div",{className:"grid grid-cols-3 gap-2",children:t.map((e,t)=>(0,l.jsxs)("div",{className:"flex bg-bg-verba w-full p-2 text-center text-sm text-text-verba justify-between items-center rounded-xl",children:[(0,l.jsx)("div",{className:"flex w-full justify-center items-center overflow-hidden",children:(0,l.jsx)("p",{className:"truncate",title:e,children:e})}),(0,l.jsx)("button",{disabled:i,onClick:()=>{g(e)},className:"btn btn-sm btn-square bg-button-verba border-none hover:bg-warning-verba text-text-verba ml-2",children:(0,l.jsx)(m.Xm5,{size:12})})]},e+t))})]})};var ed=e=>{let{ragConfig:t,componentName:s,selectComponent:a,updateConfig:r,saveComponentConfig:i,blocked:c,skipComponent:o}=e,[d,x]=(0,n.useState)(0);return((0,n.useEffect)(()=>{x(e=>e+1)},[t]),0===Object.entries(t[s].components[t[s].selected].config).length&&o)?(0,l.jsx)(l.Fragment,{}):(0,l.jsxs)("div",{className:"flex flex-col justify-start gap-3 rounded-2xl p-1 w-full ",children:[(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{className:"divider text-text-alt-verba flex-grow text-xs lg:text-sm",children:[(0,l.jsxs)("p",{children:[t[s].selected," Settings"]}),(0,l.jsx)(b,{title:"Save",className:"btn-sm lg:text-sm text-xs",text_size:"",onClick:()=>{i(s,t[s].selected,t[s].components[t[s].selected])}})]})}),!o&&(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:"flex gap-2 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw] lg:text-base text-sm",children:s}),(0,l.jsxs)("div",{className:"dropdown dropdown-bottom flex justify-start items-center w-full",children:[(0,l.jsxs)("button",{tabIndex:0,disabled:c,className:"btn bg-button-verba hover:bg-button-hover-verba text-text-verba w-full flex justify-start border-none",children:[(0,l.jsx)(ec.WMq,{size:15}),(0,l.jsx)("p",{children:t[s].selected})]}),(0,l.jsx)("ul",{className:"dropdown-content menu bg-base-100 rounded-box z-[1] w-full p-2 shadow",children:Object.entries(t[s].components).filter(e=>{let[t,s]=e;return s.available}).map(e=>{let[t,n]=e;return(0,l.jsx)("li",{onClick:()=>{c||(a(s,n.name),el())},children:(0,l.jsx)("a",{children:n.name})},"ComponentDropdown_".concat(n.name))})})]})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]"}),(0,l.jsx)("p",{className:"lg:text-sm text-xs text-text-alt-verba text-start",children:t[s].components[t[s].selected].description})]})]}),Object.entries(t[s].components[t[s].selected].config).map(e=>{let[a,n]=e;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex gap-3 justify-between items-center text-text-verba lg:text-base text-sm",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:a}),"dropdown"===n.type&&(0,l.jsxs)("div",{className:"dropdown dropdown-bottom flex justify-start items-center w-full",children:[(0,l.jsxs)("button",{tabIndex:0,disabled:c,className:"btn bg-button-verba hover:bg-button-hover-verba text-text-verba w-full flex justify-start border-none",children:[(0,l.jsx)(ec.WMq,{size:15}),(0,l.jsx)("p",{children:n.value})]}),(0,l.jsx)("ul",{className:"dropdown-content menu bg-base-100 max-h-[20vh] overflow-auto rounded-box z-[1] w-full p-2 shadow",children:function(e,t){var a,n,i;let o=null===(a=e[s])||void 0===a?void 0:a.selected;if(!o)return[];let d=null===(n=e[s])||void 0===n?void 0:n.components[o];return(null==d?void 0:null===(i=d.config[t])||void 0===i?void 0:i.values)?d.config[t].values.map(e=>(0,l.jsx)("li",{className:"lg:text-base text-sm",onClick:()=>{c||(r(s,t,e),el())},children:(0,l.jsx)("a",{children:e})},"ConfigValue".concat(e))):[]}(t,a)})]}),"boolean"!=typeof n.value&&["text","number","password"].includes(n.type)&&(0,l.jsx)("label",{className:"input flex text-sm items-center gap-2 w-full bg-bg-verba",children:(0,l.jsx)("input",{type:n.type,className:"grow w-full",value:n.value,onChange:e=>{c||r(s,a,e.target.value)}})}),"boolean"!=typeof n.value&&"multi"===n.type&&(0,l.jsx)(eo,{componentName:s,values:n.values||[],configTitle:a,updateConfig:r,blocked:c}),"bool"===n.type&&(0,l.jsxs)("div",{className:"flex gap-5 justify-start items-center w-full my-4",children:[(0,l.jsx)("p",{className:"lg:text-sm text-xs text-text-alt-verba text-start w-[250px]",children:n.description}),(0,l.jsx)("input",{type:"checkbox",className:"checkbox checkbox-md",onChange:e=>{c||r(s,a,e.target.checked)},checked:"boolean"==typeof n.value&&n.value})]})]}),"bool"!==n.type&&(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]"}),(0,l.jsx)("p",{className:"lg:text-sm text-xs text-text-alt-verba text-start",children:n.description})]})]},"Configuration".concat(a).concat(s))})]})},ex=e=>{let{ragConfig:t,setRAGConfig:s,addStatusMessage:a,onSave:r,credentials:i,onReset:c,production:o}=e,d=(e,t,l)=>{s(s=>{if(s){let a=JSON.parse(JSON.stringify(s));return"string"==typeof l||"boolean"==typeof l?a[e].components[a[e].selected].config[t].value=l:a[e].components[a[e].selected].config[t].values=l,a}return s})},x=(e,t)=>{s(s=>{if(s){let l=JSON.parse(JSON.stringify(s));return l[e].selected=t,l}return s})},u=(0,n.useCallback)(async(e,l,n)=>{if(!t)return;a("Saving ".concat(l," Config"),"SUCCESS");let r=JSON.parse(JSON.stringify(t));r[e].selected=l,r[e].components[l]=n,await D(r,i)&&s(r)},[t,a,i,s]);return t?(0,l.jsxs)("div",{className:"flex flex-col justify-start rounded-2xl w-full p-4 ",children:[(0,l.jsx)("div",{className:"sticky flex flex-col gap-2 w-full top-0 z-20 justify-end",children:(0,l.jsxs)("div",{className:"flex justify-end w-full gap-2 p-4 bg-bg-alt-verba rounded-lg",children:[(0,l.jsx)(b,{Icon:f.zfW,title:"Save Config",onClick:r,className:"max-w-[150px]",disabled:"Demo"===o}),(0,l.jsx)(b,{Icon:p.B4e,title:"Reset",onClick:c,className:"max-w-[150px]",disabled:"Demo"===o})]})}),(0,l.jsxs)("div",{className:"flex flex-col justify-start gap-3 rounded-2xl w-full p-6 ",children:[(0,l.jsx)(ed,{ragConfig:t,componentName:"Embedder",selectComponent:x,updateConfig:d,saveComponentConfig:u,blocked:"Demo"===o}),(0,l.jsx)(ed,{ragConfig:t,componentName:"Generator",selectComponent:x,updateConfig:d,saveComponentConfig:u,blocked:"Demo"===o})," ",(0,l.jsx)(ed,{ragConfig:t,componentName:"Retriever",selectComponent:x,updateConfig:d,saveComponentConfig:u,blocked:"Demo"===o})]})]}):(0,l.jsx)("div",{})},eu=s(2561),em=s(3326),eg=s(9549),ef=e=>{let{message:t,selectedTheme:s,selectedDocument:a,setSelectedDocument:r,messageIndex:i,setSelectedDocumentScore:c,setSelectedChunkScore:o}=e,[d,x]=(0,n.useState)(!1),[g,p]=(0,n.useState)(!1),[h,v]=(0,n.useState)(!1),[j,N]=(0,n.useState)(!1),[w,y]=(0,n.useState)(!1);if("string"==typeof t.content){let e,a,n;return(0,l.jsx)("div",{className:"flex items-end gap-2 ".concat("user"===t.type?"justify-end":"justify-start"),children:(0,l.jsxs)("div",{className:"flex flex-col items-start p-5 rounded-3xl animate-press-in text-sm lg:text-base ".concat({user:"bg-bg-verba",system:"bg-bg-alt-verba",error:"bg-warning-verba",retrieval:"bg-bg-verba",thinking:"bg-blue-50 dark:bg-blue-900/20"}[t.type]," ").concat(t.isThinking?"border-2 border-blue-300 dark:border-blue-600":""),children:[t.cached&&(0,l.jsx)(m.i1q,{size:12,className:"text-text-verba"}),t.isThinking&&(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2 text-blue-600 dark:text-blue-400",children:[(0,l.jsx)(m.Qkp,{size:16}),(0,l.jsx)("span",{className:"text-xs font-semibold",children:"Thinking..."})]}),t.structured&&(e=t.structured,(0,l.jsxs)("div",{className:"space-y-4",children:[e.provider&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[(0,l.jsx)(em.$Oz,{size:14}),(0,l.jsxs)("span",{children:["Powered by ",e.provider.toUpperCase()]}),e.model_name&&(0,l.jsxs)("span",{children:["• ",e.model_name]})]}),e.confidence_level&&(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Confidence:"}),(a=e.confidence_level,(0,l.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat({high:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",low:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",unknown:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}[a]),children:a.toUpperCase()}))]}),e.extended_thinking&&(0,l.jsxs)("div",{className:"p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-700",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-purple-700 dark:text-purple-300 mb-2",children:[(0,l.jsx)(m.Qkp,{size:14}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"Extended Thinking"})]}),(0,l.jsx)("p",{className:"text-sm text-purple-800 dark:text-purple-200",children:e.extended_thinking})]}),(0,l.jsx)("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:(0,l.jsx)(eg.D,{children:e.answer})}),e.key_insights&&e.key_insights.length>0&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("button",{type:"button",onClick:()=>v(!h),className:"flex items-center gap-2 text-sm text-yellow-600 dark:text-yellow-400 hover:text-yellow-700 dark:hover:text-yellow-300 transition-colors mb-2",children:[(0,l.jsx)(m.iih,{size:14}),(0,l.jsxs)("span",{children:["Key Insights (",e.key_insights.length,")"]}),h?(0,l.jsx)(m.s$2,{size:12}):(0,l.jsx)(m.RiI,{size:12})]}),h&&(0,l.jsx)("ul",{className:"space-y-1 pl-4",children:e.key_insights.map((e,t)=>(0,l.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-start gap-2",children:[(0,l.jsx)(eu.dvR,{size:14,className:"text-yellow-500 mt-0.5 flex-shrink-0"}),e]},"insight-".concat(t,"-").concat(e.slice(0,20))))})]}),e.alternative_perspectives&&e.alternative_perspectives.length>0&&(0,l.jsxs)("div",{className:"p-3 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-indigo-700 dark:text-indigo-300 mb-2",children:[(0,l.jsx)(m.dSq,{size:14}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"Alternative Perspectives"})]}),(0,l.jsx)("ul",{className:"space-y-1",children:e.alternative_perspectives.map((e,t)=>(0,l.jsxs)("li",{className:"text-sm text-indigo-800 dark:text-indigo-200",children:["• ",e]},"perspective-".concat(t,"-").concat(e.slice(0,20))))})]}),e.citations&&((n=e.citations)&&0!==n.length?(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)("button",{type:"button",onClick:()=>p(!g),className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors mb-2",children:[(0,l.jsx)(f.s59,{size:14}),(0,l.jsxs)("span",{children:["Sources (",n.length,")"]}),g?(0,l.jsx)(m.s$2,{size:12}):(0,l.jsx)(m.RiI,{size:12})]}),g&&(0,l.jsx)("div",{className:"space-y-2 pl-4 border-l-2 border-blue-200 dark:border-blue-700",children:n.map((e,t)=>(0,l.jsx)("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg",children:(0,l.jsx)("div",{className:"flex items-start justify-between",children:(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-1",children:e.title||"Source ".concat(t+1)}),(0,l.jsx)("p",{className:"text-xs text-gray-700 dark:text-gray-300 mb-2",children:e.content_snippet}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[(0,l.jsx)("span",{className:"capitalize",children:e.source_type}),e.confidence_score&&(0,l.jsxs)("span",{children:["• Confidence:"," ",(100*e.confidence_score).toFixed(0),"%"]}),e.page_number&&(0,l.jsxs)("span",{children:["• Page ",e.page_number]})]})]})})},e.source_id||"citation-".concat(t)))})]}):null),e.limitations&&e.limitations.length>0&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("button",{type:"button",onClick:()=>N(!j),className:"flex items-center gap-2 text-sm text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300 transition-colors mb-2",children:[(0,l.jsx)(m.gJy,{size:14}),(0,l.jsxs)("span",{children:["Limitations (",e.limitations.length,")"]}),j?(0,l.jsx)(m.s$2,{size:12}):(0,l.jsx)(m.RiI,{size:12})]}),j&&(0,l.jsx)("div",{className:"p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-700",children:(0,l.jsx)("ul",{className:"space-y-1",children:e.limitations.map((e,t)=>(0,l.jsxs)("li",{className:"text-sm text-orange-800 dark:text-orange-200",children:["• ",e]},"limitation-".concat(t,"-").concat(e.slice(0,20))))})})]}),e.follow_up_questions&&e.follow_up_questions.length>0&&(0,l.jsxs)("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-green-700 dark:text-green-300 mb-2",children:[(0,l.jsx)(m.g_g,{size:14}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"Follow-up Questions"})]}),(0,l.jsx)("ul",{className:"space-y-1",children:e.follow_up_questions.map((e,t)=>(0,l.jsxs)("li",{className:"text-sm text-green-800 dark:text-green-200 cursor-pointer hover:text-green-900 dark:hover:text-green-100",children:["• ",e]},"question-".concat(t,"-").concat(e.slice(0,20))))})]}),(e.generation_time||e.tools_used||e.cost_info)&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("button",{type:"button",onClick:()=>y(!w),className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:[(0,l.jsx)(eu.oq2,{size:12}),(0,l.jsx)("span",{children:"Technical Details"}),w?(0,l.jsx)(m.s$2,{size:10}):(0,l.jsx)(m.RiI,{size:10})]}),w&&(0,l.jsxs)("div",{className:"mt-2 p-2 bg-gray-50 dark:bg-gray-900/50 rounded text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[e.generation_time&&(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(m.qyc,{size:10}),(0,l.jsxs)("span",{children:["Generated in ",e.generation_time.toFixed(2),"s"]})]}),e.tools_used&&e.tools_used.length>0&&(0,l.jsxs)("div",{children:["Tools used: ",e.tools_used.join(", ")]}),e.cost_info&&(0,l.jsxs)("div",{children:["Cost: ",JSON.stringify(e.cost_info)]}),e.factual_accuracy_score&&(0,l.jsxs)("div",{children:["Accuracy:"," ",(100*e.factual_accuracy_score).toFixed(0),"%"]}),e.completeness_score&&(0,l.jsxs)("div",{children:["Completeness:"," ",(100*e.completeness_score).toFixed(0),"%"]})]})]})]})),("system"===t.type||"thinking"===t.type)&&!t.structured&&(0,l.jsxs)(l.Fragment,{children:[t.reasoningTrace&&t.reasoningTrace.steps.length>0&&(0,l.jsxs)("div",{className:"w-full mb-3",children:[(0,l.jsxs)("button",{type:"button",onClick:()=>x(!d),className:"flex items-center gap-2 text-xs text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors",children:[(0,l.jsx)(m.Qkp,{size:14}),(0,l.jsxs)("span",{children:["Reasoning Steps (",t.reasoningTrace.steps.length,")"]}),d?(0,l.jsx)(m.s$2,{size:12}):(0,l.jsx)(m.RiI,{size:12})]}),d&&(0,l.jsxs)("div",{className:"mt-2 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-200 dark:border-blue-700",children:[t.reasoningTrace.steps.map((e,t)=>(0,l.jsxs)("div",{className:"mb-2 last:mb-0",children:[(0,l.jsxs)("span",{className:"text-xs font-semibold text-blue-700 dark:text-blue-300",children:["Step ",t+1,":"]}),(0,l.jsx)("p",{className:"text-xs mt-1 text-gray-700 dark:text-gray-300",children:e})]},"step-".concat(t,"-").concat(e.slice(0,20)))),t.reasoningTrace.confidence&&(0,l.jsx)("div",{className:"mt-2 pt-2 border-t border-blue-200 dark:border-blue-700",children:(0,l.jsxs)("span",{className:"text-xs text-blue-700 dark:text-blue-300",children:["Confidence:"," ",(100*t.reasoningTrace.confidence).toFixed(1),"%"]})})]})]}),(0,l.jsx)(eg.D,{className:"prose md:prose-sm lg:prose-base p-3 prose-pre:bg-bg-alt-verba",components:{code(e){let{inline:t,className:a,children:n,...r}=e,i=/language-(\w+)/.exec(a||"");return!t&&i?(0,l.jsx)("pre",{className:"language-".concat(i[1]," p-4 rounded-lg overflow-x-auto ").concat("dark"===s.theme?"bg-gray-800":"bg-gray-100"),children:(0,l.jsx)("code",{className:"language-".concat(i[1]),children:String(n).replace(/\n$/,"")})}):(0,l.jsx)("code",{className:a,...r,children:n})}},children:t.content})]}),"user"===t.type&&(0,l.jsx)("div",{className:"whitespace-pre-wrap",children:t.content}),"error"===t.type&&(0,l.jsxs)("div",{className:"whitespace-pre-wrap flex items-center gap-2 text-sm text-text-verba",children:[(0,l.jsx)(u.I2T,{size:15}),(0,l.jsx)("p",{children:t.content})]})]})})}return(0,l.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-3 w-full items-center",children:[t.content.map((e,t)=>(0,l.jsx)("button",{type:"button",onClick:()=>{r(e.uuid),c(e.uuid+e.score+e.chunks.length),o(e.chunks)},className:"flex ".concat(a&&a===e.uuid+e.score+e.chunks.length?"bg-secondary-verba hover:bg-button-hover-verba":"bg-button-verba hover:bg-secondary-verba"," rounded-3xl p-3 items-center justify-between transition-colors duration-300 ease-in-out border-none"),children:(0,l.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,l.jsx)("p",{className:"text-xs flex-grow truncate mr-2",title:e.title,children:e.title}),(0,l.jsxs)("div",{className:"flex gap-1 items-center text-text-verba flex-shrink-0",children:[(0,l.jsx)(f.$Kz,{size:12}),(0,l.jsx)("p",{className:"text-sm",children:e.chunks.length})]})]})},"Retrieval".concat(e.title).concat(t))),(0,l.jsx)(b,{Icon:f.s59,className:"btn-sm btn-square",onClick:()=>document.getElementById("context-modal-".concat(i)).showModal()}),(0,l.jsx)("dialog",{id:"context-modal-".concat(i),className:"modal",children:(0,l.jsxs)("div",{className:"modal-box",children:[(0,l.jsx)("h3",{className:"font-bold text-lg",children:"Context"}),(0,l.jsx)("p",{className:"py-4",children:t.context}),(0,l.jsx)("div",{className:"modal-action",children:(0,l.jsx)("form",{method:"dialog",children:(0,l.jsx)("button",{type:"button",className:"btn focus:outline-none text-text-alt-verba bg-button-verba hover:bg-button-hover-verba hover:text-text-verba border-none shadow-none",children:(0,l.jsx)("p",{children:"Close"})})})})]})})]})},ep=e=>{let{production:t,credentials:s,setSelectedDocument:a,setSelectedChunkScore:r,ragConfig:i,selectedTheme:c,setRAGConfig:o,addStatusMessage:d,documentFilter:x,setDocumentFilter:v,labels:j,filterLabels:N,setFilterLabels:w}=e,[S,C]=(0,n.useState)("Chat"),k=(0,n.useRef)(!1),_=(0,n.useRef)([]),E=(0,n.useRef)(!1),[I,O]=(0,n.useState)("DONE"),[A,z]=(0,n.useState)(""),[P,L]=(0,n.useState)(null),[U,J]=(0,n.useState)("DISCONNECTED"),[G,W]=(0,n.useState)(0),[B,V]=(0,n.useState)([]),[H,Q]=(0,n.useState)(null),[K,Y]=(0,n.useState)(0),[$,X]=(0,n.useState)(""),[Z,ee]=(0,n.useState)([]),et=i?i.Embedder.components[i.Embedder.selected].config.Model.value:"No Config found";(0,n.useEffect)(()=>{let e=new er("/ws/generate_stream",{maxRetries:5,initialRetryDelay:1e3,maxRetryDelay:3e4,heartbeatInterval:3e4,reconnectOnError:!0,messageQueueSize:10});return e.on("stateChange",function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];let l=t[0];J(l),"DISCONNECTED"===l||"ERROR"===l?d("WebSocket disconnected","WARNING"):"CONNECTED"===l&&d("WebSocket connected","SUCCESS")}),e.on("message",function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];let l=t[0];if(!k.current){z("");return}let a=l.message;if("reasoning"===l.type||"thinking"===l.type?(E.current=!0,_.current.push(a),z(e=>"".concat(e,"\n\uD83E\uDD14 ").concat(a))):"transition"===l.type?(E.current=!1,z(e=>e+a)):z(e=>e+a),"stop"===l.finish_reason){k.current=!1,O("DONE"),d("Finished generation","SUCCESS");let e=l.full_text,t=l.reasoning_trace||l.thinking_trace||_.current.length>0?{steps:l.reasoning_trace||l.thinking_trace||_.current,metadata:l.metadata}:void 0;l.cached?ee(s=>[...s,{type:"system",content:e||"",cached:!0,distance:l.distance,runId:l.runId,reasoningTrace:t}]):ee(s=>[...s,{type:"system",content:e||"",runId:l.runId,reasoningTrace:t}]),_.current=[],E.current=!1,z("")}}),e.on("error",function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];console.error("WebSocket Error:",t[0])}),e.on("close",function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];t[0].wasClean}),e.on("messageQueued",()=>{W(e.getQueueSize())}),e.on("sent",()=>{W(e.getQueueSize())}),e.connect(),L(e),()=>{e.disconnect()}},[d]),(0,n.useEffect)(()=>{i?ed():Y(0)},[i]);let es=async()=>{let e=await R(s);e?o(e.rag_config):d("Failed to fetch RAG Config","ERROR")},el=async()=>{if(!k.current&&$.trim()){X(""),k.current=!0,V([]),O("CHUNKS"),ee(e=>[...e,{type:"user",content:$}]);try{d("Sending query...","INFO");let e=await T($,i,N,x,s);!e||e.error?ea((null==e?void 0:e.error)||"No data received"):ec(e,$)}catch(e){ea("Failed to fetch from API"),console.error("Failed to fetch from API:",e)}}},ea=e=>{d("Query failed","ERROR"),ee(t=>[...t,{type:"error",content:e}]),k.current=!1,O("DONE")},ec=(e,t)=>{if(ee(t=>[...t,{type:"retrieval",content:e.documents,context:e.context}]),d("Received ".concat(Object.entries(e.documents).length," documents"),"SUCCESS"),e.documents.length>0){let s=e.documents[0];a(s.uuid),Q("".concat(s.uuid).concat(s.score).concat(s.chunks.length)),r(s.chunks),e.context&&(eo(t,e.context),O("RESPONSE"))}else ea("We couldn't find any chunks to your query")},eo=(e,t)=>{if(null==P?void 0:P.isConnected()){let s=Z.filter(e=>"user"===e.type||"system"===e.type).map(e=>({type:e.type,content:e.content}));P.send({query:e,context:t,conversation:s,rag_config:i})}else console.error("WebSocket is not connected. State:",null==P?void 0:P.getState()),d("WebSocket not connected. Message queued.","WARNING")},ed=async()=>{try{let e=await M(et,x,s);await F(s),e&&Y(e.datacount)}catch(e){console.error("Failed to fetch from API:",e),d("Failed to fetch datacount: ".concat(e),"ERROR")}},eu=async()=>{try{await D(i,s)?(d("Config saved successfully","SUCCESS"),await es()):d("Failed to save config","ERROR")}catch(e){console.error("Error saving config:",e),d("Error saving config","ERROR")}},em=async()=>{d("Reset Config","WARNING"),es()},eg=async()=>{try{var e;if(null==i?void 0:null===(e=i.Retriever.components[i.Retriever.selected].config.Suggestion)||void 0===e?void 0:e.value){let e=await q($,3,s);e&&V(e.suggestions)}}catch(e){console.error("Error fetching suggestions:",e)}},ep=async(e,t,l)=>{en("Feedback submission triggered",{runId:e,feedbackType:t,additionalFeedback:l});try{let a=await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({runId:e,feedbackType:t,additionalFeedback:l,credentials:s})});a.ok?(en("Feedback submitted successfully",{runId:e}),d("Feedback submitted successfully","SUCCESS")):(en("Failed to submit feedback",{runId:e,status:a.status}),d("Failed to submit feedback","ERROR"))}catch(t){en("Error submitting feedback",{runId:e,error:t}),console.error("Error submitting feedback:",t),d("Error submitting feedback","ERROR")}};return(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex flex-col md:flex-row gap-2 p-4 md:p-6 items-center justify-between h-min w-full",children:[(0,l.jsxs)("div",{className:"hidden md:flex gap-2 justify-start items-center",children:[(0,l.jsx)(ei,{tooltip_text:"Use the Chat interface to interact with your data and perform Retrieval Augmented Generation (RAG).",display_text:"Chat"}),(0,l.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,l.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("CONNECTED"===U?"bg-green-500":"CONNECTING"===U||"RECONNECTING"===U?"bg-yellow-500 animate-pulse":"bg-red-500")}),(0,l.jsx)("span",{className:"text-xs text-text-alt-verba",children:"CONNECTED"===U?"Connected":"CONNECTING"===U?"Connecting...":"RECONNECTING"===U?"Reconnecting...":"Disconnected"}),G>0&&(0,l.jsxs)("span",{className:"text-xs text-warning-verba ml-2",children:["(",G," queued)"]})]})]}),(0,l.jsxs)("div",{className:"w-full md:w-fit flex gap-3 justify-end items-center",children:[(0,l.jsx)(b,{title:"Chat",Icon:f.utr,onClick:()=>C("Chat"),selected:"Chat"===S,disabled:!1,selected_color:"bg-secondary-verba"}),"Demo"!==t&&(0,l.jsx)(b,{title:"Config",Icon:m.KOq,onClick:()=>C("Config"),selected:"Config"===S,disabled:!1,selected_color:"bg-secondary-verba"})]})]}),(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex flex-col h-[50vh] md:h-full w-full overflow-y-auto overflow-x-hidden relative p-2 md:p-4",children:["Chat"===S&&(0,l.jsxs)("div",{className:"sticky flex flex-col gap-2 top-0 z-9 p-4 backdrop-blur-sm bg-opacity-30 bg-bg-alt-verba rounded-lg",children:[(0,l.jsxs)("div",{className:"flex gap-2 justify-start items-center",children:[(0,l.jsx)("div",{className:"flex gap-2",children:(0,l.jsxs)("div",{className:"dropdown dropdown-hover",children:[(0,l.jsx)(b,{title:"Label",className:"btn-sm min-w-min",icon_size:12,text_class_name:"text-xs",Icon:g.Lgw,selected:!1,disabled:!1}),(0,l.jsx)("ul",{className:"dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52",children:j.map((e,t)=>(0,l.jsx)("li",{children:(0,l.jsx)("button",{type:"button",onClick:()=>{N.includes(e)||w([...N,e]);let t=document.activeElement;t.blur();let s=t.closest(".dropdown");s instanceof HTMLElement&&s.blur()},onKeyDown:t=>{if("Enter"===t.key||" "===t.key){t.preventDefault(),N.includes(e)||w([...N,e]);let s=document.activeElement;s.blur();let l=s.closest(".dropdown");l instanceof HTMLElement&&l.blur()}},children:e})},"Label-".concat(e)))})]})}),(N.length>0||x.length>0)&&(0,l.jsx)(b,{onClick:()=>{w([]),v([])},title:"Clear",className:"btn-sm max-w-min",icon_size:12,text_class_name:"text-xs",Icon:p.B4e,selected:!1,disabled:!1})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[N.map((e,t)=>(0,l.jsx)(b,{title:e,Icon:p.B4e,className:"btn-sm min-w-min max-w-[200px]",icon_size:12,selected_color:"bg-primary-verba",selected:!0,text_class_name:"truncate max-w-[200px]",text_size:"text-xs",onClick:()=>{w(N.filter(t=>t!==e))}},"FilterLabel-".concat(e))),x.map(e=>(0,l.jsx)(b,{title:e.title,Icon:p.B4e,className:"btn-sm min-w-min max-w-[200px]",icon_size:12,selected_color:"bg-primary-verba",selected:!0,text_size:"text-xs",text_class_name:"truncate md:max-w-[100px] lg:max-w-[150px]",onClick:()=>{v(x.filter(t=>t.uuid!==e.uuid))}},"DocumentFilter-".concat(e.title)))]})]}),(0,l.jsxs)("div",{className:"".concat("Chat"===S?"flex flex-col gap-3 p-4":"hidden"),children:[(0,l.jsxs)("div",{className:"flex w-full justify-start items-center text-text-alt-verba gap-2",children:[0===K&&(0,l.jsx)(u.I2T,{size:15}),0===K&&(0,l.jsx)("p",{className:"text-text-alt-verba text-sm items-center flex",children:"".concat(K," documents embedded by ").concat(et)})]}),Z.map((e,t)=>(0,l.jsx)("div",{className:"user"===e.type?"text-right":"",children:(0,l.jsx)(ef,{message:e,messageIndex:t,selectedTheme:c,selectedDocument:H,setSelectedDocumentScore:Q,setSelectedDocument:a,setSelectedChunkScore:r})},"Message_".concat(t,"_").concat(e.type,"_").concat(e.content.slice(0,50)))),A&&(0,l.jsx)(ef,{message:{type:"system",content:A},messageIndex:-1,selectedTheme:c,selectedDocument:H,setSelectedDocumentScore:Q,setSelectedDocument:a,setSelectedChunkScore:r}),k.current&&(0,l.jsx)("div",{className:"flex flex-col gap-2",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("span",{className:"text-text-alt-verba loading loading-dots loading-md"}),(0,l.jsxs)("p",{className:"text-text-alt-verba",children:["CHUNKS"===I&&"Retrieving...","RESPONSE"===I&&"Generating..."]}),(0,l.jsx)("button",{type:"button",onClick:()=>{O("DONE"),k.current=!1},className:"btn btn-circle btn-sm bg-bg-alt-verba hover:bg-warning-verba hover:text-text-verba text-text-alt-verba shadow-none border-none text-sm",children:(0,l.jsx)(p.B4e,{size:15})})]})})]}),"Config"===S&&(0,l.jsx)(ex,{addStatusMessage:d,production:t,ragConfig:i,credentials:s,setRAGConfig:o,onReset:em,onSave:eu})]}),(0,l.jsx)("div",{className:"bg-bg-alt-verba rounded-2xl flex flex-col md:flex-row gap-2 p-4 md:p-6 items-center justify-end h-min w-full",children:"CONNECTED"===U?(0,l.jsxs)("div",{className:"flex flex-col w-full gap-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"relative w-full",children:(0,l.jsx)("textarea",{className:"textarea textarea-bordered w-full bg-bg-verba placeholder-text-alt-verb min-h min-h-[40px] max-h-[150px] overflow-y-auto",placeholder:K>0?K>=100?"Chatting with more than 100 documents...":"Chatting with ".concat(K," documents..."):"No documents detected...",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),el())},value:$,onChange:e=>{let t=e.target.value;X(t),(t.length-1)%3==0&&eg()}})}),(0,l.jsx)(b,{type:"button",Icon:g.OUD,onClick:el,disabled:!1,selected_color:"bg-primary-verba"})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center justify-end",children:[(0,l.jsx)(b,{type:"button",Icon:p.Ffb,onClick:()=>{a(null),r([]),X(""),Q(null),V([]),ee([{type:"system",content:c.intro_message.text}])},disabled:!1,selected_color:"bg-primary-verba"}),(0,l.jsx)(y,{runId:(()=>{if(Z.length>0){let e=Z[Z.length-1];return"system"===e.type&&e.runId?e.runId:""}return""})(),onSubmit:ep})]}),B.length>0&&(0,l.jsxs)("div",{className:"mt-2",children:[(0,l.jsx)("p",{className:"text-sm text-text-alt-verba mb-1",children:"Suggestions:"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2 w-full",children:B.map((e,t)=>(0,l.jsx)("button",{type:"button",className:"p-2 bg-button-verba hover:bg-secondary-verba text-text-alt-verba rounded-xl hover:text-text-verba cursor-pointer text-xs lg:text-sm",onClick:()=>{X(e.query),V([])},children:e.query.length>50?"".concat(e.query.substring(0,50),"..."):e.query},"suggestion-".concat(e.query)))})]})]}):(0,l.jsx)("div",{className:"flex gap-2 items-center justify-end w-full",children:(0,l.jsxs)("button",{type:"button",onClick:()=>{P&&P.reconnect()},className:"flex btn border-none text-text-verba bg-button-verba hover:bg-button-hover-verba gap-2 items-center",children:[(0,l.jsx)(h.Nwf,{size:15}),(0,l.jsx)("p",{children:"RECONNECTING"===U?"Reconnecting...":"Reconnect"}),"RECONNECTING"===U&&(0,l.jsx)("span",{className:"loading loading-spinner loading-xs"})]})})})]})},eh=e=>{let{selectedDocument:t,credentials:s,selectedTheme:a}=e,[r,i]=(0,n.useState)(!1),[c,o]=(0,n.useState)([]),[d,x]=(0,n.useState)(1),[u,m]=(0,n.useState)(0),[g,p]=(0,n.useState)(!0),h=(0,n.useCallback)(async e=>{try{i(!0);let l=await L(t,e,10,s);if(l){if(""!==l.error)return console.error(l.error),i(!1),o([]),!1;return o(l.chunks),i(!1),l.chunks.length>0}return!1}catch(e){return console.error("Failed to fetch document:",e),i(!1),!1}},[t,s]);(0,n.useEffect)(()=>{h(d),p(1===d&&0===u)},[d,u,h]),(0,n.useEffect)(()=>{t&&(h(1),m(0),x(1),p(!0))},[t,h]);let v=async()=>{u===c.length-1?(await h(d+1)?x(e=>e+1):(await h(1),x(1)),m(0)):m(e=>e+1)},j=async()=>{if(0===u){if(d>1){let e=d-1;await h(e)&&(x(e),m(9))}else{let e=d,t=!0;for(;t;)(t=await h(e+1))&&e++;await h(e),x(e),m(c.length-1)}}else m(e=>e-1)};return 0===c.length?(0,l.jsx)("div",{children:r&&(0,l.jsx)("div",{className:"flex items-center justify-center text-text-verba gap-2 h-full",children:(0,l.jsx)("span",{className:"loading loading-spinner loading-sm"})})}):(0,l.jsx)("div",{className:"flex flex-col h-full",children:c.length>0&&(0,l.jsxs)("div",{className:"bg-bg-alt-verba flex flex-col rounded-lg overflow-hidden h-full",children:[(0,l.jsxs)("div",{className:"flex-grow overflow-hidden p-3",children:[(0,l.jsx)("div",{className:"flex justify-between mb-2",children:(0,l.jsx)("div",{className:"flex gap-2",children:(0,l.jsxs)("div",{className:"flex gap-2 items-center p-3 bg-secondary-verba rounded-full w-fit",children:[(0,l.jsx)(f.dUf,{size:12}),(0,l.jsxs)("p",{className:"text-xs flex text-text-verba",children:["Chunk ",c[u].chunk_id]})]})})}),(0,l.jsx)("div",{className:"overflow-y-auto h-[calc(100%-3rem)]",children:(0,l.jsx)(eg.D,{className:"max-w-[50vw] items-center justify-center flex-wrap md:prose-base sm:prose-sm p-3 prose-pre:bg-bg-alt-verba",components:{code(e){let{node:t,inline:s,className:n,children:r,...i}=e,c=/language-(\w+)/.exec(n||"");return!s&&c?(0,l.jsx)("pre",{className:"language-".concat(c[1]," p-4 rounded-lg overflow-x-auto ").concat("dark"===a.theme?"bg-gray-800":"bg-gray-100"),children:(0,l.jsx)("code",{className:"language-".concat(c[1]),children:String(r).replace(/\n$/,"")})}):(0,l.jsx)("code",{className:n,children:r})}},children:c[u].content})})]}),c.length>1&&(0,l.jsxs)("div",{className:"flex justify-center items-center gap-2 p-3 bg-bg-alt-verba",children:[(0,l.jsx)(b,{title:"Previous Chunk",onClick:j,className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",disabled:g,Icon:f.dUf}),(0,l.jsx)(b,{title:"Next Chunk",onClick:v,className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",Icon:f.mzm})]})]})})},eb=s(5903),ev=s(1538),ej=s(4725),eN=s(4231),ew=s(7283),ey=s(2079);let eS=["green","blue","red","yellow","purple","cyan","orange","limegreen","pink","teal","violet","forestgreen","gold","navy","magenta","mediumspringgreen","darkorange","deepskyblue","crimson","lightseagreen","royalblue","chartreuse","mediumorchid","aqua","orangered","mediumaquamarine","plum","lime","dodgerblue","lightcoral","mediumslateblue","lightgreen","darkred","springgreen","lightpink","indigo","lightyellow","mediumvioletred","seagreen","fuchsia","darkseagreen","thistle","orange","powderblue","yellowgreen","cornflowerblue","darkmagenta","darkblue","gold","mediumblue","rosybrown","darkgreen","lightskyblue","mediumseagreen","firebrick","lavender","darkcyan","khaki","mediumturquoise","saddlebrown","lightblue","olive","mintcream","turquoise","rebeccapurple","lightgoldenrodyellow"];function eC(e,t,s){return s===t?0:(e-t)/(s-t)}(0,eN.e)({OrbitControls:eb.z});let ek=e=>{let{vector:t,color:s,setHoverTitle:a,documentTitle:r,multiplication:i,dynamicColor:c,chunk_id:o,chunk_uuid:d,setSelectedChunk:x,selectedChunk:u,minX:m,maxX:g,minY:f,maxY:p,minZ:h,maxZ:b,chunkScores:v}=e,j=(0,n.useRef)(null),N=(0,n.useRef)(!1),w=(0,n.useMemo)(()=>null==v?void 0:v.some(e=>e.uuid===d),[v,d]),y=(0,n.useMemo)(()=>w?new ey.Ilk("yellow"):u===d?new ey.Ilk("green"):c?function(e,t,s,l,a,n,r){let i=eC(e.x,t,s),c=eC(e.y,l,a),o=eC(e.z,n,r);return new ey.Ilk("rgb(".concat(Math.floor(255*i),",").concat(Math.floor(255*c),",").concat(Math.floor(255*o),")"))}(t,m,g,f,p,h,b):new ey.Ilk(s),[w,u,d,c,s,t,m,g,f,p,h,b]),S=w?3:u===d?1.5:1,C=w?1:N.current?1:.5,k=(0,n.useCallback)(()=>{N.current=!0,a.current("".concat(r," | ").concat(o))},[r,o,a]),_=(0,n.useCallback)(()=>{N.current=!1,a.current(null)},[a]),E=(0,n.useCallback)(()=>{x(d)},[d,x]);return(0,eN.F)(()=>{if(j.current){j.current.position.lerp(new ey.Pa4(t.x*i,t.y*i,t.z*i),.02);let e=j.current.material;e.color.set(N.current?"blue":y),e.opacity=N.current?1:C,e.transparent=!N.current}}),(0,l.jsx)(ev.b,{rotationIntensity:.2,children:(0,l.jsxs)("mesh",{ref:j,position:[0,0,0],onPointerEnter:k,onPointerLeave:_,onClick:E,children:[(0,l.jsx)("sphereGeometry",{args:[S,32,32]}),(0,l.jsx)("meshBasicMaterial",{color:y,opacity:C,transparent:!0})]})})};var e_=e=>{let{credentials:t,selectedDocument:s,production:a,chunkScores:r}=e;(0,n.useRef)([]);let[i,c]=(0,n.useState)(!1),[o,d]=(0,n.useState)([]),[x,u]=(0,n.useState)(""),[m,g]=(0,n.useState)(!1),[f,h]=(0,n.useState)(!0),[b,v]=(0,n.useState)(null),j=(0,n.useRef)(e=>v(e)),[N,w]=(0,n.useState)(200),[y,S]=(0,n.useState)(0),[C,k]=(0,n.useState)(null),[_,E]=(0,n.useState)(null),[I,R]=(0,n.useState)(-1),[D,O]=(0,n.useState)(1),[T,A]=(0,n.useState)(-1),[M,F]=(0,n.useState)(1),[z,L]=(0,n.useState)(-1),[J,G]=(0,n.useState)(1);function W(e){return{min:Math.min(...e),max:Math.max(...e)}}(0,n.useEffect)(()=>{s?q():d([])},[s]),(0,n.useEffect)(()=>{C?B():E(null)},[C]);let B=async()=>{try{let e=await U(C,x,t);e&&(""!==e.error?(console.error(e.error),E(null)):E(e.chunk))}catch(e){console.error("Failed to fetch document:",e),c(!1)}},q=async()=>{try{c(!0);let e=await P(s,m,t);if(e){if(""!==e.error)console.error(e.error),c(!1),d([]),S(0),u("None");else if(d(e.vector_groups.groups),u(e.vector_groups.embedder),S(e.vector_groups.dimensions),c(!1),!m){let t=e.vector_groups.groups[0].chunks.map(e=>e.vector.x),s=e.vector_groups.groups[0].chunks.map(e=>e.vector.y),l=e.vector_groups.groups[0].chunks.map(e=>e.vector.z),{min:a,max:n}=W(t);R(a),O(n);let{min:r,max:i}=W(s);A(r),F(i);let{min:c,max:o}=W(l);L(c),G(o)}}}catch(e){console.error("Failed to fetch document:",e),c(!1)}};return(0,l.jsxs)("div",{className:"flex flex-col gap-2 h-full w-full",children:[(0,l.jsx)("div",{className:"flex justify-end w-full gap-2 items-center",children:(0,l.jsxs)("div",{className:"flex w-full items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[i&&(0,l.jsx)("div",{className:"flex items-center justify-center text-text-alt-verba gap-2 h-full",children:(0,l.jsx)("span",{className:"loading loading-spinner loading-xs lg:loading-sm"})}),(0,l.jsx)("p",{className:"text-text-alt-verba text-xs lg:text-sm font-bold",children:"Embedding Model:"}),(0,l.jsx)("p",{className:"text-text-alt-verba text-xs lg:text-sm",children:x})]}),(0,l.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,l.jsx)("p",{className:"text-text-alt-verba text-xs lg:text-sm font-bold",children:"Hover:"}),(0,l.jsx)("p",{className:"text-xs lg:text-sm text-text-alt-verba truncate max-w-[100px] lg:max-w-[300px]",title:null!=b?b:"",children:null!=b?b:""})]}),(0,l.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,l.jsx)("p",{className:"text-text-alt-verba text-xs lg:text-sm font-bold",children:"Vectors:"}),(0,l.jsxs)("p",{className:"text-xs lg:text-sm text-text-alt-verba",children:[o.length," x ",(()=>{let e=0;for(let t of o)e+=t.chunks.length;return e})()," x ",y]})]})]}),(0,l.jsxs)("div",{className:"flex gap-10 items-center justify-between min-w-[20vw]",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:["Demo"!==a&&(0,l.jsxs)("div",{className:"flex gap-2 items-center justify-between",children:[(0,l.jsx)("p",{className:"text-xs text-text-alt-verba",children:"Show All Documents"}),(0,l.jsx)("input",{type:"checkbox",className:"toggle",checked:m,onChange:e=>{g(e.target.checked)}})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center justify-between",children:[(0,l.jsx)("p",{className:"text-xs text-text-alt-verba",children:"Dynamic Coloring"}),(0,l.jsx)("input",{type:"checkbox",className:"toggle",checked:f,onChange:e=>{h(e.target.checked)}})]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,l.jsxs)("div",{className:"dropdown dropdown-bottom flex w-full justify-start items-center",children:[(0,l.jsxs)("button",{type:"button",tabIndex:0,disabled:!0,className:"btn btn-sm bg-button-verba hover:bg-button-hover-verba text-text-verba w-full flex justify-start border-none",children:[(0,l.jsx)(ec.WMq,{size:15}),(0,l.jsx)("p",{children:"PCA"})]}),(0,l.jsx)("ul",{className:"dropdown-content menu bg-base-100 rounded-box z-[1] w-full p-2 shadow"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,l.jsx)("p",{className:"text-text-alt-verba text-sm",children:"Zoom"}),(0,l.jsx)("input",{onChange:e=>{w(Number(e.target.value))},type:"range",min:0,max:"1000",value:N,className:"range range-xs grow w-full"})]})]}),_&&(0,l.jsx)("button",{type:"button",onClick:()=>{E(null),k(null)},className:"flex btn btn-square border-none text-text-verba bg-button-verba hover:bg-warning-verba gap-2",children:(0,l.jsx)(p.B4e,{size:15})})]})]})}),(0,l.jsxs)("div",{className:"flex gap-5 h-[45vh] w-full",children:[(0,l.jsx)("div",{className:"flex flex-grow transition-all duration-300 ease-in-out ".concat(C?"w-2/3":"w-full"," h-full"),children:(0,l.jsxs)(ew.Xz,{children:[(0,l.jsx)("ambientLight",{intensity:1}),(0,l.jsx)(eb.z,{}),(0,l.jsx)(ej.c,{makeDefault:!0,position:[0,0,150]}),(0,l.jsx)("axesHelper",{args:[50]}),o.map((e,t)=>e.chunks.map((s,a)=>(0,l.jsx)(ek,{dynamicColor:f,multiplication:N,vector:s.vector,color:function(e){if(e>=eS.length){let e=Math.floor(Math.random()*eS.length);return eS[e]}return eS[e]}(t),setHoverTitle:j,documentTitle:e.name,chunk_id:s.chunk_id,setSelectedChunk:k,selectedChunk:C,chunk_uuid:s.uuid,minX:I,minY:T,minZ:z,maxX:D,maxY:M,maxZ:J,chunkScores:r},"Sphere_".concat(a).concat(e.name))))]})}),(0,l.jsx)("div",{className:"flex flex-grow transition-all duration-300 ease-in-out ".concat(C?"w-1/3 opacity-100":"w-0 opacity-0"," overflow-auto"),children:_&&(0,l.jsxs)("div",{className:"flex flex-col p-3 gap-2 w-full",children:[(0,l.jsxs)("p",{className:"text-text-alt-verba fond-bold",children:["Chunk ",_.chunk_id]}),(0,l.jsx)("p",{className:"text-text-alt-verba text-sm",children:_.content})]})})]})]})},eE=e=>{let{selectedDocument:t,credentials:s}=e,[a,r]=(0,n.useState)(!0),[i,c]=(0,n.useState)(null);return(0,n.useEffect)(()=>{(async()=>{try{if(r(!0),t){let e=await A(t,s);(null==e?void 0:e.document)?c(e.document):c(null)}else c(null)}catch(e){console.error("Error fetching document:",e),c(null)}finally{r(!1)}})()},[t,s]),(0,l.jsx)("div",{className:"flex flex-col h-full",children:a?(0,l.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,l.jsx)("span",{className:"loading loading-spinner loading-md text-text-verba bg-text-alt-verba"})}):i&&(0,l.jsxs)("div",{className:"bg-bg-alt-verba flex flex-col rounded-lg overflow-hidden h-full",children:[(0,l.jsxs)("div",{className:"p-4 flex flex-col gap-2 items-start justify-start",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:"Title"}),(0,l.jsx)("p",{className:"text-text-verba truncate max-w-full",title:i.title,children:i.title})]}),(0,l.jsxs)("div",{className:"p-4 flex flex-col gap-2 items-start justify-start",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:"Metadata"}),(0,l.jsx)("p",{className:"text-text-verba max-w-full",children:i.metadata})]}),(0,l.jsxs)("div",{className:"p-4 flex flex-col gap-2 items-start justify-start",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:"Extension"}),(0,l.jsx)("p",{className:"text-text-verba max-w-full",children:i.extension})]}),(0,l.jsxs)("div",{className:"p-4 flex flex-col gap-2 items-start justify-start",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:"File Size"}),(0,l.jsx)("p",{className:"text-text-verba max-w-full",children:i.fileSize})]}),(0,l.jsxs)("div",{className:"p-4 flex flex-col gap-2 items-start justify-start",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:"Source"}),(0,l.jsx)("button",{type:"button",className:"text-text-verba truncate max-w-full",onClick:()=>window.open(i.source,"_blank"),title:i.source,children:i.source})]}),(0,l.jsxs)("div",{className:"p-4 flex flex-col gap-2 items-start justify-start",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:"Labels"}),(0,l.jsx)("p",{className:"text-text-verba max-w-full",children:i.labels})]})]})})},eI=e=>{let{document:t,selectedDocument:s,selectedTheme:a,credentials:r,chunkScores:i}=e,[c,o]=(0,n.useState)(!0),[d,x]=(0,n.useState)(1),[u,g]=(0,n.useState)(1),[p,h]=(0,n.useState)([]),v=(0,n.useRef)(null),j=(0,n.useCallback)(async()=>{try{o(!0);let e=await z(s,d,i||[],r);e&&(""!==e.error?(h([{content:e.error,chunk_id:0,score:0,type:"text"}]),x(1),g(1)):(h(e.content),g(e.maxPage)),o(!1))}catch(e){console.error("Failed to fetch content from document:",e),o(!1)}},[s,d,i,r]);(0,n.useEffect)(()=>{t?(j(),x(1)):(h([]),x(1),g(1))},[t,j]),(0,n.useEffect)(()=>{t?j():(h([]),x(1),g(1))},[t,j]),(0,n.useEffect)(()=>{if(i&&i.length>0){var e;null===(e=v.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}},[i]);let N=(e,t)=>"text"===e.type?(0,l.jsx)("div",{className:"flex p-2",ref:i?null:v,children:(0,l.jsx)(eg.D,{className:"max-w-[50vw] items-center justify-center flex-wrap md:prose-base sm:prose-sm p-3 prose-pre:bg-bg-alt-verba",components:{code(e){let{node:t,inline:s,className:n,children:r,...i}=e,c=/language-(\w+)/.exec(n||"");return!s&&c?(0,l.jsx)("pre",{className:"language-".concat(c[1]," p-4 rounded-lg overflow-x-auto ").concat("dark"===a.theme?"bg-gray-800":"bg-gray-100"),children:(0,l.jsx)("code",{className:"language-".concat(c[1]),children:String(r).replace(/\n$/,"")})}):(0,l.jsx)("code",{className:n,children:r})}},children:e.content})},"CONTENT_SNIPPET".concat(t)):(0,l.jsxs)("div",{className:"flex p-2 border-2 flex-col gap-2 border-secondary-verba shadow-lg rounded-3xl",ref:v,children:[(0,l.jsx)("div",{className:"flex justify-between",children:(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)("div",{className:"flex gap-2 items-center p-3 bg-secondary-verba rounded-full w-fit",children:[(0,l.jsx)(eu.dvR,{size:12}),(0,l.jsx)("p",{className:"text-xs flex text-text-verba",children:"Context Used"})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center p-3 bg-secondary-verba rounded-full w-fit",children:[(0,l.jsx)(f.$Kz,{size:12}),(0,l.jsxs)("p",{className:"text-xs flex text-text-verba",children:["Chunk ",e.chunk_id+1]})]}),e.score>0&&(0,l.jsxs)("div",{className:"flex gap-2 items-center p-3 bg-primary-verba rounded-full w-fit",children:[(0,l.jsx)(eu.dvR,{size:12}),(0,l.jsx)("p",{className:"text-xs flex text-text-verba",children:"High Relevancy"})]})]})}),(0,l.jsx)(eg.D,{className:"w-full items-center justify-center flex-wrap md:prose-base sm:prose-sm p-3 prose-pre:bg-bg-alt-verba",components:{code(e){let{node:t,inline:s,className:n,children:r,...i}=e,c=/language-(\w+)/.exec(n||"");return!s&&c?(0,l.jsx)("pre",{className:"language-".concat(c[1]," p-4 rounded-lg overflow-x-auto ").concat("dark"===a.theme?"bg-gray-800":"bg-gray-100"),children:(0,l.jsx)("code",{className:"language-".concat(c[1]),children:String(r).replace(/\n$/,"")})}):(0,l.jsx)("code",{className:n,children:r})}},children:e.content})]});return t?(0,l.jsx)("div",{className:"flex flex-col h-full",children:t&&(0,l.jsxs)("div",{className:"bg-bg-alt-verba flex flex-col rounded-lg overflow-hidden h-full",children:[(0,l.jsx)("div",{className:"p-3 bg-bg-alt-verba",children:(0,l.jsxs)("div",{className:"flex gap-4 w-full justify-between",children:[(0,l.jsxs)("div",{className:"flex gap-4 items-center",children:[c&&(0,l.jsx)("div",{className:"flex items-center justify-center text-text-verba gap-2",children:(0,l.jsx)("span",{className:"loading loading-spinner loading-sm"})}),(0,l.jsx)("p",{className:"text-lg font-bold truncate max-w-[350px]",title:t.title,children:t.title})]}),(0,l.jsx)("div",{className:"gap-2 flex flex-wrap",children:Object.entries(t.labels).map(e=>{let[s,a]=e;return(0,l.jsx)(b,{title:a,text_size:"text-xs",text_class_name:"truncate max-w-[200px]",className:"btn-sm min-w-min max-w-[200px]"},t.title+s+a)})})]})}),(0,l.jsx)("div",{className:"flex-grow overflow-hidden p-3",children:(0,l.jsx)("div",{className:"overflow-y-auto h-full",children:null==p?void 0:p.map((e,t)=>N(e,t))})}),(0,l.jsxs)("div",{className:"flex justify-center items-center gap-2 p-3 bg-bg-alt-verba",children:[(0,l.jsx)(b,{title:"Previous ".concat(i?"Chunk":"Page"),onClick:()=>{1===d?x(u):x(e=>e-1)},className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",Icon:m.O18}),(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsxs)("p",{className:"text-xs text-text-verba",children:[i?"Chunk ":"Page "," ",d]})}),(0,l.jsx)(b,{title:"Next ".concat(i?"Chunk":"Page"),onClick:()=>{d===u?x(1):x(e=>e+1)},className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",Icon:m.Rdr})]})]})}):(0,l.jsx)("div",{})},eR=e=>{let{credentials:t,selectedDocument:s,setSelectedDocument:a,chunkScores:r,production:i,selectedTheme:c,documentFilter:o,setDocumentFilter:d,addStatusMessage:x}=e,[u,f]=(0,n.useState)("Content"),[v,j]=(0,n.useState)(!1),[N,w]=(0,n.useState)(null);(0,n.useEffect)(()=>{s?S():w(null)},[s]);let y=e=>{window.open(e,"_blank","noopener,noreferrer")},S=async()=>{try{j(!0);let e=await A(s,t);e&&(""!==e.error?(console.error(e.error),j(!1),w(null),a(null)):(w(e.document),j(!1)))}catch(e){console.error("Failed to fetch document:",e),j(!1)}};return s?(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex gap-2 p-6 items-center justify-end lg:justify-between h-min w-full",children:[(0,l.jsx)("div",{className:"hidden lg:flex gap-2 justify-start ",children:(0,l.jsx)(ei,{tooltip_text:"Inspect your all information about your document, such as chunks, metadata and more.",display_text:N?N.title:"Loading..."})}),(0,l.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,l.jsx)(b,{title:"Content",Icon:p.Vqr,onClick:()=>f("Content"),selected:"Content"===u,selected_color:"bg-secondary-verba"}),(0,l.jsx)(b,{title:"Chunks",Icon:p.Fqs,onClick:()=>f("Chunks"),selected:"Chunks"===u,selected_color:"bg-secondary-verba"}),(0,l.jsx)(b,{title:"Vector",Icon:h.FUn,onClick:()=>f("Vector Space"),selected:"Vector Space"===u,selected_color:"bg-secondary-verba"}),(0,l.jsx)(b,{Icon:p.B4e,onClick:()=>{a(null)}})]})]}),(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex flex-col p-6 h-full w-full overflow-y-auto overflow-x-hidden",children:["Content"===u&&(0,l.jsx)(eI,{selectedTheme:c,document:N,credentials:t,selectedDocument:s,chunkScores:r}),"Chunks"===u&&(0,l.jsx)(eh,{selectedTheme:c,credentials:t,selectedDocument:s}),"Vector Space"===u&&(0,l.jsx)(e_,{credentials:t,selectedDocument:s,chunkScores:r,production:i}),"Metadata"===u&&(0,l.jsx)(eE,{credentials:t,selectedDocument:s})]}),(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex gap-2 p-6 items-center justify-between h-min w-full",children:[(0,l.jsxs)("div",{className:"flex gap-3",children:[o.some(e=>e.uuid===s)&&(0,l.jsx)(b,{title:"Delete from Chat",Icon:p.B4e,selected:!0,selected_color:"bg-warning-verba",onClick:()=>{d(o.filter(e=>e.uuid!==s)),x("Removed document from Chat","INFO")}}),!o.some(e=>e.uuid===s)&&N&&(0,l.jsx)(b,{title:"Add to Chat",Icon:g.Lgw,onClick:()=>{d([...o,{uuid:s,title:N.title}]),x("Added document to Chat","SUCCESS")}})]}),(0,l.jsxs)("div",{className:"flex gap-3",children:[s&&N&&N.source&&(0,l.jsx)(b,{title:"Go To Source",Icon:m.CkN,onClick:()=>{y(N.source)}}),(0,l.jsx)(b,{title:"Document Info",Icon:m.DAO,onClick:()=>f("Metadata"),selected:"Metadata"===u,selected_color:"bg-secondary-verba"})]})]})]}):(0,l.jsx)("div",{})},eD=e=>{let{credentials:t,selectedTheme:s,addStatusMessage:a,production:r,currentPage:i,ragConfig:c,setRagConfig:o,documentFilter:d,setDocumentFilter:x,labels:u,filterLabels:m,setFilterLabels:g}=e,[f,p]=(0,n.useState)(null),[h,b]=(0,n.useState)([]);return(0,l.jsxs)("div",{className:"flex md:flex-row flex-col justify-center gap-3 h-[50vh] md:h-[80vh] ",children:[(0,l.jsx)("div",{className:"".concat(f?"hidden md:flex md:w-[45vw]":"w-full md:w-[45vw] md:flex"),children:(0,l.jsx)(ep,{addStatusMessage:a,production:r,credentials:t,selectedTheme:s,setSelectedDocument:p,setSelectedChunkScore:b,currentPage:i,ragConfig:c,setRAGConfig:o,documentFilter:d,setDocumentFilter:x,labels:u,filterLabels:m,setFilterLabels:g})}),(0,l.jsx)("div",{className:"".concat(f?"md:w-[55vw] w-full flex":"hidden md:flex md:w-[55vw]"),children:(0,l.jsx)(eR,{addStatusMessage:a,credentials:t,production:r,documentFilter:d,setDocumentFilter:x,setSelectedDocument:p,selectedTheme:s,selectedDocument:f,chunkScores:h})})]})},eO=e=>{let{title:t,modal_id:s,text:a,triggerAccept:n,triggerString:r,triggerValue:i}=e;return(0,l.jsx)("dialog",{id:s,className:"modal",children:(0,l.jsxs)("div",{className:"modal-box flex flex-col gap-2",children:[(0,l.jsx)("h3",{className:"font-bold text-lg",children:t}),(0,l.jsx)("p",{className:"whitespace-pre-wrap",children:a}),(0,l.jsx)("div",{className:"modal-action",children:(0,l.jsxs)("form",{method:"dialog",className:"flex gap-2",children:[n&&r&&(0,l.jsx)(b,{type:"submit",title:r,onClick:()=>{n(i)}}),(0,l.jsx)(b,{type:"submit",title:"Cancel",selected_color:"bg-warning-verba",selected:!0})]})})]})})},eT=e=>{let{selectedDocument:t,setSelectedDocument:s,production:a,addStatusMessage:r,credentials:i}=e,[c,o]=(0,n.useState)(""),[d,x]=(0,n.useState)(1),[u,f]=(0,n.useState)([]),[h,v]=(0,n.useState)(0),[j,N]=(0,n.useState)([]),[w,y]=(0,n.useState)([]),[S,C]=(0,n.useState)(!1),[k,_]=(0,n.useState)(!1),E=(0,n.useCallback)(async e=>{try{_(!0);let t=await J(e||"",w,d,50,i);t&&(""!==t.error?(console.error(t.error),_(!1),f(null),v(0)):(f(t.documents),N(t.labels),_(!1),v(t.totalDocuments)))}catch(e){console.error("Failed to fetch document:",e),_(!1)}},[w,d,i]);(0,n.useEffect)(()=>{C(!0)},[]),(0,n.useEffect)(()=>{E(c)},[E,c]);let I=()=>{E(c)},R=async e=>{if("Demo"===a)return;let l=await G(e,i);r("Deleted document","WARNING"),l&&(e===t&&s(null),E(c))},D=e=>{y(t=>t.filter(t=>t!==e))},O=e=>{let t=document.getElementById(e);t instanceof HTMLDialogElement&&t.showModal()};return(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex gap-2 p-6 items-center justify-between h-min w-full",children:[(0,l.jsx)("div",{className:"hidden lg:flex gap-2 justify-start w-[8vw]",children:(0,l.jsx)(ei,{tooltip_text:"Search and inspect different documents imported into Verba",display_text:"Search"})}),(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow w-full",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),I())},placeholder:"Search for documents (".concat(h,")"),value:c,onChange:e=>{o(e.target.value)}})}),(0,l.jsx)(b,{onClick:I,Icon:m.U41}),(0,l.jsx)(b,{onClick:()=>{o(""),y([]),E("")},icon_size:20,Icon:p.Ffb})]}),(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex flex-col p-6 gap-3 items-center h-full w-full overflow-auto",children:[(0,l.jsxs)("div",{className:"flex flex-col w-full justify-start gap-2",children:[(0,l.jsxs)("div",{className:"dropdown dropdown-hover",children:[(0,l.jsx)("button",{type:"button",children:(0,l.jsx)(b,{title:"Label",className:"btn-sm min-w-min",icon_size:12,text_class_name:"text-xs",Icon:g.Lgw,selected:!1,disabled:!1})}),(0,l.jsx)("ul",{className:"dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52",children:j.map(e=>(0,l.jsx)("li",{children:(0,l.jsx)("button",{type:"button",onClick:()=>{w.includes(e)||y([...w,e]);let t=document.activeElement;t.blur();let s=t.closest(".dropdown");s&&s.blur()},onKeyDown:t=>{if("Enter"===t.key||" "===t.key){t.preventDefault(),w.includes(e)||y([...w,e]);let s=document.activeElement;s.blur();let l=s.closest(".dropdown");l&&l.blur()}},children:e})},"Label-".concat(e)))})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:w.map((e,t)=>(0,l.jsx)(b,{title:e,Icon:p.B4e,className:"btn-sm min-w-min max-w-[200px]",icon_size:12,selected_color:"bg-primary-verba",selected:!0,text_class_name:"truncate max-w-[200px]",text_size:"text-xs",onClick:()=>{D(e)}},"FilterDocumentLabel-".concat(e)))})]}),k&&(0,l.jsx)("div",{className:"flex items-center justify-center gap-2",children:(0,l.jsx)("span",{className:"loading loading-spinner loading-sm text-text-alt-verba"})}),(0,l.jsxs)("div",{className:"flex flex-col w-full",children:[null==u?void 0:u.map((e,n)=>(0,l.jsxs)("div",{className:"flex justify-between items-center gap-2 rounded-2xl p-1 w-full",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center w-full gap-2",children:[(0,l.jsx)(b,{title:e.title,selected:t===e.uuid,selected_color:"bg-secondary-verba",className:"w-[200px] lg:w-[400px]",text_class_name:"truncate max-w-[150px] lg:max-w-[350px]",onClick:()=>s(e.uuid)},"".concat(e.title,"-").concat(e.uuid||n)),"Demo"!==a&&(0,l.jsx)(b,{Icon:m.Xm5,selected:t===e.uuid,selected_color:"bg-warning-verba",className:"max-w-min",onClick:()=>{O("remove_document".concat(e.uuid))}},"".concat(e.title+n,"delete"))]}),(0,l.jsx)(eO,{modal_id:"remove_document".concat(e.uuid),title:"Remove Document",text:"Do you want to remove ".concat(e.title,"?"),triggerString:"Delete",triggerValue:e.uuid,triggerAccept:R})]},"Document".concat(n).concat(e.title)))," "]})]}),(0,l.jsx)("div",{className:"bg-bg-alt-verba rounded-2xl flex gap-2 p-6 items-center justify-center h-min w-full",children:(0,l.jsx)("div",{className:"flex gap-3 items-center justify-center w-full",children:(0,l.jsx)("div",{className:"join justify-center items-center text-text-verba",children:(0,l.jsxs)("div",{className:"flex justify-center items-center gap-2 p-3 bg-bg-alt-verba",children:[(0,l.jsx)(b,{title:"Previous Page",onClick:()=>{u&&(1===d?x(Math.ceil(h/50)):x(e=>e-1))},className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",Icon:m.O18}),(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsxs)("p",{className:"text-xs text-text-verba",children:["Page ",d]})}),(0,l.jsx)(b,{title:"Next Page",onClick:()=>{u&&(50*d<h?x(e=>e+1):x(1))},className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",Icon:m.Rdr})]})})})})]})},eA=e=>{let{selectedTheme:t,production:s,credentials:a,documentFilter:r,setDocumentFilter:i,addStatusMessage:c}=e,[o,d]=(0,n.useState)(null);return(0,l.jsxs)("div",{className:"flex flex-col md:flex-row justify-center gap-3 h-[80vh]",children:[(0,l.jsx)("div",{className:"".concat(o?"hidden md:flex md:w-[45vw]":"w-full md:w-[45vw] md:flex"),children:(0,l.jsx)(eT,{production:s,addStatusMessage:c,setSelectedDocument:d,credentials:a,selectedDocument:o})}),(0,l.jsx)("div",{className:"".concat(o?"md:w-[55vw] w-full flex":"hidden md:flex md:w-[55vw]"),children:(0,l.jsx)(eR,{production:s,credentials:a,addStatusMessage:c,setSelectedDocument:d,selectedTheme:t,selectedDocument:o,documentFilter:r,setDocumentFilter:i})})]})},eM=s(3629),eF=s(5983),ez=e=>{let{selectedFileData:t,fileMap:s,selectComponent:a,updateConfig:c,saveComponentConfig:o,setFileMap:d,blocked:x,addStatusMessage:u}=e,[g,h]=(0,n.useState)(""),[v,j]=(0,n.useState)(""),[N,w]=(0,n.useState)(""),[y,S]=(0,n.useState)("");(0,n.useEffect)(()=>{t&&(h(s[t].filename),j(s[t].source),w(s[t].metadata))},[s,t]);let C=(0,n.useCallback)((e,l)=>{if(t){let a=JSON.parse(JSON.stringify(s[t]));a[e]=l;let n={...s};n[t]=a,d(n)}},[t,s,d]),k=(0,n.useCallback)(e=>{let t=e.target.value;h(t),C("filename",t)},[C]),_=(0,n.useCallback)(e=>{let t=e.target.value;j(t),C("source",t)},[C]),E=(0,n.useCallback)(e=>{let t=e.target.value;w(t),C("metadata",t)},[C]),I=e=>{if(t){let l=JSON.parse(JSON.stringify(s[t]));l.overwrite=e;let a={...s};a[t]=l,d(a)}},R=e=>{if(t&&!s[t].labels.includes(e)&&e.length>0){let l=JSON.parse(JSON.stringify(s[t]));l.labels.push(e);let a={...s};a[t]=l,d(a),S("")}},D=e=>{if(t&&s[t].labels.includes(e)&&e.length>0){let l=JSON.parse(JSON.stringify(s[t]));l.labels=l.labels.filter(t=>t!==e);let a={...s};a[t]=l,d(a),S("")}};if(t){var O;return(0,l.jsxs)("div",{className:"flex flex-col justify-start gap-3 rounded-2xl p-1 w-full ",children:[t&&"READY"!==s[t].status&&(0,l.jsx)("div",{className:"divider  text-text-alt-verba",children:"Import Status"}),(0,l.jsx)("div",{className:"flex flex-col gap-3 text-text-verba",children:t&&Object.entries(s[t].status_report).map(e=>{let[t,s]=e;return(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsxs)("p",{className:"flex min-w-[8vw] gap-2 items-center text-text-verba",children:["DONE"===s.status&&(0,l.jsx)(m.FJM,{size:15}),"ERROR"===s.status&&(0,l.jsx)(p.vVM,{size:15}),i[s.status]]}),(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full ".concat(r[s.status]," bg-bg-verba"),children:(0,l.jsx)("input",{type:"text",className:"grow w-full",value:0!==s.took?"".concat(s.message," (").concat(s.took,"s)"):s.message,disabled:!0})})]},"Status".concat(t))})}),(0,l.jsx)(ed,{ragConfig:s[t].rag_config,componentName:"Reader",selectComponent:a,updateConfig:c,skipComponent:!0,saveComponentConfig:o,blocked:s[t].block}),(0,l.jsx)("div",{className:"divider text-text-alt-verba",children:"File Settings"}),(0,l.jsxs)("div",{className:"flex gap-2 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:"Title"}),(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow w-full",value:g,onChange:k,disabled:x})})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]"}),(0,l.jsx)("p",{className:"text-sm text-text-alt-verba text-start",children:"Add a Title to the document. If you are adding a URL, all URL will have a have their corresponding URL as filename."})]}),(0,l.jsxs)("div",{className:"flex gap-2 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:"Source Link"}),(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow w-full",value:v,onChange:_,disabled:x})})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]"}),(0,l.jsx)("p",{className:"text-sm text-text-alt-verba text-start",children:"Add a link to reference the original source of the document. You can access it through the Document Explorer via the View Source button"})]}),(0,l.jsxs)("div",{className:"flex gap-2 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:"Labels"}),(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow w-full",value:y,onChange:e=>{S(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),R(y))},disabled:x,title:y})}),(0,l.jsx)(b,{title:"Add",Icon:f.Kth,onClick:()=>{R(y)},disabled:x})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]"}),(0,l.jsx)("p",{className:"text-sm text-text-alt-verba text-start",children:"Add or remove labels for Document Filtering"})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries((O=s[t]).labels).map(e=>{let[t,s]=e;return(0,l.jsx)(b,{title:s,className:"btn-sm",text_class_name:"text-xs",onClick:()=>{D(s)},Icon:p.B4e},O.fileID+t+s)})})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:"Overwrite"}),(0,l.jsx)("input",{type:"checkbox",className:"checkbox checkbox-md",onChange:e=>I(e.target.checked),checked:!!t&&s[t].overwrite,disabled:x})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]"}),(0,l.jsx)("p",{className:"text-sm text-text-alt-verba text-start",children:"Overwrite existing documents with the same name."})]}),(0,l.jsx)("div",{className:"divider  text-text-alt-verba",children:"Metadata"}),(0,l.jsxs)("div",{className:"flex gap-2 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:"Metadata"}),(0,l.jsx)("textarea",{className:"grow w-full textarea flex items-center gap-2 max-h-64 bg-bg-verba",value:N,onChange:E,disabled:x})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]"}),(0,l.jsx)("p",{className:"text-sm text-text-alt-verba text-start",children:"Add metadata to the document to improve retrieval and generation. Metadata will added to the context sent to the embedding and generation, to influcence the results."})]}),(0,l.jsx)("div",{className:"divider  text-text-alt-verba",children:"File Information"}),(0,l.jsxs)("div",{className:"flex gap-2 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:"Extension"}),(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow w-full",value:s[t].extension,disabled:!0})})]}),(0,l.jsxs)("div",{className:"flex gap-2 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:"File Size"}),(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow w-full",value:(e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/1024**t).toFixed(2)," ").concat(["B","KB","MB","GB","TB"][t])})(s[t].file_size),disabled:!0})})]}),(0,l.jsx)("div",{className:"divider  text-text-alt-verba",children:"Ingestion Pipeline"}),(0,l.jsxs)("div",{className:"flex gap-2 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:"Reader"}),(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow w-full",value:s[t].rag_config.Reader.selected,disabled:!0})})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]"}),(0,l.jsx)("p",{className:"text-sm text-text-alt-verba text-start",children:t&&s[t].rag_config.Reader.components[s[t].rag_config.Reader.selected].description})]}),(0,l.jsxs)("div",{className:"flex gap-2 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:"Chunker"}),(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow w-full",value:s[t].rag_config.Chunker.selected,disabled:!0})})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]"}),(0,l.jsx)("p",{className:"text-sm text-text-alt-verba text-start",children:t&&s[t].rag_config.Chunker.components[s[t].rag_config.Chunker.selected].description})]}),(0,l.jsxs)("div",{className:"flex gap-2 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:"Embedder"}),(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow w-full",value:s[t].rag_config.Embedder.selected,disabled:!0})})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]"}),(0,l.jsx)("p",{className:"text-sm text-text-alt-verba text-start",children:t&&s[t].rag_config.Embedder.components[s[t].rag_config.Embedder.selected].description})]}),(0,l.jsx)("div",{className:"divider"}),(0,l.jsxs)("div",{className:"flex gap-2 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:"Debug"}),(0,l.jsx)(b,{Icon:eF.ZWp,onClick:()=>{let e=document.getElementById("File_Debug_Modal");e instanceof HTMLDialogElement&&e.showModal()},className:"max-w-min"})]}),(0,l.jsx)("dialog",{id:"File_Debug_Modal",className:"modal",children:(0,l.jsxs)("div",{className:"modal-box min-w-fit",children:[(0,l.jsx)("h3",{className:"font-bold text-lg",children:"Debugging File Configuration"}),(0,l.jsx)("pre",{className:"whitespace-pre-wrap text-xs",children:t?(()=>{let e={...s[t]};return e.content="File Content",JSON.stringify(e,null,2)})():""}),(0,l.jsx)("div",{className:"modal-action",children:(0,l.jsx)("form",{method:"dialog",children:(0,l.jsx)("button",{type:"button",className:"btn text-text-verba bg-warning-verba border-none hover:bg-button-hover-verba ml-2",children:"Close"})})})]})})]})}return(0,l.jsx)("div",{})},eP=e=>{var t;let{selectedFileData:s,fileMap:a,addStatusMessage:r,setFileMap:i,ragConfig:c,setRAGConfig:o,setSelectedFileData:d,credentials:x}=e,[u,g]=(0,n.useState)("Basic"),h=async()=>{r("Setting current config as default","SUCCESS"),s&&(await D(a[s].rag_config,x)?o(a[s].rag_config):console.error("Failed to set RAG config:"))},v=(0,n.useCallback)((e,t,l)=>{i(a=>{if(s){let n={...a},r=n[s],i=r.rag_config[e].components[r.rag_config[e].selected].config;return"string"==typeof l||"boolean"==typeof l?i[t].value=l:i[t].values=l,n}return a})},[s,i]),j=(e,t)=>{i(l=>{if(s){let a=JSON.parse(JSON.stringify(l[s])),n=JSON.parse(JSON.stringify(l[s].rag_config));n[e].selected=t,a.rag_config=n;let r={...l};return r[s]=a,r}return l})},N=(0,n.useCallback)(async(e,t,s)=>{if(!c)return;r("Saving ".concat(t," config"),"SUCCESS");let l=JSON.parse(JSON.stringify(c));l[e].selected=t,l[e].components[t]=s,await D(l,x)&&o(l)},[c,x,r,o]);return(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex gap-2 p-6 items-center justify-between h-min w-full",children:[(0,l.jsx)("div",{className:"flex gap-2 justify-start ",children:(0,l.jsx)(ei,{tooltip_text:"Configure all import settings related to chunking, embedding, adding meta data and more. You can save made changes individually or apply them to all other files",display_text:"Import Config"})}),(0,l.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,l.jsx)(b,{title:"Overview",selected:"Basic"===u,selected_color:"bg-secondary-verba",onClick:()=>{g("Basic")},Icon:f.zfW}),(0,l.jsx)(b,{title:"Config",selected:"Pipeline"===u,selected_color:"bg-secondary-verba",onClick:()=>{g("Pipeline")},Icon:m.KOq}),(0,l.jsx)(b,{onClick:()=>{d(null)},Icon:p.B4e})]})]}),(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex flex-col p-6 items-center h-full w-full overflow-auto",children:["Basic"===u&&(0,l.jsx)(ez,{selectedFileData:s,addStatusMessage:r,fileMap:a,selectComponent:j,updateConfig:v,saveComponentConfig:N,setFileMap:i,blocked:s?null!==(t=a[s].block)&&void 0!==t&&t:void 0}),"Pipeline"===u&&s&&(0,l.jsxs)("div",{className:"flex flex-col gap-10 w-full",children:[(0,l.jsx)(ed,{ragConfig:a[s].rag_config,componentName:"Chunker",selectComponent:j,updateConfig:v,saveComponentConfig:N,blocked:a[s].block,skipComponent:!1}),(0,l.jsx)(ed,{ragConfig:a[s].rag_config,componentName:"Embedder",selectComponent:j,updateConfig:v,saveComponentConfig:N,blocked:a[s].block,skipComponent:!1})]})]}),(0,l.jsx)("div",{className:"bg-bg-alt-verba rounded-2xl flex gap-2 p-6 items-center justify-end h-min w-full",children:(0,l.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,l.jsx)(b,{title:"Apply to All",onClick:()=>{let e=document.getElementById("apply_setting_to_all");e instanceof HTMLDialogElement&&e.showModal()},Icon:eM.HL_}),(0,l.jsx)(b,{title:"Save Config",onClick:()=>{let e=document.getElementById("set_default_settings");e instanceof HTMLDialogElement&&e.showModal()},Icon:f.zfW}),(0,l.jsx)(b,{title:"Reset",onClick:()=>{let e=document.getElementById("reset_Setting");e instanceof HTMLDialogElement&&e.showModal()},Icon:p.B4e})]})}),(0,l.jsx)(eO,{modal_id:"apply_setting_to_all",title:"Apply Pipeline Settings",text:"Apply Pipeline Settings to all files?",triggerString:"Apply",triggerValue:null,triggerAccept:()=>{r("Applying config to all files","INFO"),i(e=>{if(s){let t=JSON.parse(JSON.stringify(e[s].rag_config)),l={...e};for(let a in e){let n=JSON.parse(JSON.stringify(e[a]));n.rag_config=t,n.source=e[s].source,n.labels=e[s].labels,n.overwrite=e[s].overwrite,l[a]=n}return l}return e})}}),(0,l.jsx)(eO,{modal_id:"reset_Setting",title:"Reset Setting",text:"Reset pipeline settings of this file?",triggerString:"Reset",triggerValue:null,triggerAccept:()=>{r("Resetting pipeline settings","WARNING"),i(e=>{if(s&&c){let t={...e},l=JSON.parse(JSON.stringify(e[s]));return l.rag_config=c,t[s]=l,t}return e})}}),(0,l.jsx)(eO,{modal_id:"set_default_settings",title:"Set Default",text:"Set current pipeline settings as default for future files?",triggerString:"Set",triggerValue:null,triggerAccept:h})]})},eL=e=>{let{fileData:t,fileMap:s,handleDeleteFile:a,selectedFileData:n,setSelectedFileData:r}=e;return(0,l.jsxs)("div",{className:"flex justify-between items-center gap-2 rounded-2xl p-1 w-full",children:["READY"!==s[t.fileID].status?(0,l.jsxs)("div",{className:"flex gap-2",children:["DONE"!==s[t.fileID].status&&"ERROR"!==s[t.fileID].status&&(0,l.jsx)(b,{title:i[s[t.fileID].status],text_class_name:"text-xs",className:"w-[120px]"}),"DONE"===s[t.fileID].status&&(0,l.jsx)(b,{title:i[s[t.fileID].status],Icon:m.FJM,selected:!0,className:"w-[120px]",selected_color:"bg-secondary-verba"}),"ERROR"===s[t.fileID].status&&(0,l.jsx)(b,{title:i[s[t.fileID].status],Icon:p.vVM,className:"w-[120px]",selected:!0,selected_color:"bg-warning-verba"})]}):(0,l.jsx)("div",{className:"flex gap-2",children:(0,l.jsx)(b,{title:s[t.fileID].rag_config.Reader.selected,className:"w-[120px]",text_class_name:"truncate w-[100px]"})}),(0,l.jsx)(b,{title:s[t.fileID].filename?s[t.fileID].filename:"No Filename",selected:n===s[t.fileID].fileID,selected_color:"bg-secondary-verba",className:"w-[200px] lg:w-[350px]",text_class_name:"truncate max-w-[150px] lg:max-w-[300px]",onClick:()=>{r(t.fileID)}}),(0,l.jsx)(b,{Icon:m.Xm5,onClick:()=>{let e=document.getElementById("remove_file_".concat(s[t.fileID].filename));e instanceof HTMLDialogElement&&e.showModal()},className:"w-[120px] max-w-min",selected:n===s[t.fileID].fileID,selected_color:"bg-warning-verba"}),(0,l.jsx)(eO,{modal_id:"remove_file_".concat(s[t.fileID].filename),title:"Remove File",text:s[t.fileID].isURL?"Do you want to remove the URL?":"Do you want to remove ".concat(s[t.fileID].filename," from the selection?"),triggerString:"Delete",triggerValue:s[t.fileID].fileID,triggerAccept:a})]})},eU=e=>{let{fileMap:t,setFileMap:s,RAGConfig:a,addStatusMessage:r,setRAGConfig:i,selectedFileData:c,setSelectedFileData:o,importSelected:d,socketStatus:x,reconnect:u,importAll:f}=e,v=n.useRef(null);(0,n.useEffect)(()=>{null!==v.current&&(v.current.setAttribute("directory",""),v.current.setAttribute("webkitdirectory",""))},[v]);let j=e=>{s(t=>{if(null===e)return r("Cleared all files","WARNING"),o(null),{};e===c&&o(null),r("Cleared selected file","WARNING");let s={...t};return delete s[e],s})},[N,w]=(0,n.useState)(null),[y,S]=(0,n.useState)(null),C=async(e,l)=>{if(e.target.files&&a){let n=e.target.files,i={...t},c=l?y:N;r("Added new files","SUCCESS");for(let e=0;e<n.length;e++){let t=n[e],s=JSON.parse(JSON.stringify(a));c&&(s.Reader.selected=c);let l=t.name,r=t.name;if(r in i){let e=Date.now();r="".concat(r,"_").concat(e)}let o=t.name.split(".").pop()||"",d=await function(e){return new Promise((t,s)=>{let l=new FileReader;l.onload=()=>{t(function(e){let t="",s=new Uint8Array(e),l=s.byteLength;for(let e=0;e<l;e++)t+=String.fromCharCode(s[e]);return btoa(t)}(l.result))},l.onerror=()=>s(l.error),l.readAsArrayBuffer(e)})}(t);i[r]={fileID:r,filename:l,extension:o,status_report:{},source:"",isURL:!1,metadata:"",overwrite:!1,content:d,labels:["Document"],rag_config:s,file_size:_(d),status:"READY"}}s(i),o(Object.keys(i)[0]),e.target.value=""}},k=e=>{if(a){let l={...t},n=JSON.parse(JSON.stringify(a));n.Reader.selected=e;let i=new Date().toISOString();r("Added new URL Job","SUCCESS"),l[i]={fileID:i,filename:"New ".concat(e," Job"),metadata:"",status_report:{},extension:"URL",isURL:!0,source:"",overwrite:!1,content:"",labels:["Document"],rag_config:n,file_size:0,status:"READY"},s(l),o(i)}},_=e=>{let t=e.replace(/\s+/g,"");if(t.length%2!=0)throw Error("Invalid hex string length.");return t.length/2};return(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex gap-2 p-6 items-center justify-end lg:justify-between h-min w-full",children:[(0,l.jsx)("div",{className:"hidden lg:flex gap-2 justify-start ",children:(0,l.jsx)(ei,{tooltip_text:"Upload your data through this interface into Verba. You can select individual files, directories or add URL to fetch data from.",display_text:"File Selection"})}),(0,l.jsxs)("div",{className:"flex gap-3 justify-center lg:justify-end",children:[(0,l.jsxs)("div",{className:"dropdown dropdown-hover",children:[(0,l.jsx)("div",{role:"button",tabIndex:0,children:(0,l.jsx)(b,{title:"Files",Icon:g.Lgw,onClick:()=>{var e;return null===(e=document.getElementById("files_upload"))||void 0===e?void 0:e.click()}})}),(0,l.jsx)("ul",{className:"dropdown-content menu bg-base-100 rounded-box z-[1] w-52 p-2 shadow",children:a&&Object.entries(a.Reader.components).filter(e=>{let[t,s]=e;return"URL"!==s.type}).map(e=>{let[t,s]=e;return(0,l.jsx)("li",{onClick:()=>{var e;w(s.name),null===(e=document.getElementById("files_upload"))||void 0===e||e.click(),el()},children:(0,l.jsx)("button",{type:"button",children:s.name})},"File_".concat(s.name).concat(t))})})]}),(0,l.jsx)("input",{id:"files_upload",type:"file",onChange:e=>C(e,!1),className:"hidden",multiple:!0}),(0,l.jsxs)("div",{className:"dropdown dropdown-hover",children:[(0,l.jsx)("div",{role:"button",tabIndex:0,children:(0,l.jsx)(b,{title:"Directory",Icon:ec.Lec})}),(0,l.jsx)("ul",{className:"dropdown-content menu bg-base-100 rounded-box z-[1] w-52 p-2 shadow",children:a&&Object.entries(a.Reader.components).filter(e=>{let[t,s]=e;return"URL"!==s.type}).map(e=>{let[t,s]=e;return(0,l.jsx)("li",{onClick:()=>{var e;S(s.name),null===(e=document.getElementById("dir_upload"))||void 0===e||e.click(),el()},onKeyDown:e=>{if("Enter"===e.key||" "===e.key){var t;e.preventDefault(),S(s.name),null===(t=document.getElementById("dir_upload"))||void 0===t||t.click(),el()}},children:(0,l.jsx)("button",{type:"button",children:s.name})},"Dir_".concat(s.name).concat(t))})})]}),(0,l.jsx)("input",{id:"dir_upload",type:"file",ref:v,onChange:e=>C(e,!0),className:"hidden",multiple:!0}),(0,l.jsxs)("div",{className:"dropdown dropdown-hover",children:[(0,l.jsx)("div",{role:"button",tabIndex:0,children:(0,l.jsx)(b,{title:"URL",Icon:g.Lgw})}),(0,l.jsx)("input",{id:"url_upload",type:"file",className:"hidden"}),(0,l.jsx)("ul",{className:"dropdown-content menu bg-base-100 rounded-box z-[1] w-52 p-2 shadow",children:a&&Object.entries(a.Reader.components).filter(e=>{let[t,s]=e;return"URL"===s.type}).map(e=>{let[t,s]=e;return(0,l.jsx)("li",{onClick:()=>{k(s.name),el()},onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),k(s.name),el())},children:(0,l.jsx)("button",{type:"button",children:s.name})},"URL_".concat(s.name).concat(t))})})]})]})]}),(0,l.jsx)("div",{className:"bg-bg-alt-verba rounded-2xl flex flex-col p-6 items-center h-full w-full overflow-auto",children:Object.entries(t).map(e=>{let[s,a]=e;return(0,l.jsx)(eL,{fileData:a,handleDeleteFile:j,selectedFileData:c,setSelectedFileData:o,fileMap:t},"FileComponent_".concat(s))})}),"ONLINE"===x?(0,l.jsx)("div",{className:"bg-bg-alt-verba rounded-2xl flex gap-2 p-6 items-center justify-end h-min w-full",children:(0,l.jsxs)("div",{className:"flex flex-wrap gap-3 justify-end",children:[c&&(0,l.jsx)(b,{title:"Import Selected",Icon:m.Xur,onClick:d}),(0,l.jsx)(b,{title:"Import All",Icon:m.Xur,onClick:f}),(0,l.jsx)(b,{title:"Clear Files",Icon:p.B4e,onClick:()=>{let e=document.getElementById("remove_all_files");e instanceof HTMLDialogElement&&e.showModal()}})]})}):(0,l.jsx)("div",{className:"bg-bg-alt-verba rounded-2xl flex gap-2 p-6 items-center justify-end h-min w-full",children:(0,l.jsx)("div",{className:"flex gap-3 justify-end",children:(0,l.jsxs)("button",{onClick:u,className:"flex btn border-none text-text-verba bg-button-verba hover:bg-button-hover-verba gap-2 items-center",children:[(0,l.jsx)(h.Nwf,{size:15}),(0,l.jsx)("p",{children:"Reconnecting..."}),(0,l.jsx)("span",{className:"loading loading-spinner loading-xs"})]})})}),(0,l.jsx)(eO,{modal_id:"remove_all_files",title:"Clear all files?",text:"Do you want to clear all files from your selection?",triggerString:"Clear All",triggerValue:null,triggerAccept:j})]})},eJ=e=>{let{credentials:t,RAGConfig:s,setRAGConfig:a,addStatusMessage:r}=e,[i,c]=(0,n.useState)({}),[o,d]=(0,n.useState)(null),[x,u]=(0,n.useState)(!1),[m,g]=(0,n.useState)(null),[f,p]=(0,n.useState)("DISCONNECTED"),[h,b]=(0,n.useState)(0);(0,n.useEffect)(()=>{u(!0)},[]),(0,n.useEffect)(()=>{let e,t=!0,s=async function(){let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!t)return;let a=new WebSocket(ea()),n=Math.min(1e3*2**(l-1)+1e3*Math.random(),3e4);a.onopen=()=>{if(!t){a.close(1e3,"Component unmounted during connection");return}p("CONNECTED")},a.onmessage=e=>{if(t){p("CONNECTED");try{let t=JSON.parse(e.data);if("type"in t&&"pong"===t.type)return;"new_file_id"in t?c(e=>{let s={...e};return s[t.new_file_id]={...s[t.original_file_id],fileID:t.new_file_id,filename:t.filename,block:!0},s}):j(t)}catch(t){console.error("Received data is not valid JSON:",e.data);return}}},a.onerror=e=>{t&&(console.error("Import WebSocket Error:",e),p("DISCONNECTED"))},a.onclose=e=>{t&&(p("DISCONNECTED"),v(),e.wasClean||(console.error("WebSocket connection died"),l<5?setTimeout(()=>{t&&s(l+1)},n):r("Connection lost. Please refresh the page.","ERROR")))},g(a);let i=setInterval(()=>{a.readyState===WebSocket.OPEN&&a.send(JSON.stringify({type:"ping"}))},3e4);e=()=>{clearInterval(i),a.readyState!==WebSocket.CLOSED&&a.close(1e3,"Component unmounting")}};return s(),()=>{t=!1,e&&e(),m&&"readyState"in m&&m.readyState!==WebSocket.CLOSED&&m.close(1e3,"Component unmounting")}},[x,r]);let v=()=>{c(e=>{if(i){let t={...e};for(let e in t)"DONE"!==t[e].status&&"ERROR"!==t[e].status&&"READY"!==t[e].status&&(t[e].status="ERROR",t[e].status_report.ERROR={fileID:e,status:"ERROR",message:"Connection was interrupted",took:0});return t}return e})},j=e=>{"DONE"===e.status&&r("File ".concat(e.fileID," imported"),"SUCCESS"),"ERROR"===e.status&&r("File ".concat(e.fileID," import failed"),"ERROR"),c(t=>{if(e&&e.fileID in t){let s=JSON.parse(JSON.stringify(t[e.fileID])),l={...t};return s.status=e.status,s.status_report[e.status]=e,l[e.fileID]=s,l}return t})},N=e=>{c(t=>{if(e in t){let s=JSON.parse(JSON.stringify(t[e])),l={...t};return s.status="WAITING",Object.entries(s.status_report).length>0&&(s.status_report={}),l[e]=s,l}return t})},w=(e,s)=>{if(m&&"readyState"in m&&m.readyState===WebSocket.OPEN){N(s);let l=[],a=0;for(;a<e.length;){let t=e.slice(a,a+2e3);l.push(t),a+=2e3}let n=l.length;l.forEach((e,l)=>{m.send(JSON.stringify({chunk:e,isLastChunk:l===n-1,total:n,order:l,fileID:s,credentials:t}))})}else console.error("WebSocket is not open. ReadyState:",m&&"readyState"in m?m.readyState:"unknown"),u(e=>!e)};return(0,l.jsxs)("div",{className:"flex justify-center gap-3 h-[80vh] ",children:[(0,l.jsx)("div",{className:"".concat(o?"hidden md:flex md:w-[45vw]":"w-full md:w-[45vw] md:flex"),children:(0,l.jsx)(eU,{fileMap:i,addStatusMessage:r,setFileMap:c,RAGConfig:s,setRAGConfig:a,selectedFileData:o,setSelectedFileData:d,importSelected:()=>{r("Importing selected file","INFO"),o&&["READY","DONE","ERROR"].includes(i[o].status)&&!i[o].block&&w(JSON.stringify(i[o]),o)},importAll:()=>{for(let e in r("Importing all files","INFO"),i)["READY","DONE","ERROR"].includes(i[e].status)&&!i[e].block&&w(JSON.stringify(i[e]),e)},socketStatus:"CONNECTED"===f?"ONLINE":"OFFLINE",reconnect:()=>{u(e=>!e)}})}),(0,l.jsx)("div",{className:"".concat(o?"md:w-[55vw] w-full flex":"hidden md:flex md:w-[55vw]"),children:o&&(0,l.jsx)(eP,{addStatusMessage:r,selectedFileData:o,ragConfig:s,credentials:t,setRAGConfig:a,fileMap:i,setFileMap:c,setSelectedFileData:d})})]})},eG=s(3145),eW=s(2649),eB=e=>{let{hide:t,Icon:s,title:a,currentPage:n,setCurrentPage:r,setPage:i}=e;return(0,l.jsx)(b,{title:a,Icon:s,selected_color:"bg-primary-verba",selected:n===i,onClick:()=>{r(i)},disabled:t})},eq=e=>{let{imageSrc:t,title:s,subtitle:a,currentPage:n,setCurrentPage:r,production:i}=e;return(0,l.jsxs)("div",{className:"flex justify-between items-center mb-10",children:[(0,l.jsxs)("div",{className:"flex flex-row items-center gap-5",children:[(0,l.jsx)(eG.default,{src:t,alt:"Logo",width:50,height:50,className:"flex rounded-lg w-[50px] md:w-[80px] md:h-[80px] object-contain"}),(0,l.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-end justify-center lg:gap-3",children:[(0,l.jsx)("p",{className:"text-2xl md:text-3xl text-text-verba",children:s}),(0,l.jsx)("p",{className:"text-sm md:text-base text-text-alt-verba font-light",children:a})]}),(0,l.jsx)("div",{className:"flex md:hidden flex-col items-center gap-3 justify-between",children:(0,l.jsxs)("div",{className:"dropdown dropdown-hover",children:[(0,l.jsx)(b,{Icon:eW.QQh,title:"Menu"}),(0,l.jsxs)("ul",{className:"dropdown-content dropdown-left z-[1] menu p-2 shadow bg-base-100 rounded-box w-52",children:[(0,l.jsx)("li",{children:(0,l.jsx)("a",{className:"CHAT"===n?"font-bold":"",onClick:()=>{r("CHAT"),el()},children:"Chat"})},"Menu Button1"),(0,l.jsx)("li",{children:(0,l.jsx)("a",{className:"DOCUMENTS"===n?"font-bold":"",onClick:()=>{r("DOCUMENTS"),el()},children:"Documents"})},"Menu Button2"),"Demo"!==i&&(0,l.jsx)("li",{children:(0,l.jsx)("a",{className:"IMPORT_DATA"===n?"font-bold":"",onClick:()=>{r("IMPORT_DATA"),el()},children:"Import Data"})},"Menu Button4"),"Demo"!==i&&(0,l.jsx)("li",{children:(0,l.jsx)("a",{className:"SETTINGS"===n?"font-bold":"",onClick:()=>{r("SETTINGS"),el()},children:"Settings"})},"Menu Button5")]})]})})]}),(0,l.jsx)("div",{className:"flex flex-row justify-center items-center",children:(0,l.jsxs)("div",{className:"hidden md:flex flex-row items-center gap-3 justify-between",children:[(0,l.jsx)(eB,{hide:!1,Icon:f.utr,title:"Chat",currentPage:n,setCurrentPage:r,setPage:"CHAT"}),"Demo"!==i&&(0,l.jsx)(eB,{hide:!1,Icon:f.p8f,title:"Import Data",currentPage:n,setCurrentPage:r,setPage:"IMPORT_DATA"}),(0,l.jsx)(eB,{hide:!1,Icon:f.emU,title:"Documents",currentPage:n,setCurrentPage:r,setPage:"DOCUMENTS"}),"Demo"!==i&&(0,l.jsx)(eB,{hide:!1,Icon:f.zfW,title:"Settings",currentPage:n,setCurrentPage:r,setPage:"SETTINGS"}),(0,l.jsx)("div",{className:"sm:h-[3vh] lg:h-[5vh] mx-1 hidden md:block bg-text-alt-verba w-px"})]})})]})},eV=s(8614),eH=s(988),eQ=s(1151),eK=e=>{let{status_messages:t,set_status_messages:s}=e,[a,r]=(0,n.useState)([]);(0,n.useEffect)(()=>{t.length>0&&(r(e=>[...e,...t]),s([]));let e=setInterval(()=>{let e=new Date().getTime();r(t=>t.filter(t=>e-new Date(t.timestamp).getTime()<5e3))},1e3);return()=>clearInterval(e)},[t,s]);let i=e=>{switch(e){case"INFO":default:return"bg-button-verba";case"WARNING":return"bg-secondary-verba";case"SUCCESS":return"bg-primary-verba";case"ERROR":return"bg-warning-verba"}},c=e=>{switch(e){case"INFO":default:return(0,l.jsx)(u.hCA,{size:15});case"WARNING":return(0,l.jsx)(f.OvZ,{size:15});case"SUCCESS":return(0,l.jsx)(eQ.vuX,{size:15});case"ERROR":return(0,l.jsx)(u.yZ3,{size:15})}};return(0,l.jsx)("div",{className:"fixed bottom-4 right-4 space-y-2",children:(0,l.jsx)(eV.M,{children:a.filter(e=>{let t=new Date(e.timestamp).getTime();return new Date().getTime()-t<5e3}).map((e,t)=>(0,l.jsx)(eH.E.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},className:"".concat(i(e.type)," text-text-verba p-4 min-w-[300px] rounded-lg z-10 shadow-md"),children:(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[c(e.type),(0,l.jsx)("p",{className:"text-xs font-bold",children:e.type})]}),(0,l.jsx)("p",{className:"text-base",children:e.message})]})},t))})})},eY=s(8289),e$=e=>{let{selectedTheme:t,setThemes:s,credentials:a,setSelectedTheme:r,themes:i,addStatusMessage:u}=e,[g,f]=(0,n.useState)(""),h=async()=>{await O(i,t,a),u("Changes to ".concat(t.theme_name," saved"),"SUCCESS")},v=(e,t)=>{r(s=>{let l=s[e];return"text"===l.type?{...s,[e]:{...l,text:t}}:"image"===l.type?{...s,[e]:{...l,src:t}}:"check"===l.type?{...s,[e]:{...l,checked:t}}:"color"===l.type?{...s,[e]:{...l,color:t}}:"select"===l.type||"number"===l.type?{...s,[e]:{...l,value:t}}:s})};(0,n.useEffect)(()=>{s(e=>{let s={...e};return s[t.theme_name]=t,s})},[t,s]);let j=(e,t)=>{var s;if(null===(s=t.target.files)||void 0===s?void 0:s[0]){let s=new FileReader;s.onload=t=>{var s;"string"==typeof(null===(s=t.target)||void 0===s?void 0:s.result)&&v(e,t.target.result)},s.readAsDataURL(t.target.files[0])}},N=(e,s)=>(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"flex gap-3 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:s.description}),"text"===s.type&&(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full border-none bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow w-full",placeholder:e,value:t[e].text,onChange:t=>v(e,t.target.value)})}),"select"===s.type&&(0,l.jsx)("select",{value:t[e].value,onChange:t=>{v(e,t.target.value)},className:"select bg-bg-verba",children:s.options.map(e=>(0,l.jsx)("option",{value:e,children:e},"Select_".concat(e)))}),"color"===s.type&&(0,l.jsxs)("div",{className:"flex flex-col gap-1 h-[15vh] z-10",children:[(0,l.jsx)("label",{className:"input bg-bg-verba input-sm input-bordered flex items-center gap-2 w-full",children:(0,l.jsx)("input",{type:"text",className:"grow",placeholder:e,value:t[e].color,onChange:t=>{v(e,t.target.value)}})}),(0,l.jsx)(eY.gW,{color:t[e].color,className:"z-1",onChange:t=>{v(e,t)}})]}),"image"===s.type&&(0,l.jsxs)("div",{className:"flex justify-between gap-4 w-full items-center",children:[(0,l.jsx)("div",{className:"flex-grow",children:(0,l.jsx)("label",{className:"input flex items-center text-text-verba gap-2 w-full border-none bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow",placeholder:"Enter image URL",value:g,onChange:e=>f(e.target.value)})})}),(0,l.jsxs)("div",{className:"flex justify-between items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)(b,{title:"Set Link",onClick:()=>v(e,g)}),(0,l.jsx)(b,{title:"Upload Image",onClick:()=>{var t;return null===(t=document.getElementById("".concat(e,"ImageInput")))||void 0===t?void 0:t.click()}}),(0,l.jsx)("input",{id:"".concat(e,"ImageInput"),type:"file",accept:"image/*",onChange:t=>j(e,t),className:"hidden"})]}),t[e].src&&(0,l.jsx)(eG.default,{src:t[e].src,alt:"".concat(e," preview"),width:200,height:150,className:"max-w-full max-h-32 rounded-xl"})]})]})]})},e);return(0,l.jsxs)("div",{className:"flex flex-col w-full h-full p-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("p",{className:"text-2xl font-bold",children:"Customize Theme"}),(0,l.jsx)("select",{className:"select bg-bg-verba",value:Object.keys(i).find(e=>i[e]===t)||"",onChange:e=>r(i[e.target.value]),children:Object.keys(i).map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsx)("div",{className:"flex-grow overflow-y-auto",children:(0,l.jsxs)("div",{className:"gap-4 flex flex-col p-4",children:[(0,l.jsx)("p",{className:"font-bold",children:"Customize Logo"}),Object.entries(t).filter(e=>{let[t,s]=e;return"image"===s.type}).map(e=>{let[t,s]=e;return N(t,s)}),(0,l.jsx)("p",{className:"font-bold mt-4",children:"Customize Text"}),Object.entries(t).filter(e=>{let[t,s]=e;return"text"===s.type}).map(e=>{let[t,s]=e;return N(t,s)}),(0,l.jsx)("p",{className:"font-bold mt-4",children:"Customize Font"}),Object.entries(t).filter(e=>{let[t,s]=e;return"select"===s.type}).map(e=>{let[t,s]=e;return N(t,s)}),(0,l.jsx)("p",{className:"font-bold mt-4",children:"Customize Color"}),Object.entries(t).filter(e=>{let[t,s]=e;return"color"===s.type}).map(e=>{let[t,s]=e;return N(t,s)})]})}),(0,l.jsxs)("div",{className:"flex justify-end gap-2 mt-3",children:[(0,l.jsx)(b,{title:"Save",onClick:h,className:"max-w-min",Icon:m.FJM}),(0,l.jsx)(b,{title:"Reset",onClick:()=>{s({Light:c,Dark:o,Weaviate:d,WCD:x}),r(d),u("Themes reset","SUCCESS")},className:"max-w-min",Icon:p.B4e})]})]})},eX=e=>{let{credentials:t,addStatusMessage:s}=e,[a,r]=(0,n.useState)(null),[i,c]=(0,n.useState)(!1),[o,d]=(0,n.useState)(null),x=async()=>{c(!0);let e=await B(t);(null==e?void 0:e.error)===""&&(r(e.node_payload),d(e.collection_payload)),c(!1)};(0,n.useEffect)(()=>{x()},[x]);let u=async()=>{await W("DOCUMENTS",t)?(s("All documents reset","SUCCESS"),x()):s("Failed to reset documents","ERROR")},g=async()=>{await W("ALL",t)?(s("Verba reset","SUCCESS"),x()):s("Failed to reset Verba","ERROR")},p=async()=>{await W("CONFIG",t)?(s("Config reset","SUCCESS"),x()):s("Failed to reset config","ERROR")},h=async()=>{await W("SUGGESTIONS",t)?(s("Suggestions reset","SUCCESS"),x()):s("Failed to reset suggestions","ERROR")},v=e=>{let t=document.getElementById(e);t instanceof HTMLDialogElement&&t.showModal()};return(0,l.jsxs)("div",{className:"flex flex-col w-full h-full p-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("p",{className:"text-2xl font-bold",children:"Admin Panel"}),(0,l.jsx)(b,{title:"Refresh",loading:i,onClick:x,className:"max-w-min",Icon:f.A$d})]}),(0,l.jsx)("div",{className:"flex-grow overflow-y-auto",children:(0,l.jsxs)("div",{className:"gap-4 flex flex-col p-4 text-text-verba",children:[(0,l.jsx)("p",{className:"font-bold text-lg",children:"Resetting Verba"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2 justify-between",children:(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsx)(b,{title:"Clear Documents",onClick:()=>v("reset-documents"),Icon:f.emU}),(0,l.jsx)(b,{title:"Clear Config",onClick:()=>v("reset-configs"),Icon:m.LDL}),(0,l.jsx)(b,{title:"Clear Everything",onClick:()=>v("reset-verba"),Icon:f.VOs}),(0,l.jsx)(b,{title:"Clear Suggestions",onClick:()=>v("reset-suggestions"),Icon:f.VOs})]})}),(0,l.jsx)("p",{className:"font-bold text-lg",children:"Weaviate Information"}),(0,l.jsxs)("div",{className:"flex flex-col border-2 gap-2 border-bg-verba shadow-sm p-4 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm lg:text-base font-semibold text-text-alt-verba",children:"Connected to"}),(0,l.jsx)("p",{className:"   text-text-verba",children:t.url})]}),(0,l.jsxs)("div",{className:"flex flex-col border-2 gap-2 border-bg-verba shadow-sm p-4 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm lg:text-base font-semibold text-text-alt-verba",children:"Deployment"}),(0,l.jsx)("p",{className:" text-text-verba",children:t.deployment})]}),(0,l.jsxs)("div",{className:"flex flex-col border-2 gap-2 border-secondary-verba shadow-sm p-4 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm lg:text-base font-semibold text-text-alt-verba",children:"Version"}),a?(0,l.jsx)("p",{className:"text-text-verba",children:a.weaviate_version}):(0,l.jsx)("span",{className:"loading loading-spinner loading-sm"})]}),(0,l.jsxs)("div",{className:"flex flex-col border-2 border-bg-verba shadow-sm p-4 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)("p",{className:"text-text-alt-verba text-sm lg:text-base font-semibold",children:"Nodes"}),a?(0,l.jsx)("p",{className:"text-text-alt-verba text-sm lg:text-base font-semibold",children:a.node_count}):(0,l.jsx)("span",{className:"loading loading-spinner loading-sm"})]}),a?(0,l.jsx)("ul",{className:"flex flex-col mt-2 list-disc list-inside",children:a.nodes.map(e=>(0,l.jsxs)("li",{className:"text-sm text-text-verba flex justify-between",children:[(0,l.jsx)("span",{className:"w-64 truncate",children:e.name}),(0,l.jsxs)("span",{children:["(",e.status," - ",e.shards," shards)"]})]},"Node".concat(e.name)))}):(0,l.jsx)("span",{className:"loading loading-dots loading-sm mt-2"})]}),(0,l.jsxs)("div",{className:"flex flex-col border-2 border-bg-verba shadow-sm p-4 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)("p",{className:"text-text-alt-verba text-sm lg:text-base font-semibold",children:"Collections"}),o?(0,l.jsx)("p",{className:"text-text-alt-verba text-sm lg:text-base font-semibold",children:o.collection_count}):(0,l.jsx)("span",{className:"loading loading-spinner loading-sm"})]}),o?(0,l.jsx)("ul",{className:"flex flex-col mt-2 list-disc list-inside",children:o.collections.map(e=>(0,l.jsxs)("li",{className:"text-sm text-text-verba flex justify-between",children:[(0,l.jsx)("span",{className:"w-128 truncate",children:e.name}),(0,l.jsxs)("span",{children:[e.count," objects"]})]},"Collection".concat(e.name)))}):(0,l.jsx)("span",{className:"loading loading-dots loading-sm mt-2"})]})]})}),(0,l.jsx)(eO,{modal_id:"reset-documents",title:"Reset Documents",text:"Are you sure you want to reset all documents? This will clear all documents and chunks from Verba.",triggerAccept:u,triggerString:"Reset"}),(0,l.jsx)(eO,{modal_id:"reset-configs",title:"Reset Config",text:"Are you sure you want to reset the config?",triggerAccept:p,triggerString:"Reset"}),(0,l.jsx)(eO,{modal_id:"reset-verba",title:"Reset Verba",text:"Are you sure you want to reset Verba? This will delete all collections related to Verba.",triggerAccept:g,triggerString:"Reset"}),(0,l.jsx)(eO,{modal_id:"reset-suggestions",title:"Reset Suggestions",text:"Are you sure you want to reset all autocomplete suggestions?",triggerAccept:h,triggerString:"Reset"})]})},eZ=s(936),e0=s(5909),e2=e=>{let{credentials:t,addStatusMessage:s}=e,[a,r]=(0,n.useState)(1),[i,c]=(0,n.useState)([]),[o,d]=(0,n.useState)(0),x=async()=>{let e=await H(a,20,t);e&&(c(e.suggestions),d(e.total_count))};(0,n.useEffect)(()=>{x()},[x]),(0,n.useEffect)(()=>{x()},[x,a]);let u=e=>{let t=document.getElementById(e);t instanceof HTMLDialogElement&&t.showModal()},g=e=>{try{let t=(0,eZ.D)(e);return(0,e0.Q)(t,{addSuffix:!0})}catch(e){return console.error("Error parsing timestamp:",e),"Invalid date"}},p=async e=>{await V(e,t),await x(),s("Suggestion deleted","SUCCESS")},h=e=>{navigator.clipboard.writeText(e).then(()=>{})};return(0,l.jsxs)("div",{className:"flex flex-col w-full h-full p-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsxs)("p",{className:"text-2xl font-bold",children:["Manage Suggestions (",o,")"]}),(0,l.jsx)(b,{title:"Refresh",className:"max-w-min",onClick:()=>{x()},Icon:f.A$d})]}),(0,l.jsx)("div",{className:"flex-grow overflow-y-auto",children:(0,l.jsx)("div",{className:"gap-4 flex flex-col p-4 text-text-verba",children:(0,l.jsx)("div",{className:"flex flex-col gap-2",children:i.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2 p-4 border-2 bg-bg-alt-verba rounded-xl",children:[(0,l.jsxs)("div",{className:"flex flex-col items-start justify-start gap-2 w-2/3",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:g(e.timestamp)}),(0,l.jsx)("p",{className:"text-sm text-text-verba truncate max-w-full",title:e.query,children:e.query})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(b,{onClick:()=>h(e.query),Icon:f.On2}),(0,l.jsx)(b,{onClick:()=>u("remove_suggestion".concat(e.uuid)),Icon:f.VOs})]}),(0,l.jsx)(eO,{modal_id:"remove_suggestion".concat(e.uuid),title:"Remove Suggestion",text:"Do you want to remove this suggestion?",triggerString:"Delete",triggerValue:e.uuid,triggerAccept:p})]},"Suggestion".concat(e.uuid)))})})}),i.length>0&&(0,l.jsxs)("div",{className:"flex justify-center items-center gap-2 p-3 bg-bg-alt-verba",children:[(0,l.jsx)(b,{title:"Previous Page",onClick:()=>{1===a?r(1):r(e=>e-1)},className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",Icon:m.O18}),(0,l.jsxs)("p",{className:"text-xs flex text-text-verba",children:["Page ",a]}),(0,l.jsx)(b,{title:"Next Page",onClick:()=>{20*a<=o?r(e=>e+1):r(1)},className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",Icon:m.Rdr})]})]})},e1=e=>{let{selectedTheme:t,themes:s,setThemes:a,addStatusMessage:r,setSelectedTheme:i,credentials:c}=e,[o,d]=(0,n.useState)("INFO");return(0,l.jsxs)("div",{className:"flex flex-col md:flex-row justify-center gap-3 h-[80vh]",children:[(0,l.jsx)("div",{className:"w-full md:w-1/3 flex",children:(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,l.jsx)("div",{className:"bg-bg-alt-verba rounded-2xl flex gap-2 p-6 items-center justify-between h-min w-full",children:(0,l.jsx)("div",{className:"flex gap-2 justify-start ",children:(0,l.jsx)(ei,{tooltip_text:"Customize Verba's Theme, reset collections, logout or report issues.",display_text:"Settings"})})}),(0,l.jsxs)("div",{className:"bg-bg-alt-verba gap-2 rounded-2xl flex flex-col p-6 w-full overflow-y-auto overflow-x-hidden",children:[(0,l.jsx)(b,{title:"Admin",onClick:()=>d("INFO"),selected:"INFO"===o,selected_color:"bg-secondary-verba",Icon:em.Xn2}),(0,l.jsx)(b,{title:"Customize Theme",onClick:()=>d("THEME"),selected:"THEME"===o,selected_color:"bg-secondary-verba",Icon:m._TT}),(0,l.jsx)(b,{title:"Manage Suggestions",onClick:()=>d("SUGGESTIONS"),selected:"SUGGESTIONS"===o,selected_color:"bg-secondary-verba",Icon:f.aTL})]}),(0,l.jsxs)("div",{className:"bg-bg-alt-verba gap-2 rounded-2xl flex flex-col p-6 w-full overflow-y-auto overflow-x-hidden",children:[(0,l.jsx)(b,{title:"Logout",onClick:()=>window.location.reload(),Icon:f.p$f}),(0,l.jsx)(b,{title:"Report Issue",onClick:()=>window.open("https://github.com/weaviate/Verba/issues/new/choose","_blank"),Icon:u.N3m})]})]})}),(0,l.jsx)("div",{className:"w-full md:w-2/3 flex",children:(0,l.jsx)("div",{className:"flex flex-col gap-2 w-full",children:(0,l.jsxs)("div",{className:"bg-bg-alt-verba gap-2 rounded-2xl flex flex-col p-6 h-full w-full overflow-y-auto overflow-x-hidden",children:["THEME"===o&&(0,l.jsx)(e$,{themes:s,credentials:c,setThemes:a,setSelectedTheme:i,selectedTheme:t,addStatusMessage:r}),"INFO"===o&&(0,l.jsx)(eX,{addStatusMessage:r,credentials:c}),"SUGGESTIONS"===o&&(0,l.jsx)(e2,{credentials:c,addStatusMessage:r})]})})})]})},e3=s(257);function e5(){let[e,t]=(0,n.useState)("CHAT"),[s,r]=(0,n.useState)("Production"),[i,u]=(0,n.useState)(""),[m,g]=(0,n.useState)({Light:c,Dark:o,Weaviate:d,WCD:x}),[f,p]=(0,n.useState)(m.WCD),[h,b]=(0,n.useState)(!1),[v,j]=(0,n.useState)(!1),[N,w]=(0,n.useState)(!1),[y,S]=(0,n.useState)({deployment:"Weaviate",url:e3.env.WEAVIATE_URL_VERBA||"",key:e3.env.WEAVIATE_API_KEY_VERBA||""}),[C,k]=(0,n.useState)(null),[_,R]=(0,n.useState)([]),[D,O]=(0,n.useState)([]),[T,A]=(0,n.useState)([]),[M,F]=(0,n.useState)([]),z=(e,t)=>{let s={message:e,timestamp:new Date().toISOString(),type:t};O(e=>[...e,s])},P=(0,n.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;for(let s=0;s<e;s++){try{let[e]=await Promise.all([E()]);if(e){r(e.production),u(e.gtag),b(!0),S({deployment:"Weaviate",url:e.deployments.WEAVIATE_URL_VERBA,key:e.deployments.WEAVIATE_API_KEY_VERBA});return}console.warn("Could not retrieve health data")}catch(e){console.error("Error during initial fetch:",e)}await new Promise(e=>setTimeout(e,t))}b(!1),j(!1)},[]);(0,n.useEffect)(()=>{let e=async()=>{await E()?b(!0):h&&(b(!1),j(!1))};P();let t=setInterval(e,12e4);return()=>clearInterval(t)},[P,h]),(0,n.useEffect)(()=>{if(v){let e=setTimeout(()=>{w(!0)},1e3);return()=>clearTimeout(e)}},[v]);let L=async()=>{let e=await I(y.deployment,y.url,y.key);e&&(e.error?(j(!1),console.error(e.error)):(j(!0),k(e.rag_config),e.themes&&g(e.themes),e.theme&&p(e.theme)))};(0,n.useEffect)(()=>{h&&L()},[L,h]);let U=(0,n.useCallback)(()=>{Object.entries({"--primary-verba":f.primary_color.color,"--secondary-verba":f.secondary_color.color,"--warning-verba":f.warning_color.color,"--bg-verba":f.bg_color.color,"--bg-alt-verba":f.bg_alt_color.color,"--text-verba":f.text_color.color,"--text-alt-verba":f.text_alt_color.color,"--button-verba":f.button_color.color,"--button-hover-verba":f.button_hover_color.color,"--text-verba-button":f.button_text_color.color,"--text-alt-verba-button":f.button_text_alt_color.color}).forEach(e=>{let[t,s]=e;document.documentElement.style.setProperty(t,s)})},[f]);return(0,n.useEffect)(()=>{U()},[U]),(0,l.jsxs)("main",{className:"min-h-screen bg-bg-verba text-text-verba ".concat("default-font-class"),"data-theme":f.theme,children:[""!==i&&(0,l.jsx)(a.GoogleAnalytics,{gaId:i}),(0,l.jsx)(eK,{status_messages:D,set_status_messages:O}),v&&h&&(0,l.jsxs)("div",{className:"transition-opacity duration-1000 ".concat(N?"opacity-100":"opacity-0"," flex flex-col gap-2 p-5 md:p-10"),children:[(0,l.jsx)(eq,{production:s,title:f.title.text,subtitle:f.subtitle.text,imageSrc:f.image.src,version:"v2.0.0",currentPage:e,setCurrentPage:t}),"CHAT"===e&&(0,l.jsx)(eD,{addStatusMessage:z,credentials:y,ragConfig:C,setRagConfig:k,production:s,selectedTheme:f,currentPage:e,documentFilter:_,setDocumentFilter:R,labels:T,filterLabels:M,setFilterLabels:F}),"SETTINGS"===e&&(0,l.jsx)(e1,{selectedTheme:f,setSelectedTheme:p,themes:m,setThemes:g,credentials:y,addStatusMessage:z}),"IMPORT_DATA"===e&&(0,l.jsx)(eJ,{credentials:y,RAGConfig:C,setRAGConfig:k,addStatusMessage:z}),"DOCUMENTS"===e&&(0,l.jsx)(eA,{selectedTheme:f,production:s,credentials:y,documentFilter:_,setDocumentFilter:R,addStatusMessage:z})]})]})}}},function(e){e.O(0,[535,689,870,520,370,465,929,582,190,400,61,682,306,420,636,115,977,971,117,744],function(){return e(e.s=8170)}),_N_E=e.O()}]);