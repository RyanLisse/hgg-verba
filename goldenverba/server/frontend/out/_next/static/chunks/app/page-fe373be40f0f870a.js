(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{47332:function(e,t,s){Promise.resolve().then(s.bind(s,87511))},87511:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eU}});var l=s(57437),a=s(2265),n=s(9881),r=s(58177),o=s(8603),c=s(95183),i=s(50670),d=s.n(i),x=s(72810),u=s.n(x),m=s(5117),g=s.n(m),f=s(58146),b=s.n(f);d(),u(),g(),b();let h=()=>{let e="https:"===window.location.protocol?"wss:":"ws:",t=window.location.host;return"".concat(e,"//").concat(t,"/ws/generate_stream")},p=e=>{let t=e||document.activeElement;t&&t instanceof HTMLElement&&t.blur()};function v(e,t){let s=new Date().toISOString();console.log("[".concat(s,"] ").concat(e),t)}var j=e=>{let{title:t="",key:s="Button"+t,Icon:a,onClick:n=()=>{},onMouseEnter:r=()=>{},onMouseLeave:o=()=>{},disabled:c=!1,className:i="",text_class_name:d="",selected:x=!1,selected_color:u="bg-button-verba",selected_text_color:m="text-text-verba-button",text_size:g="text-sm",icon_size:f=15,type:b="button",loading:h=!1,circle:p=!1,button_size:v="",onClickParams:j=[]}=e;return(0,l.jsx)("button",{type:b,className:i+" btn rounded-lg flex-grow items-center justify-center border-none ".concat(p?"btn-circle":""," ").concat(v," hover:bg-button-hover-verba hover:text-text-verba-button ").concat(x?u+" shadow-md "+m:" bg-button-verba shadow-none text-text-alt-verba-button"," "),onClick:e=>n(e,...j),disabled:c,onMouseEnter:r,onMouseLeave:o,children:h?(0,l.jsx)("span",{className:"text-text-verba-button loading loading-spinner loading-sm"}):(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[a&&(0,l.jsx)(a,{size:f,className:"w-[20px]"}),t&&(0,l.jsx)("p",{title:t,className:g+" "+d,children:t})]})})},s)},y=e=>{let{Icon:t,title:s,currentPage:a,setPage:n,setCurrentPage:r,hide:o}=e;return(0,l.jsx)(j,{title:s,Icon:t,selected_color:"bg-primary-verba",selected:a===n,onClick:()=>{r(n)},disabled:o})},w=e=>{let{imageSrc:t,title:s,subtitle:a,currentPage:n,setCurrentPage:i,production:d}=e;return(0,l.jsxs)("div",{className:"flex justify-between items-center mb-10",children:[(0,l.jsxs)("div",{className:"flex flex-row items-center gap-5",children:[(0,l.jsx)("img",{src:t,className:"flex rounded-lg w-[50px] md:w-[80px] md:h-[80px] object-contain"}),(0,l.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-end justify-center lg:gap-3",children:[(0,l.jsx)("p",{className:"text-2xl md:text-3xl text-text-verba",children:s}),(0,l.jsx)("p",{className:"text-sm md:text-base text-text-alt-verba font-light",children:a})]}),(0,l.jsx)("div",{className:"flex md:hidden flex-col items-center gap-3 justify-between",children:(0,l.jsxs)("div",{className:"dropdown dropdown-hover",children:[(0,l.jsx)(j,{Icon:c.QQh,title:"Menu"}),(0,l.jsxs)("ul",{tabIndex:0,className:"dropdown-content dropdown-left z-[1] menu p-2 shadow bg-base-100 rounded-box w-52",children:[(0,l.jsx)("li",{children:(0,l.jsx)("a",{className:"CHAT"===n?"font-bold":"",onClick:()=>{i("CHAT"),p()},children:"Chat"})},"Menu Button1"),(0,l.jsx)("li",{children:(0,l.jsx)("a",{className:"DOCUMENTS"===n?"font-bold":"",onClick:()=>{i("DOCUMENTS"),p()},children:"Documents"})},"Menu Button2"),"Demo"!=d&&(0,l.jsx)("li",{children:(0,l.jsx)("a",{className:"ADD"===n?"font-bold":"",onClick:()=>{i("ADD"),p()},children:"Import Data"})},"Menu Button4"),"Demo"!=d&&(0,l.jsx)("li",{children:(0,l.jsx)("a",{className:"SETTINGS"===n?"font-bold":"",onClick:()=>{i("SETTINGS"),p()},children:"Settings"})},"Menu Button5")]})]})})]}),(0,l.jsx)("div",{className:"flex flex-row justify-center items-center",children:(0,l.jsxs)("div",{className:"hidden md:flex flex-row items-center gap-3 justify-between",children:[(0,l.jsx)(y,{hide:!1,Icon:r.utr,title:"Chat",currentPage:n,setCurrentPage:i,setPage:"CHAT"}),"Demo"!=d&&(0,l.jsx)(y,{hide:!1,Icon:o.Lgw,title:"Import Data",currentPage:n,setCurrentPage:i,setPage:"ADD"}),(0,l.jsx)(y,{hide:!1,Icon:r.emU,title:"Documents",currentPage:n,setCurrentPage:i,setPage:"DOCUMENTS"}),"Demo"!=d&&(0,l.jsx)(y,{hide:!1,Icon:r.zfW,title:"Settings",currentPage:n,setCurrentPage:i,setPage:"SETTINGS"}),(0,l.jsx)("div",{className:"sm:h-[3vh] lg:h-[5vh] mx-1 hidden md:block bg-text-alt-verba w-px"})]})})]})},N=s(65125),_=s(25847),S=s(14063),C=s(93850),k=s(86512),E=s(41548),I=s(69653),T=s(82146);function O(e){let{runId:t,onSubmit:s}=e,[n,r]=(0,a.useState)(!1),[o,c]=(0,a.useState)(null),[i,d]=(0,a.useState)(""),x=e=>{"positive"===e?(s(t,e,""),r(!1)):c("negative")};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j,{title:"Feedback",Icon:k.Z,onClick:()=>r(!0),selected:!1,disabled:!t}),n&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-lg p-6 w-96 relative",children:[(0,l.jsx)(j,{Icon:E.Z,onClick:()=>r(!1),className:"absolute right-2 top-2",selected:!1,disabled:!1}),(0,l.jsx)("h2",{className:"text-xl font-bold mb-4",children:null===o?"Was this helpful?":"What could we improve?"}),null===o?(0,l.jsxs)("div",{className:"flex justify-center space-x-4 mt-4",children:[(0,l.jsx)(j,{title:"Yes",Icon:I.Z,onClick:()=>x("positive"),selected:!1,disabled:!1,selected_color:"bg-success-verba"}),(0,l.jsx)(j,{title:"No",Icon:T.Z,onClick:()=>x("negative"),selected:!1,disabled:!1,selected_color:"bg-error-verba"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("textarea",{placeholder:"Please provide your feedback...",value:i,onChange:e=>d(e.target.value),className:"w-full p-2 rounded bg-bg-verba text-text-verba mt-4"}),(0,l.jsx)(j,{title:"Submit Feedback",onClick:()=>{o&&s(t,o,i),r(!1)},className:"w-full mt-4",selected:!1,disabled:!1,selected_color:"bg-primary-verba"})]})]})})]})}let R=async e=>{try{return(await fetch(e)).ok}catch(t){return console.error("Failed to fetch from ".concat(e,":"),t),!1}},A=async()=>{if(await R("http://localhost:8000/api/health"))return"http://localhost:8000";if(await R("/api/health"))return window.location.origin;throw Error("Both health checks failed, please check the Verba Server")},D=async e=>{try{let t=await A(),s=await fetch("".concat(t).concat(e),{method:"GET"}),l=await s.json();return l||console.warn("Could not retrieve data from ".concat(e)),l}catch(t){return console.error("Failed to fetch data from ".concat(e,":"),t),null}},F=()=>D("/api/health"),P=async(e,t,s)=>{let l=await A(),a=await fetch("".concat(l,"/api/connect"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credentials:{deployment:e,url:t,key:s}})});return await a.json()},z=async e=>{try{let t=await A(),s=await fetch("".concat(t,"/api/get_rag_config"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await s.json()}catch(e){return console.error("Error retrieving content",e),null}},M=async(e,t)=>{if(!e)return!1;try{let s=await A(),l=await fetch("".concat(s,"/api/set_rag_config"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rag_config:e,credentials:t})});return 200===l.status}catch(e){return console.error("Error setting config:",e),!1}},V=async(e,t,s)=>{try{let l=await A(),a=await fetch("".concat(l,"/api/set_theme_config"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({themes:e,theme:t,credentials:s})});return 200===a.status}catch(e){return console.error("Error setting config:",e),!1}},G=async(e,t,s,l,a)=>{try{let n=await A(),r=await fetch("".concat(n,"/api/query"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,RAG:t,labels:s,documentFilter:l,credentials:a})});return await r.json()}catch(e){return console.error("Error sending query",e),null}},W=async(e,t)=>{if(!e)return null;try{let s=await A(),l=await fetch("".concat(s,"/api/get_document"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:e,credentials:t})});return await l.json()}catch(e){return console.error("Error retrieving selected document",e),null}},L=async(e,t,s)=>{try{let l=await A(),a=await fetch("".concat(l,"/api/get_datacount"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embedding_model:e,documentFilter:t,credentials:s})});return await a.json()}catch(e){return console.error("Error retrieving content",e),null}},U=async e=>{try{let t=await A(),s=await fetch("".concat(t,"/api/get_labels"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await s.json()}catch(e){return console.error("Error retrieving content",e),null}},B=async(e,t,s,l)=>{if(!e)return null;try{let a=await A(),n=await fetch("".concat(a,"/api/get_content"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:e,page:t,chunkScores:s,credentials:l})});return await n.json()}catch(e){return console.error("Error retrieving content",e),null}},q=async(e,t,s)=>{if(!e)return null;try{let l=await A(),a=await fetch("".concat(l,"/api/get_vectors"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:e,showAll:t,credentials:s})});return await a.json()}catch(e){return console.error("Error retrieving content",e),null}},J=async(e,t,s,l)=>{if(!e)return null;try{let a=await A(),n=await fetch("".concat(a,"/api/get_chunks"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:e,page:t,pageSize:s,credentials:l})});return await n.json()}catch(e){return console.error("Error retrieving content",e),null}},H=async(e,t,s)=>{if(!e)return null;try{let l=await A(),a=await fetch("".concat(l,"/api/get_chunk"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:e,embedder:t,credentials:s})});return await a.json()}catch(e){return console.error("Error retrieving content",e),null}},Z=async(e,t)=>{try{let s=await A(),l=await fetch("".concat(s,"/api/reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetMode:e,credentials:t})});return 200===l.status}catch(e){return console.error("Error deleting all documents",e),!1}},K=async e=>{try{let t=await A(),s=await fetch("".concat(t,"/api/get_meta"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await s.json()}catch(e){return console.error("Error retrieving selected document",e),null}},$=async(e,t,s)=>{try{let l=await A(),a=await fetch("".concat(l,"/api/get_suggestions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,limit:t,credentials:s})});return await a.json()}catch(e){return console.error("Error retrieving suggestions",e),null}},Y=async(e,t)=>{try{let s=await A(),l=await fetch("".concat(s,"/api/delete_suggestion"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:e,credentials:t})});return 200===l.status}catch(e){return console.error("Error deleting suggestion",e),!1}},X=async(e,t,s)=>{try{let l=await A(),a=await fetch("".concat(l,"/api/get_all_suggestions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({page:e,pageSize:t,credentials:s})});return await a.json()}catch(e){return console.error("Error retrieving all suggestions",e),null}};var Q=e=>{let{tooltip_text:t,display_text:s}=e,[n,r]=(0,a.useState)(!1);return(0,l.jsxs)("div",{className:"items-center gap-2 flex",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(j,{title:"",Icon:S.LL$,icon_size:10,disabled:!1,selected:!1,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),circle:!0,button_size:"btn-xs"}),(0,l.jsx)("div",{className:"absolute left-full z-30 p-4 bg-bg-verba text-text-alt-verba text-xs rounded-xl shadow-md w-[300px] transition-opacity duration-300 ".concat(n?"opacity-100":"opacity-0 pointer-events-none"),children:(0,l.jsx)("p",{className:"w-full whitespace-normal",children:t})})]}),(0,l.jsx)("p",{className:"text-sm text-text-alt-verba truncate max-w-[350px]",title:s,children:s})]})},ee=s(71375);let et=e=>{let{values:t,config_title:s,updateConfig:n,component_name:o,blocked:c}=e,[i,d]=(0,a.useState)(""),[x,u]=(0,a.useState)(t);(0,a.useEffect)(()=>{n(o,s,x)},[x]);let m=e=>{x.includes(e)||(u(t=>[...t,e]),d(""))},g=e=>{x.includes(e)&&u(t=>t.filter(t=>t!==e))};return(0,l.jsxs)("div",{className:"flex flex-col w-full gap-2",children:[(0,l.jsxs)("div",{className:"flex gap-2 justify-between",children:[(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow w-full",disabled:c,value:i,onChange:e=>{d(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),m(i))}})}),(0,l.jsxs)("button",{onClick:()=>{m(i)},disabled:c,className:"btn flex gap-2 bg-button-verba border-none hover:bg-secondary-verba text-text-verba",children:[(0,l.jsx)(r.Kth,{size:15}),(0,l.jsx)("p",{children:"Add"})]})]}),(0,l.jsx)("div",{className:"grid grid-cols-3 gap-2",children:t.map((e,t)=>(0,l.jsxs)("div",{className:"flex bg-bg-verba w-full p-2 text-center text-sm text-text-verba justify-between items-center rounded-xl",children:[(0,l.jsx)("div",{className:"flex w-full justify-center items-center overflow-hidden",children:(0,l.jsx)("p",{className:"truncate",title:e,children:e})}),(0,l.jsx)("button",{disabled:c,onClick:()=>{g(e)},className:"btn btn-sm btn-square bg-button-verba border-none hover:bg-warning-verba text-text-verba ml-2",children:(0,l.jsx)(S.Xm5,{size:12})})]},e+t))})]})};var es=e=>{let{RAGConfig:t,component_name:s,selectComponent:a,updateConfig:n,saveComponentConfig:r,blocked:o,skip_component:c}=e;return 0==Object.entries(t[s].components[t[s].selected].config).length&&c?(0,l.jsx)(l.Fragment,{}):(0,l.jsxs)("div",{className:"flex flex-col justify-start gap-3 rounded-2xl p-1 w-full ",children:[(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{className:"divider text-text-alt-verba flex-grow text-xs lg:text-sm",children:[(0,l.jsxs)("p",{children:[t[s].selected," Settings"]}),(0,l.jsx)(j,{title:"Save",className:"btn-sm lg:text-sm text-xs",text_size:"",onClick:()=>{r(s,t[s].selected,t[s].components[t[s].selected])}})]})}),!c&&(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:"flex gap-2 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw] lg:text-base text-sm",children:s}),(0,l.jsxs)("div",{className:"dropdown dropdown-bottom flex justify-start items-center w-full",children:[(0,l.jsxs)("button",{tabIndex:0,role:"button",disabled:o,className:"btn bg-button-verba hover:bg-button-hover-verba text-text-verba w-full flex justify-start border-none",children:[(0,l.jsx)(ee.WMq,{size:15}),(0,l.jsx)("p",{children:t[s].selected})]}),(0,l.jsx)("ul",{tabIndex:0,className:"dropdown-content menu bg-base-100 rounded-box z-[1] w-full p-2 shadow",children:Object.entries(t[s].components).filter(e=>{let[t,s]=e;return s.available}).map(e=>{let[t,n]=e;return(0,l.jsx)("li",{onClick:()=>{o||(a(s,n.name),p())},children:(0,l.jsx)("a",{children:n.name})},"ComponentDropdown_"+n.name)})})]})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]"}),(0,l.jsx)("p",{className:"lg:text-sm text-xs text-text-alt-verba text-start",children:t[s].components[t[s].selected].description})]})]}),Object.entries(t[s].components[t[s].selected].config).map(e=>{let[a,r]=e;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex gap-3 justify-between items-center text-text-verba lg:text-base text-sm",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:a}),"dropdown"===r.type&&(0,l.jsxs)("div",{className:"dropdown dropdown-bottom flex justify-start items-center w-full",children:[(0,l.jsxs)("button",{tabIndex:0,role:"button",disabled:o,className:"btn bg-button-verba hover:bg-button-hover-verba text-text-verba w-full flex justify-start border-none",children:[(0,l.jsx)(ee.WMq,{size:15}),(0,l.jsx)("p",{children:r.value})]}),(0,l.jsx)("ul",{tabIndex:0,className:"dropdown-content menu bg-base-100 max-h-[20vh] overflow-auto rounded-box z-[1] w-full p-2 shadow",children:t[s].components[t[s].selected].config[a].values.map(e=>(0,l.jsx)("li",{className:"lg:text-base text-sm",onClick:()=>{o||(n(s,a,e),p())},children:(0,l.jsx)("a",{children:e})},"ConfigValue"+e))})]}),"boolean"!=typeof r.value&&["text","number","password"].includes(r.type)&&(0,l.jsx)("label",{className:"input flex text-sm items-center gap-2 w-full bg-bg-verba",children:(0,l.jsx)("input",{type:r.type,className:"grow w-full",value:r.value,onChange:e=>{o||n(s,a,e.target.value)}})}),"boolean"!=typeof r.value&&"multi"==r.type&&(0,l.jsx)(et,{component_name:s,values:r.values,config_title:a,updateConfig:n,blocked:o}),"bool"==r.type&&(0,l.jsxs)("div",{className:"flex gap-5 justify-start items-center w-full my-4",children:[(0,l.jsx)("p",{className:"lg:text-sm text-xs text-text-alt-verba text-start w-[250px]",children:r.description}),(0,l.jsx)("input",{type:"checkbox",className:"checkbox checkbox-md",onChange:e=>{o||n(s,a,e.target.checked)},checked:"boolean"==typeof r.value&&r.value})]})]}),"bool"!=r.type&&(0,l.jsxs)("div",{className:"flex gap-2 items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]"}),(0,l.jsx)("p",{className:"lg:text-sm text-xs text-text-alt-verba text-start",children:r.description})]})]},"Configuration"+a+s)})]})},el=e=>{let{RAGConfig:t,setRAGConfig:s,addStatusMessage:n,onSave:o,credentials:c,onReset:i,production:d}=e,x=(e,t,l)=>{s(s=>{if(s){let a={...s};return"string"==typeof l||"boolean"==typeof l?a[e].components[a[e].selected].config[t].value=l:a[e].components[a[e].selected].config[t].values=l,a}return s})},u=(e,t)=>{s(s=>{if(s){let l={...s};return l[e].selected=t,l}return s})},m=(0,a.useCallback)(async(e,l,a)=>{if(!t)return;n("Saving "+l+" Config","SUCCESS");let r=JSON.parse(JSON.stringify(t));r[e].selected=l,r[e].components[l]=a,await M(r,c)&&s(r)},[t,c]);return t?(0,l.jsxs)("div",{className:"flex flex-col justify-start rounded-2xl w-full p-4 ",children:[(0,l.jsx)("div",{className:"sticky flex flex-col gap-2 w-full top-0 z-20 justify-end",children:(0,l.jsxs)("div",{className:"flex justify-end w-full gap-2 p-4 bg-bg-alt-verba rounded-lg",children:[(0,l.jsx)(j,{Icon:r.zfW,title:"Save Config",onClick:o,className:"max-w-[150px]",disabled:"Demo"==d}),(0,l.jsx)(j,{Icon:N.B4e,title:"Reset",onClick:i,className:"max-w-[150px]",disabled:"Demo"==d})]})}),(0,l.jsxs)("div",{className:"flex flex-col justify-start gap-3 rounded-2xl w-full p-6 ",children:[(0,l.jsx)(es,{RAGConfig:t,component_name:"Embedder",selectComponent:u,updateConfig:x,saveComponentConfig:m,blocked:"Demo"==d}),(0,l.jsx)(es,{RAGConfig:t,component_name:"Generator",selectComponent:u,updateConfig:x,saveComponentConfig:m,blocked:"Demo"==d}),(0,l.jsx)(es,{RAGConfig:t,component_name:"Retriever",selectComponent:u,updateConfig:x,saveComponentConfig:m,blocked:"Demo"==d})]})]}):(0,l.jsx)("div",{})},ea=s(13921),en=s(7395),er=s(38666),eo=e=>{let{message:t,selectedTheme:s,selectedDocument:a,setSelectedDocument:n,message_index:o,setSelectedDocumentScore:c,setSelectedChunkScore:i}=e;return"string"==typeof t.content?(0,l.jsx)("div",{className:"flex items-end gap-2 ".concat("user"===t.type?"justify-end":"justify-start"),children:(0,l.jsxs)("div",{className:"flex flex-col items-start p-5 rounded-3xl animate-press-in text-sm lg:text-base ".concat({user:"bg-bg-verba",system:"bg-bg-alt-verba",error:"bg-warning-verba",retrieval:"bg-bg-verba"}[t.type]),children:[t.cached&&(0,l.jsx)(S.i1q,{size:12,className:"text-text-verba"}),"system"===t.type&&(0,l.jsx)(ea.D,{className:"prose md:prose-sm lg:prose-base p-3 prose-pre:bg-bg-alt-verba",components:{code(e){let{node:t,inline:a,className:n,children:r,...o}=e,c=/language-(\w+)/.exec(n||"");return!a&&c?(0,l.jsx)(en.Z,{style:"dark"===s.theme?er.vk:er.Yn,language:c[1],PreTag:"div",...o,children:String(r).replace(/\n$/,"")}):(0,l.jsx)("code",{className:n,...o,children:r})}},children:t.content}),"user"===t.type&&(0,l.jsx)("div",{className:"whitespace-pre-wrap",children:t.content}),"error"===t.type&&(0,l.jsxs)("div",{className:"whitespace-pre-wrap flex items-center gap-2 text-sm text-text-verba",children:[(0,l.jsx)(C.I2T,{size:15}),(0,l.jsx)("p",{children:t.content})]})]})}):(0,l.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-3 w-full items-center",children:[t.content.map((e,t)=>(0,l.jsx)("button",{onClick:()=>{n(e.uuid),c(e.uuid+e.score+e.chunks.length),i(e.chunks)},className:"flex ".concat(a&&a===e.uuid+e.score+e.chunks.length?"bg-secondary-verba hover:bg-button-hover-verba":"bg-button-verba hover:bg-secondary-verba"," rounded-3xl p-3 items-center justify-between transition-colors duration-300 ease-in-out border-none"),children:(0,l.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,l.jsx)("p",{className:"text-xs flex-grow truncate mr-2",title:e.title,children:e.title}),(0,l.jsxs)("div",{className:"flex gap-1 items-center text-text-verba flex-shrink-0",children:[(0,l.jsx)(r.$Kz,{size:12}),(0,l.jsx)("p",{className:"text-sm",children:e.chunks.length})]})]})},"Retrieval"+e.title+t)),(0,l.jsx)(j,{Icon:r.s59,className:"btn-sm btn-square",onClick:()=>document.getElementById("context-modal-"+o).showModal()}),(0,l.jsx)("dialog",{id:"context-modal-"+o,className:"modal",children:(0,l.jsxs)("div",{className:"modal-box",children:[(0,l.jsx)("h3",{className:"font-bold text-lg",children:"Context"}),(0,l.jsx)("p",{className:"py-4",children:t.context}),(0,l.jsx)("div",{className:"modal-action",children:(0,l.jsx)("form",{method:"dialog",children:(0,l.jsx)("button",{className:"btn focus:outline-none text-text-alt-verba bg-button-verba hover:bg-button-hover-verba hover:text-text-verba border-none shadow-none",children:(0,l.jsx)("p",{children:"Close"})})})})]})})]})},ec=e=>{let{production:t,credentials:s,setSelectedDocument:n,setSelectedChunkScore:c,currentPage:i,RAGConfig:d,selectedTheme:x,setRAGConfig:u,addStatusMessage:m,documentFilter:g,setDocumentFilter:f}=e,[b,p]=(0,a.useState)("Chat"),y=(0,a.useRef)(!1),[w,k]=(0,a.useState)("DONE"),[E,I]=(0,a.useState)("");(0,a.useRef)(null);let[T,R]=(0,a.useState)(null),[A,D]=(0,a.useState)("OFFLINE"),[F,P]=(0,a.useState)([]),[V,W]=(0,a.useState)([]),[B,q]=(0,a.useState)([]),[J,H]=(0,a.useState)(null),[Z,K]=(0,a.useState)(0),[Y,X]=(0,a.useState)(""),[ee,et]=(0,a.useState)([]),es=d?d.Embedder.components[d.Embedder.selected].config.Model.value:"No Config found";(0,a.useState)("No Embedding Model"),(0,a.useEffect)(()=>{let e=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=h(),l=new WebSocket(s);l.onopen=()=>{console.log("WebSocket connection opened to "+s),D("ONLINE")},l.onmessage=e=>{let t;if(!y.current){I("");return}try{t=JSON.parse(e.data)}catch(t){console.error("Received data is not valid JSON:",e.data);return}let s=t.message;if(I(e=>e+s),"stop"===t.finish_reason){y.current=!1,k("DONE"),m("Finished generation","SUCCESS");let e=t.full_text;if(t.cached){let s=t.distance;et(l=>[...l,{type:"system",content:e||"",cached:!0,distance:s,runId:t.runId}])}else et(s=>[...s,{type:"system",content:e||"",runId:t.runId}]);I("")}},l.onerror=e=>{console.error("WebSocket Error:",e),D("OFFLINE")},l.onclose=s=>{D("OFFLINE"),s.wasClean?console.log("WebSocket closed cleanly, code=".concat(s.code,", reason=").concat(s.reason)):console.error("WebSocket connection died"),t<5&&(console.log("Retrying WebSocket connection... Attempt ".concat(t+1)),setTimeout(()=>e(t+1),2e3))},R(l)};return e(),()=>{T&&T.readyState!==WebSocket.CLOSED&&T.close()}},[]),(0,a.useEffect)(()=>{d?ed():K(0)},[d]);let ea=async()=>{let e=await z(s);e?u(e.rag_config):m("Failed to fetch RAG Config","ERROR")},en=async()=>{if(!y.current&&Y.trim()){X(""),y.current=!0,P([]),k("CHUNKS"),et(e=>[...e,{type:"user",content:Y}]);try{m("Sending query...","INFO");let e=await G(Y,d,B,g,s);!e||e.error?er(e?e.error:"No data received"):ec(e,Y)}catch(e){er("Failed to fetch from API"),console.error("Failed to fetch from API:",e)}}},er=e=>{m("Query failed","ERROR"),et(t=>[...t,{type:"error",content:e}]),y.current=!1,k("DONE")},ec=(e,t)=>{if(et(t=>[...t,{type:"retrieval",content:e.documents,context:e.context}]),m("Received "+Object.entries(e.documents).length+" documents","SUCCESS"),e.documents.length>0){let s=e.documents[0];n(s.uuid),H("".concat(s.uuid).concat(s.score).concat(s.chunks.length)),c(s.chunks),e.context&&(ei(t,e.context),k("RESPONSE"))}else er("We couldn't find any chunks to your query")},ei=(e,t)=>{if((null==T?void 0:T.readyState)===WebSocket.OPEN){let s=JSON.stringify({query:e,context:t,conversation:ee.slice(1).filter(e=>"user"===e.type||"system"===e.type).map(e=>({type:e.type,content:e.content})),rag_config:d});T.send(s)}else console.error("WebSocket is not open. ReadyState:",null==T?void 0:T.readyState)},ed=async()=>{try{let e=await L(es,g,s),t=await U(s);e&&K(e.datacount),t&&W(t.labels)}catch(e){console.error("Failed to fetch from API:",e),m("Failed to fetch datacount: "+e,"ERROR")}},ex=async()=>{m("Saved Config","SUCCESS"),await M(d,s)},eu=async()=>{m("Reset Config","WARNING"),ea()},em=async()=>{if(d&&d.Retriever.components[d.Retriever.selected].config.Suggestion.value){let e=await $(Y,3,s);e&&P(e.suggestions)}},eg=async(e,t,l)=>{v("Feedback submission triggered",{runId:e,feedbackType:t,additionalFeedback:l});try{let a=await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({runId:e,feedbackType:t,additionalFeedback:l,credentials:s})});a.ok?(v("Feedback submitted successfully",{runId:e}),m("Feedback submitted successfully","SUCCESS")):(v("Failed to submit feedback",{runId:e,status:a.status}),m("Failed to submit feedback","ERROR"))}catch(t){v("Error submitting feedback",{runId:e,error:t}),console.error("Error submitting feedback:",t),m("Error submitting feedback","ERROR")}};return(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex flex-col md:flex-row gap-2 p-4 md:p-6 items-center justify-between h-min w-full",children:[(0,l.jsx)("div",{className:"hidden md:flex gap-2 justify-start items-center",children:(0,l.jsx)(Q,{tooltip_text:"Use the Chat interface to interact with your data and perform Retrieval Augmented Generation (RAG). This interface allows you to ask questions, analyze sources, and generate responses based on your stored documents.",display_text:"Chat"})}),(0,l.jsxs)("div",{className:"w-full md:w-fit flex gap-3 justify-end items-center",children:[(0,l.jsx)(j,{title:"Chat",Icon:r.utr,onClick:()=>{p("Chat")},selected:"Chat"===b,disabled:!1,selected_color:"bg-secondary-verba"}),"Demo"!=t&&(0,l.jsx)(j,{title:"Config",Icon:S.KOq,onClick:()=>{p("Config")},selected:"Config"===b,disabled:!1,selected_color:"bg-secondary-verba"})]})]}),(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex flex-col h-[50vh] md:h-full w-full overflow-y-auto overflow-x-hidden relative p-2 md:p-4",children:["Chat"==b&&(0,l.jsxs)("div",{className:"sticky flex flex-col gap-2 top-0 z-9 p-4 backdrop-blur-sm bg-opacity-30 bg-bg-alt-verba rounded-lg",children:[(0,l.jsxs)("div",{className:"flex gap-2 justify-start items-center",children:[(0,l.jsx)("div",{className:"flex gap-2",children:(0,l.jsxs)("div",{className:"dropdown dropdown-hover",children:[(0,l.jsx)("label",{tabIndex:0,children:(0,l.jsx)(j,{title:"Label",className:"btn-sm min-w-min",icon_size:12,text_class_name:"text-xs",Icon:o.Lgw,selected:!1,disabled:!1})}),(0,l.jsx)("ul",{tabIndex:0,className:"dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52",children:V.map((e,t)=>(0,l.jsx)("li",{children:(0,l.jsx)("a",{onClick:()=>{B.includes(e)||q([...B,e]);let t=document.activeElement;t.blur();let s=t.closest(".dropdown");s&&s.blur()},children:e})},"Label"+t))})]})}),(B.length>0||g.length>0)&&(0,l.jsx)(j,{onClick:()=>{q([]),f([])},title:"Clear",className:"btn-sm max-w-min",icon_size:12,text_class_name:"text-xs",Icon:N.B4e,selected:!1,disabled:!1})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[B.map((e,t)=>(0,l.jsx)(j,{title:e,Icon:N.B4e,className:"btn-sm min-w-min max-w-[200px]",icon_size:12,selected_color:"bg-primary-verba",selected:!0,text_class_name:"truncate max-w-[200px]",text_size:"text-xs",onClick:()=>{q(B.filter(t=>t!==e))}},"FilterLabel"+t)),g.map((e,t)=>(0,l.jsx)(j,{title:e.title,Icon:N.B4e,className:"btn-sm min-w-min max-w-[200px]",icon_size:12,selected_color:"bg-primary-verba",selected:!0,text_size:"text-xs",text_class_name:"truncate md:max-w-[100px] lg:max-w-[150px]",onClick:()=>{f(g.filter(t=>t.uuid!==e.uuid))}},"DocumentFilter"+t))]})]}),(0,l.jsxs)("div",{className:"".concat("Chat"===b?"flex flex-col gap-3 p-4":"hidden"),children:[(0,l.jsxs)("div",{className:"flex w-full justify-start items-center text-text-alt-verba gap-2",children:[0===Z&&(0,l.jsx)(C.I2T,{size:15}),0===Z&&(0,l.jsx)("p",{className:"text-text-alt-verba text-sm items-center flex",children:"".concat(Z," documents embedded by ").concat(es)})]}),ee.map((e,t)=>(0,l.jsx)("div",{className:"".concat("user"===e.type?"text-right":""),children:(0,l.jsx)(eo,{message:e,message_index:t,selectedTheme:x,selectedDocument:J,setSelectedDocumentScore:H,setSelectedDocument:n,setSelectedChunkScore:c})},"Message_"+t)),E&&(0,l.jsx)(eo,{message:{type:"system",content:E,cached:!1},message_index:-1,selectedTheme:x,selectedDocument:J,setSelectedDocumentScore:H,setSelectedDocument:n,setSelectedChunkScore:c}),y.current&&(0,l.jsx)("div",{className:"flex flex-col gap-2",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("span",{className:"text-text-alt-verba loading loading-dots loading-md"}),(0,l.jsxs)("p",{className:"text-text-alt-verba",children:["CHUNKS"===w&&"Retrieving...","RESPONSE"===w&&"Generating..."]}),(0,l.jsx)("button",{onClick:()=>{k("DONE"),y.current=!1},className:"btn btn-circle btn-sm bg-bg-alt-verba hover:bg-warning-verba hover:text-text-verba text-text-alt-verba shadow-none border-none text-sm",children:(0,l.jsx)(N.B4e,{size:15})})]})})]}),"Config"===b&&(0,l.jsx)(el,{addStatusMessage:m,production:t,RAGConfig:d,credentials:s,setRAGConfig:u,onReset:eu,onSave:ex})]}),(0,l.jsx)("div",{className:"bg-bg-alt-verba rounded-2xl flex flex-col md:flex-row gap-2 p-4 md:p-6 items-center justify-end h-min w-full",children:"ONLINE"===A?(0,l.jsx)("div",{className:"flex gap-2 items-center justify-end w-full relative",children:(0,l.jsxs)("div",{className:"flex flex-col w-full gap-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("div",{className:"relative w-full",children:[(0,l.jsx)("textarea",{className:"textarea textarea-bordered w-full bg-bg-verba placeholder-text-alt-verb min-h min-h-[40px] max-h-[150px] overflow-y-auto",placeholder:Z>0?Z>=100?"Chatting with more than 100 documents...":"Chatting with ".concat(Z," documents..."):"No documents detected...",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),en())},value:Y,onChange:e=>{let t=e.target.value;X(t),(t.length-1)%3==0&&em()}}),F.length>0&&(0,l.jsx)("ul",{className:"absolute flex gap-2 justify-between top-full left-0 w-full mt-2 z-10 max-h-40 overflow-y-auto",children:F.map((e,t)=>(0,l.jsx)("li",{className:"p-3 bg-button-verba hover:bg-secondary-verba text-text-alt-verba rounded-xl w-full hover:text-text-verba cursor-pointer",onClick:()=>{X(e.query),P([])},children:(0,l.jsx)("p",{className:"text-xs lg:text-sm",children:e.query.length>50?e.query.substring(0,50)+"...":e.query.split(RegExp("(".concat(Y,")"),"gi")).map((e,t)=>e.toLowerCase()===Y.toLowerCase()?(0,l.jsx)("strong",{children:e},t):e)})},t))})]}),(0,l.jsx)(j,{type:"button",Icon:o.OUD,onClick:()=>{en()},disabled:!1,selected_color:"bg-primary-verba"})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center justify-end",children:[(0,l.jsx)(j,{type:"button",Icon:N.Ffb,onClick:()=>{n(null),c([]),X(""),H(null),P([]),et([{type:"system",content:x.intro_message.text}])},disabled:!1,selected_color:"bg-primary-verba"}),(0,l.jsx)(O,{runId:(()=>{if(ee.length>0){let e=ee[ee.length-1];return"system"===e.type&&e.runId?e.runId:""}return""})(),onSubmit:eg})]})]})}):(0,l.jsx)("div",{className:"flex gap-2 items-center justify-end w-full",children:(0,l.jsxs)("button",{onClick:()=>{R(null)},className:"flex btn border-none text-text-verba bg-button-verba hover:bg-button-hover-verba gap-2 items-center",children:[(0,l.jsx)(_.Nwf,{size:15}),(0,l.jsx)("p",{children:"Reconnecting..."}),(0,l.jsx)("span",{className:"loading loading-spinner loading-xs"})]})})})]})},ei=s(68842),ed=s(33149),ex=s(26547),eu=s(20789),em=s(77954),eg=s(97776);let ef=["green","blue","red","yellow","purple","cyan","orange","limegreen","pink","teal","violet","forestgreen","gold","navy","magenta","mediumspringgreen","darkorange","deepskyblue","crimson","lightseagreen","royalblue","chartreuse","mediumorchid","aqua","orangered","mediumaquamarine","plum","lime","dodgerblue","lightcoral","mediumslateblue","lightgreen","darkred","springgreen","lightpink","indigo","lightyellow","mediumvioletred","seagreen","fuchsia","darkseagreen","thistle","orange","powderblue","yellowgreen","cornflowerblue","darkmagenta","darkblue","gold","mediumblue","rosybrown","darkgreen","lightskyblue","mediumseagreen","firebrick","lavender","darkcyan","khaki","mediumturquoise","saddlebrown","lightblue","olive","mintcream","turquoise","rebeccapurple","lightgoldenrodyellow"];function eb(e,t,s){return s===t?0:(e-t)/(s-t)}(0,ei.e)({OrbitControls:ex.z});let eh=e=>{let{vector:t,color:s,setHoverTitle:n,documentTitle:r,multiplication:o,dynamicColor:c,chunk_id:i,chunk_uuid:d,setSelectedChunk:x,selectedChunk:u,minX:m,maxX:g,minY:f,maxY:b,minZ:h,maxZ:p,chunkScores:v}=e,j=(0,a.useRef)(null),y=(0,a.useRef)(!1),w=(0,a.useMemo)(()=>null==v?void 0:v.some(e=>e.uuid===d),[v,d]),N=(0,a.useMemo)(()=>w?new eg.Color("yellow"):u===d?new eg.Color("green"):c?function(e,t,s,l,a,n,r){let o=eb(e.x,t,s),c=eb(e.y,l,a),i=eb(e.z,n,r);return new eg.Color("rgb(".concat(Math.floor(255*o),",").concat(Math.floor(255*c),",").concat(Math.floor(255*i),")"))}(t,m,g,f,b,h,p):new eg.Color(s),[w,u,d,c,s,t,m,g,f,b,h,p]),_=w?3:u===d?1.5:1,S=w?1:y.current?1:.5,C=(0,a.useCallback)(()=>{y.current=!0,n.current("".concat(r," | ").concat(i))},[r,i,n]),k=(0,a.useCallback)(()=>{y.current=!1,n.current(null)},[n]),E=(0,a.useCallback)(()=>{x(d)},[d,x]);return(0,ei.C)(()=>{if(j.current){j.current.position.lerp(new eg.Vector3(t.x*o,t.y*o,t.z*o),.02);let e=j.current.material;e.color.set(y.current?"blue":N),e.opacity=y.current?1:S,e.transparent=!y.current}}),(0,l.jsx)(eu.b,{rotationIntensity:.2,children:(0,l.jsxs)("mesh",{ref:j,position:[0,0,0],onPointerEnter:C,onPointerLeave:k,onClick:E,children:[(0,l.jsx)("sphereGeometry",{args:[_,32,32]}),(0,l.jsx)("meshBasicMaterial",{color:N,opacity:S,transparent:!0})]})})};var ep=e=>{let{credentials:t,selectedDocument:s,production:n,chunkScores:r}=e;(0,a.useRef)([]);let[o,c]=(0,a.useState)(!1),[i,d]=(0,a.useState)([]),[x,u]=(0,a.useState)(""),[m,g]=(0,a.useState)(!1),[f,b]=(0,a.useState)(!0),[h,p]=(0,a.useState)(null),v=(0,a.useRef)(e=>p(e)),[j,y]=(0,a.useState)(200),[w,_]=(0,a.useState)(0),[S,C]=(0,a.useState)(null),[k,E]=(0,a.useState)(null),[I,T]=(0,a.useState)(-1),[O,R]=(0,a.useState)(1),[A,D]=(0,a.useState)(-1),[F,P]=(0,a.useState)(1),[z,M]=(0,a.useState)(-1),[V,G]=(0,a.useState)(1);function W(e){return{min:Math.min(...e),max:Math.max(...e)}}(0,a.useEffect)(()=>{s?U():d([])},[m,s]),(0,a.useEffect)(()=>{S?L():E(null)},[S]);let L=async()=>{try{let e=await H(S,x,t);e&&(""!==e.error?(console.error(e.error),E(null)):E(e.chunk))}catch(e){console.error("Failed to fetch document:",e),c(!1)}},U=async()=>{try{c(!0);let e=await q(s,m,t);if(e){if(""!==e.error)console.error(e.error),c(!1),d([]),_(0),u("None");else if(d(e.vector_groups.groups),u(e.vector_groups.embedder),_(e.vector_groups.dimensions),c(!1),!m){let t=e.vector_groups.groups[0].chunks.map(e=>e.vector.x),s=e.vector_groups.groups[0].chunks.map(e=>e.vector.y),l=e.vector_groups.groups[0].chunks.map(e=>e.vector.z),{min:a,max:n}=W(t);T(a),R(n);let{min:r,max:o}=W(s);D(r),P(o);let{min:c,max:i}=W(l);M(c),G(i)}}}catch(e){console.error("Failed to fetch document:",e),c(!1)}};return(0,l.jsxs)("div",{className:"flex flex-col gap-2 h-full w-full",children:[(0,l.jsx)("div",{className:"flex justify-end w-full gap-2 items-center",children:(0,l.jsxs)("div",{className:"flex w-full items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[o&&(0,l.jsx)("div",{className:"flex items-center justify-center text-text-alt-verba gap-2 h-full",children:(0,l.jsx)("span",{className:"loading loading-spinner loading-xs lg:loading-sm"})}),(0,l.jsx)("p",{className:"text-text-alt-verba text-xs lg:text-sm font-bold",children:"Embedding Model:"}),(0,l.jsx)("p",{className:"text-text-alt-verba text-xs lg:text-sm",children:x})]}),(0,l.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,l.jsx)("p",{className:"text-text-alt-verba text-xs lg:text-sm font-bold",children:"Hover:"}),(0,l.jsx)("p",{className:"text-xs lg:text-sm text-text-alt-verba truncate max-w-[100px] lg:max-w-[300px]",title:null!=h?h:"",children:null!=h?h:""})]}),(0,l.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,l.jsx)("p",{className:"text-text-alt-verba text-xs lg:text-sm font-bold",children:"Vectors:"}),(0,l.jsxs)("p",{className:"text-xs lg:text-sm text-text-alt-verba",children:[i.length," x ",(()=>{let e=0;for(let t of i)e+=t.chunks.length;return e})()," x ",w]})]})]}),(0,l.jsxs)("div",{className:"flex gap-10 items-center justify-between min-w-[20vw]",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:["Demo"!=n&&(0,l.jsxs)("div",{className:"flex gap-2 items-center justify-between",children:[(0,l.jsx)("p",{className:"text-xs text-text-alt-verba",children:"Show All Documents"}),(0,l.jsx)("input",{type:"checkbox",className:"toggle",checked:m,onChange:e=>{g(e.target.checked)}})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center justify-between",children:[(0,l.jsx)("p",{className:"text-xs text-text-alt-verba",children:"Dynamic Coloring"}),(0,l.jsx)("input",{type:"checkbox",className:"toggle",checked:f,onChange:e=>{b(e.target.checked)}})]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,l.jsxs)("div",{className:"dropdown dropdown-bottom flex w-full justify-start items-center",children:[(0,l.jsxs)("button",{tabIndex:0,role:"button",disabled:!0,className:"btn btn-sm bg-button-verba hover:bg-button-hover-verba text-text-verba w-full flex justify-start border-none",children:[(0,l.jsx)(ee.WMq,{size:15}),(0,l.jsx)("p",{children:"PCA"})]}),(0,l.jsx)("ul",{tabIndex:0,className:"dropdown-content menu bg-base-100 rounded-box z-[1] w-full p-2 shadow"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,l.jsx)("p",{className:"text-text-alt-verba text-sm",children:"Zoom"}),(0,l.jsx)("input",{onChange:e=>{y(Number(e.target.value))},type:"range",min:0,max:"1000",value:j,className:"range range-xs grow w-full"})]})]}),k&&(0,l.jsx)("button",{onClick:()=>{E(null),C(null)},className:"flex btn btn-square border-none text-text-verba bg-button-verba hover:bg-warning-verba gap-2",children:(0,l.jsx)(N.B4e,{size:15})})]})]})}),(0,l.jsxs)("div",{className:"flex gap-5 h-[45vh] w-full",children:[(0,l.jsx)("div",{className:"flex flex-grow transition-all duration-300 ease-in-out ".concat(S?"w-2/3":"w-full"," h-full"),children:(0,l.jsxs)(ed.Xz,{children:[(0,l.jsx)("ambientLight",{intensity:1}),(0,l.jsx)(ex.z,{}),(0,l.jsx)(em.c,{makeDefault:!0,position:[0,0,150]}),(0,l.jsx)("axesHelper",{args:[50]}),i.map((e,t)=>e.chunks.map((s,a)=>(0,l.jsx)(eh,{dynamicColor:f,multiplication:j,vector:s.vector,color:function(e){if(!(e>=ef.length))return ef[e];{let e=Math.floor(Math.random()*ef.length);return ef[e]}}(t),setHoverTitle:v,documentTitle:e.name,chunk_id:s.chunk_id,setSelectedChunk:C,selectedChunk:S,chunk_uuid:s.uuid,minX:I,minY:A,minZ:z,maxX:O,maxY:F,maxZ:V,chunkScores:r},"Sphere_"+a+e.name)))]})}),(0,l.jsx)("div",{className:"flex flex-grow transition-all duration-300 ease-in-out ".concat(S?"w-1/3 opacity-100":"w-0 opacity-0"," overflow-auto"),children:k&&(0,l.jsxs)("div",{className:"flex flex-col p-3 gap-2 w-full",children:[(0,l.jsxs)("p",{className:"text-text-alt-verba fond-bold",children:["Chunk ",k.chunk_id]}),(0,l.jsx)("p",{className:"text-text-alt-verba text-sm",children:k.content})]})})]})]})},ev=e=>{let{selectedDocument:t,credentials:s,selectedTheme:n}=e,[o,c]=(0,a.useState)(!1),[i,d]=(0,a.useState)([]),[x,u]=(0,a.useState)(1),[m,g]=(0,a.useState)(0),[f,b]=(0,a.useState)(!0);(0,a.useEffect)(()=>{v(x),b(1===x&&0===m)},[x,m]),(0,a.useEffect)(()=>{v(1),g(0),b(1===x&&0===m)},[t]);let h=async()=>{m===i.length-1?(await v(x+1)?u(e=>e+1):(await v(1),u(1)),g(0)):g(e=>e+1)},p=async()=>{if(0===m){if(x>1){let e=x-1;await v(e)&&(u(e),g(9))}else{let e=x,t=!0;for(;t;)(t=await v(e+1))&&e++;await v(e),u(e),g(i.length-1)}}else g(e=>e-1)},v=async e=>{try{c(!0);let l=await J(t,e,10,s);if(l){if(""===l.error)return d(l.chunks),c(!1),l.chunks.length>0;console.error(l.error),c(!1),d([])}return!1}catch(e){return console.error("Failed to fetch document:",e),c(!1),!1}};return 0==i.length?(0,l.jsx)("div",{children:o&&(0,l.jsx)("div",{className:"flex items-center justify-center text-text-verba gap-2 h-full",children:(0,l.jsx)("span",{className:"loading loading-spinner loading-sm"})})}):(0,l.jsx)("div",{className:"flex flex-col h-full",children:i.length>0&&(0,l.jsxs)("div",{className:"bg-bg-alt-verba flex flex-col rounded-lg overflow-hidden h-full",children:[(0,l.jsxs)("div",{className:"flex-grow overflow-hidden p-3",children:[(0,l.jsx)("div",{className:"flex justify-between mb-2",children:(0,l.jsx)("div",{className:"flex gap-2",children:(0,l.jsxs)("div",{className:"flex gap-2 items-center p-3 bg-secondary-verba rounded-full w-fit",children:[(0,l.jsx)(r.$Kz,{size:12}),(0,l.jsxs)("p",{className:"text-xs flex text-text-verba",children:["Chunk ",i[m].chunk_id]})]})})}),(0,l.jsx)("div",{className:"overflow-y-auto h-[calc(100%-3rem)]",children:(0,l.jsx)(ea.D,{className:"max-w-[50vw] items-center justify-center flex-wrap md:prose-base sm:prose-sm p-3 prose-pre:bg-bg-alt-verba",components:{code(e){let{node:t,inline:s,className:a,children:r,...o}=e,c=/language-(\w+)/.exec(a||"");return!s&&c?(0,l.jsx)(en.Z,{style:"dark"===n.theme?er.vk:er.Yn,language:c[1],PreTag:"div",...o,children:String(r).replace(/\n$/,"")}):(0,l.jsx)("code",{className:a,...o,children:r})}},children:i[m].content})})]}),i.length>1&&(0,l.jsxs)("div",{className:"flex justify-center items-center gap-2 p-3 bg-bg-alt-verba",children:[(0,l.jsx)(j,{title:"Previous Chunk",onClick:p,className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",disabled:f,Icon:S.O18}),(0,l.jsx)(j,{title:"Next Chunk",onClick:h,className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",Icon:S.Rdr})]})]})})},ej=e=>{let{selectedDocument:t,credentials:s}=e,[n,r]=(0,a.useState)(!0),[o,c]=(0,a.useState)(null);(0,a.useEffect)(()=>{i()},[t]);let i=async()=>{try{r(!0);let e=await W(t,s);e&&(""!==e.error?c(null):c(e.document),r(!1))}catch(e){console.error("Failed to fetch document:",e),r(!1)}};return(0,l.jsx)("div",{className:"flex flex-col h-full",children:n?(0,l.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,l.jsx)("span",{className:"loading loading-spinner loading-md text-text-verba bg-text-alt-verba"})}):o&&(0,l.jsxs)("div",{className:"bg-bg-alt-verba flex flex-col rounded-lg overflow-hidden h-full",children:[(0,l.jsxs)("div",{className:"p-4 flex flex-col gap-2 items-start justify-start",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:"Title"}),(0,l.jsx)("p",{className:"text-text-verba truncate max-w-full",title:o.title,children:o.title})]}),(0,l.jsxs)("div",{className:"p-4 flex flex-col gap-2 items-start justify-start",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:"Metadata"}),(0,l.jsx)("p",{className:"text-text-verba max-w-full",children:o.metadata})]}),(0,l.jsxs)("div",{className:"p-4 flex flex-col gap-2 items-start justify-start",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:"Extension"}),(0,l.jsx)("p",{className:"text-text-verba max-w-full",children:o.extension})]}),(0,l.jsxs)("div",{className:"p-4 flex flex-col gap-2 items-start justify-start",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:"File Size"}),(0,l.jsx)("p",{className:"text-text-verba max-w-full",children:o.fileSize})]}),(0,l.jsxs)("div",{className:"p-4 flex flex-col gap-2 items-start justify-start",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:"Source"}),(0,l.jsx)("button",{className:"text-text-verba truncate max-w-full",onClick:()=>window.open(o.source,"_blank"),title:o.source,children:o.source})]}),(0,l.jsxs)("div",{className:"p-4 flex flex-col gap-2 items-start justify-start",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:"Labels"}),(0,l.jsx)("p",{className:"text-text-verba max-w-full",children:o.labels})]})]})})},ey=s(21794),ew=e=>{let{document:t,selectedDocument:s,selectedTheme:n,credentials:o,chunkScores:c}=e,[i,d]=(0,a.useState)(!0),[x,u]=(0,a.useState)(1),[m,g]=(0,a.useState)(1),[f,b]=(0,a.useState)([]),h=(0,a.useRef)(null);(0,a.useEffect)(()=>{t?(p(),u(1)):(b([]),u(1),g(1))},[t,c]),(0,a.useEffect)(()=>{t?p():(b([]),u(1),g(1))},[x]),(0,a.useEffect)(()=>{if(c&&c.length>0){var e;null===(e=h.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}},[f,c]);let p=async()=>{try{d(!0);let e=await B(s,x,c||[],o);e&&(""!==e.error?(b([{content:e.error,chunk_id:0,score:0,type:"text"}]),u(1),g(1)):(b(e.content),g(e.maxPage)),d(!1))}catch(e){console.error("Failed to fetch content from document:",e),d(!1)}},v=(e,t)=>"text"===e.type?(0,l.jsx)("div",{className:"flex p-2",ref:c?null:h,children:(0,l.jsx)(ea.D,{className:"max-w-[50vw] items-center justify-center flex-wrap md:prose-base sm:prose-sm p-3 prose-pre:bg-bg-alt-verba",components:{code(e){let{node:t,inline:s,className:a,children:r,...o}=e,c=/language-(\w+)/.exec(a||"");return!s&&c?(0,l.jsx)(en.Z,{style:"dark"===n.theme?er.vk:er.Yn,language:c[1],PreTag:"div",...o,children:String(r).replace(/\n$/,"")}):(0,l.jsx)("code",{className:a,...o,children:r})}},children:e.content})},"CONTENT_SNIPPET"+t):(0,l.jsxs)("div",{className:"flex p-2 border-2 flex-col gap-2 border-secondary-verba shadow-lg rounded-3xl",ref:h,children:[(0,l.jsx)("div",{className:"flex justify-between",children:(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)("div",{className:"flex gap-2 items-center p-3 bg-secondary-verba rounded-full w-fit",children:[(0,l.jsx)(ey.dvR,{size:12}),(0,l.jsx)("p",{className:"text-xs flex text-text-verba",children:"Context Used"})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center p-3 bg-secondary-verba rounded-full w-fit",children:[(0,l.jsx)(r.$Kz,{size:12}),(0,l.jsxs)("p",{className:"text-xs flex text-text-verba",children:["Chunk ",e.chunk_id+1]})]}),e.score>0&&(0,l.jsxs)("div",{className:"flex gap-2 items-center p-3 bg-primary-verba rounded-full w-fit",children:[(0,l.jsx)(ey.dvR,{size:12}),(0,l.jsx)("p",{className:"text-xs flex text-text-verba",children:"High Relevancy"})]})]})}),(0,l.jsx)(ea.D,{className:"w-full items-center justify-center flex-wrap md:prose-base sm:prose-sm p-3 prose-pre:bg-bg-alt-verba",components:{code(e){let{node:t,inline:s,className:a,children:r,...o}=e,c=/language-(\w+)/.exec(a||"");return!s&&c?(0,l.jsx)(en.Z,{style:"dark"===n.theme?er.vk:er.Yn,language:c[1],PreTag:"div",...o,children:String(r).replace(/\n$/,"")}):(0,l.jsx)("code",{className:a,...o,children:r})}},children:e.content})]});return t?(0,l.jsx)("div",{className:"flex flex-col h-full",children:t&&(0,l.jsxs)("div",{className:"bg-bg-alt-verba flex flex-col rounded-lg overflow-hidden h-full",children:[(0,l.jsx)("div",{className:"p-3 bg-bg-alt-verba",children:(0,l.jsxs)("div",{className:"flex gap-4 w-full justify-between",children:[(0,l.jsxs)("div",{className:"flex gap-4 items-center",children:[i&&(0,l.jsx)("div",{className:"flex items-center justify-center text-text-verba gap-2",children:(0,l.jsx)("span",{className:"loading loading-spinner loading-sm"})}),(0,l.jsx)("p",{className:"text-lg font-bold truncate max-w-[350px]",title:t.title,children:t.title})]}),(0,l.jsx)("div",{className:"gap-2 flex flex-wrap",children:Object.entries(t.labels).map(e=>{let[s,a]=e;return(0,l.jsx)(j,{title:a,text_size:"text-xs",text_class_name:"truncate max-w-[200px]",className:"btn-sm min-w-min max-w-[200px]"},t.title+s+a)})})]})}),(0,l.jsx)("div",{className:"flex-grow overflow-hidden p-3",children:(0,l.jsx)("div",{className:"overflow-y-auto h-full",children:f&&f.map((e,t)=>v(e,t))})}),(0,l.jsxs)("div",{className:"flex justify-center items-center gap-2 p-3 bg-bg-alt-verba",children:[(0,l.jsx)(j,{title:"Previous "+(c?"Chunk":"Page"),onClick:()=>{1==x?u(m):u(e=>e-1)},className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",Icon:S.O18}),(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsxs)("p",{className:"text-xs text-text-verba",children:[c?"Chunk ":"Page "," ",x]})}),(0,l.jsx)(j,{title:"Next "+(c?"Chunk":"Page"),onClick:()=>{x==m?u(1):u(e=>e+1)},className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",Icon:S.Rdr})]})]})}):(0,l.jsx)("div",{})},eN=e=>{let{credentials:t,selectedDocument:s,setSelectedDocument:n,chunkScores:r,production:c,selectedTheme:i,documentFilter:d,setDocumentFilter:x,addStatusMessage:u}=e,[m,g]=(0,a.useState)("Content"),[f,b]=(0,a.useState)(!1),[h,p]=(0,a.useState)(null);(0,a.useEffect)(()=>{s?y():p(null)},[s]);let v=e=>{window.open(e,"_blank","noopener,noreferrer")},y=async()=>{try{b(!0);let e=await W(s,t);e&&(""!==e.error?(console.error(e.error),b(!1),p(null),n(null)):(p(e.document),b(!1)))}catch(e){console.error("Failed to fetch document:",e),b(!1)}};return s?(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex gap-2 p-6 items-center justify-end lg:justify-between h-min w-full",children:[(0,l.jsx)("div",{className:"hidden lg:flex gap-2 justify-start ",children:(0,l.jsx)(Q,{tooltip_text:"Inspect your all information about your document, such as chunks, metadata and more.",display_text:h?h.title:"Loading..."})}),(0,l.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,l.jsx)(j,{title:"Content",Icon:N.Vqr,onClick:()=>g("Content"),selected:"Content"===m,selected_color:"bg-secondary-verba"}),(0,l.jsx)(j,{title:"Chunks",Icon:N.Fqs,onClick:()=>g("Chunks"),selected:"Chunks"===m,selected_color:"bg-secondary-verba"}),(0,l.jsx)(j,{title:"Vector",Icon:_.FUn,onClick:()=>g("Vector Space"),selected:"Vector Space"===m,selected_color:"bg-secondary-verba"}),(0,l.jsx)(j,{Icon:N.B4e,onClick:()=>{n(null)}})]})]}),(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex flex-col p-6 h-full w-full overflow-y-auto overflow-x-hidden",children:["Content"===m&&(0,l.jsx)(ew,{selectedTheme:i,document:h,credentials:t,selectedDocument:s,chunkScores:r}),"Chunks"===m&&(0,l.jsx)(ev,{selectedTheme:i,credentials:t,selectedDocument:s}),"Vector Space"===m&&(0,l.jsx)(ep,{credentials:t,selectedDocument:s,chunkScores:r,production:c}),"Metadata"===m&&(0,l.jsx)(ej,{credentials:t,selectedDocument:s})]}),(0,l.jsxs)("div",{className:"bg-bg-alt-verba rounded-2xl flex gap-2 p-6 items-center justify-between h-min w-full",children:[(0,l.jsxs)("div",{className:"flex gap-3",children:[d.some(e=>e.uuid===s)&&(0,l.jsx)(j,{title:"Delete from Chat",Icon:N.B4e,selected:!0,selected_color:"bg-warning-verba",onClick:()=>{x(d.filter(e=>e.uuid!==s)),u("Removed document from Chat","INFO")}}),!d.some(e=>e.uuid===s)&&h&&(0,l.jsx)(j,{title:"Add to Chat",Icon:o.Lgw,onClick:()=>{x([...d,{uuid:s,title:h.title}]),u("Added document to Chat","SUCCESS")}})]}),(0,l.jsxs)("div",{className:"flex gap-3",children:[s&&h&&h.source&&(0,l.jsx)(j,{title:"Go To Source",Icon:S.CkN,onClick:()=>{v(h.source)}}),(0,l.jsx)(j,{title:"Document Info",Icon:S.DAO,onClick:()=>g("Metadata"),selected:"Metadata"===m,selected_color:"bg-secondary-verba"})]})]})]}):(0,l.jsx)("div",{})},e_=e=>{let{credentials:t,selectedTheme:s,addStatusMessage:n,production:r,currentPage:o,RAGConfig:c,setRAGConfig:i,documentFilter:d,setDocumentFilter:x}=e,[u,m]=(0,a.useState)(null),[g,f]=(0,a.useState)([]);return(0,l.jsxs)("div",{className:"flex md:flex-row flex-col justify-center gap-3 h-[50vh] md:h-[80vh] ",children:[(0,l.jsx)("div",{className:"".concat(u?"hidden md:flex md:w-[45vw]":"w-full md:w-[45vw] md:flex"),children:(0,l.jsx)(ec,{addStatusMessage:n,production:r,credentials:t,selectedTheme:s,setSelectedDocument:m,setSelectedChunkScore:f,currentPage:o,RAGConfig:c,setRAGConfig:i,documentFilter:d,setDocumentFilter:x})}),(0,l.jsx)("div",{className:"".concat(u?"md:w-[55vw] w-full flex":"hidden md:flex md:w-[55vw]"),children:(0,l.jsx)(eN,{addStatusMessage:n,credentials:t,production:r,documentFilter:d,setDocumentFilter:x,setSelectedDocument:m,selectedTheme:s,selectedDocument:u,chunkScores:g})})]})},eS=s(22034);let eC={theme_name:"Light",title:{text:"Verba",type:"text",description:"Title"},subtitle:{text:"The Golden RAGtriever",type:"text",description:"Subtitle"},intro_message:{text:"Welcome to Verba, your open-source RAG application!",type:"text",description:"First Message"},image:{src:"https://github.com/weaviate/Verba/blob/main/img/verba_icon.png?raw=true",type:"image",description:"Logo"},primary_color:{color:"#FDFF91",type:"color",description:"Primary"},secondary_color:{color:"#90FFA8",type:"color",description:"Secondary"},warning_color:{color:"#FF8399",type:"color",description:"Warning"},bg_color:{color:"#FEF7F7",type:"color",description:"Background"},bg_alt_color:{color:"#FFFFFF",type:"color",description:"Alt. Background"},text_color:{color:"#161616",type:"color",description:"Text"},text_alt_color:{color:"#8E8E8E",type:"color",description:"Alt. Text"},button_text_color:{color:"#161616",type:"color",description:"Button Text"},button_text_alt_color:{color:"#8E8E8E",type:"color",description:"Button Alt. Text"},button_color:{color:"#EFEFEF",type:"color",description:"Button"},button_hover_color:{color:"#DCDCDC",type:"color",description:"Button Hover"},font:{value:"Plus_Jakarta_Sans",type:"select",options:["Inter","Plus_Jakarta_Sans","Open_Sans","PT_Mono"],description:"Text Font"},theme:"light"},ek={...eC,theme_name:"Dark",title:{...eC.title,text:"Verba"},subtitle:{...eC.subtitle,text:"The Dark RAGtriever"},intro_message:{...eC.intro_message,text:"Welcome to Verba, your open-source RAG application!"},image:{...eC.image,src:"https://github.com/weaviate/Verba/blob/main/img/verba_icon.png?raw=true"},primary_color:{...eC.primary_color,color:"#BB86FC"},secondary_color:{...eC.secondary_color,color:"#008F82"},warning_color:{...eC.warning_color,color:"#FF8399"},bg_color:{...eC.bg_color,color:"#202020"},bg_alt_color:{...eC.bg_alt_color,color:"#2F2929"},text_color:{...eC.text_color,color:"#ffffff"},text_alt_color:{...eC.text_alt_color,color:"#999999"},button_text_color:{...eC.button_text_color,color:"#ffffff"},button_text_alt_color:{...eC.button_text_alt_color,color:"#999999"},button_color:{...eC.button_color,color:"#3C3C3C"},button_hover_color:{...eC.button_hover_color,color:"#2C2C2C"},font:{...eC.font,value:"Open_Sans"},theme:"dark"},eE={...eC,theme_name:"WCD",title:{...eC.title,text:"Verba"},subtitle:{...eC.subtitle,text:"Weaviate Chatbot"},intro_message:{...eC.intro_message,text:"Welcome to Verba, your open-source RAG application!"},image:{...eC.image,src:"https://github.com/weaviate/Verba/blob/1.0.0/frontend/public/weaviate.png?raw=true"},primary_color:{...eC.primary_color,color:"#BF40C5"},secondary_color:{...eC.secondary_color,color:"#28395B"},warning_color:{...eC.warning_color,color:"#EA3A31"},bg_color:{...eC.bg_color,color:"#0C1428"},bg_alt_color:{...eC.bg_alt_color,color:"#192136"},text_color:{...eC.text_color,color:"#ffffff"},text_alt_color:{...eC.text_alt_color,color:"#AAAAAA"},button_text_color:{...eC.button_text_color,color:"#ffffff"},button_text_alt_color:{...eC.button_text_alt_color,color:"#AAAAAA"},button_color:{...eC.button_color,color:"#1D253A"},button_hover_color:{...eC.button_hover_color,color:"#313749"},font:{...eC.font,value:"Open_Sans"},theme:"dark"},eI={...eC,theme_name:"Weaviate",title:{...eC.title,text:"Verba"},subtitle:{...eC.subtitle,text:"Weaviate Chatbot"},intro_message:{...eC.intro_message,text:"Welcome to Verba, your open-source RAG application!"},image:{...eC.image,src:"https://github.com/weaviate/Verba/blob/1.0.0/frontend/public/weaviate.png?raw=true"},primary_color:{...eC.primary_color,color:"#9bfc88"},secondary_color:{...eC.secondary_color,color:"#8bffe7"},warning_color:{...eC.warning_color,color:"#f77579"},bg_color:{...eC.bg_color,color:"#FEF7F7"},bg_alt_color:{...eC.bg_alt_color,color:"#ffffff"},text_color:{...eC.text_color,color:"#130C49"},text_alt_color:{...eC.text_alt_color,color:"#929292"},button_text_color:{...eC.button_text_color,color:"#130C49"},button_text_alt_color:{...eC.button_text_alt_color,color:"#929292"},button_color:{...eC.button_color,color:"#eeeeee"},button_hover_color:{...eC.button_hover_color,color:"#7dfffb"},font:{...eC.font,value:"Plus_Jakarta_Sans"},theme:"light"};var eT=s(73478),eO=e=>{let{selectedTheme:t,setThemes:s,credentials:n,setSelectedTheme:r,themes:o,addStatusMessage:c}=e,[i,d]=(0,a.useState)(""),x=async()=>{await V(o,t,n),c("Changes to ".concat(t.theme_name," saved"),"SUCCESS")},u=(e,t)=>{r(s=>{let l=s[e];if("text"===l.type)return{...s,[e]:{...l,text:t}};if("image"===l.type)return{...s,[e]:{...l,src:t}};if("check"===l.type)return{...s,[e]:{...l,checked:t}};if("color"===l.type)return{...s,[e]:{...l,color:t}};if("select"===l.type)return{...s,[e]:{...l,value:t}};if("number"===l.type)return{...s,[e]:{...l,value:t}};return s})};(0,a.useEffect)(()=>{s(e=>{let s={...e};return s[t.theme_name]=t,s})},[t]);let m=(e,t)=>{if(t.target.files&&t.target.files[0]){let s=new FileReader;s.onload=t=>{var s;"string"==typeof(null===(s=t.target)||void 0===s?void 0:s.result)&&u(e,t.target.result)},s.readAsDataURL(t.target.files[0])}},g=(e,s)=>(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"flex gap-3 justify-between items-center text-text-verba",children:[(0,l.jsx)("p",{className:"flex min-w-[8vw]",children:s.description}),"text"===s.type&&(0,l.jsx)("label",{className:"input flex items-center gap-2 w-full border-none bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow w-full",placeholder:e,value:t[e].text,onChange:t=>u(e,t.target.value)})}),"select"===s.type&&(0,l.jsx)("select",{value:t[e].value,onChange:t=>{u(e,t.target.value)},className:"select bg-bg-verba",children:s.options.map(e=>(0,l.jsx)("option",{value:e,children:e},"Select_"+e))}),"color"===s.type&&(0,l.jsxs)("div",{className:"flex flex-col gap-1 h-[15vh] z-10",children:[(0,l.jsx)("label",{className:"input bg-bg-verba input-sm input-bordered flex items-center gap-2 w-full",children:(0,l.jsx)("input",{type:"text",className:"grow",placeholder:e,value:t[e].color,onChange:t=>{u(e,t.target.value)}})}),(0,l.jsx)(eT.gW,{color:t[e].color,className:"z-1",onChange:t=>{u(e,t)}})]}),"image"===s.type&&(0,l.jsxs)("div",{className:"flex justify-between gap-4 w-full items-center",children:[(0,l.jsx)("div",{className:"flex-grow",children:(0,l.jsx)("label",{className:"input flex items-center text-text-verba gap-2 w-full border-none bg-bg-verba",children:(0,l.jsx)("input",{type:"text",className:"grow",placeholder:"Enter image URL",value:i,onChange:e=>d(e.target.value)})})}),(0,l.jsxs)("div",{className:"flex justify-between items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)(j,{title:"Set Link",onClick:()=>u(e,i)}),(0,l.jsx)(j,{title:"Upload Image",onClick:()=>{var t;return null===(t=document.getElementById("".concat(e,"ImageInput")))||void 0===t?void 0:t.click()}}),(0,l.jsx)("input",{id:"".concat(e,"ImageInput"),type:"file",accept:"image/*",onChange:t=>m(e,t),className:"hidden"})]}),t[e].src&&(0,l.jsx)("img",{src:t[e].src,alt:"".concat(e," preview"),className:"max-w-full max-h-32 rounded-xl"})]})]})]})},e);return(0,l.jsxs)("div",{className:"flex flex-col w-full h-full p-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("p",{className:"text-2xl font-bold",children:"Customize Theme"}),(0,l.jsx)("select",{className:"select bg-bg-verba",value:Object.keys(o).find(e=>o[e]===t)||"",onChange:e=>r(o[e.target.value]),children:Object.keys(o).map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsx)("div",{className:"flex-grow overflow-y-auto",children:(0,l.jsxs)("div",{className:"gap-4 flex flex-col p-4",children:[(0,l.jsx)("p",{className:"font-bold",children:"Customize Logo"}),Object.entries(t).filter(e=>{let[t,s]=e;return"image"===s.type}).map(e=>{let[t,s]=e;return g(t,s)}),(0,l.jsx)("p",{className:"font-bold mt-4",children:"Customize Text"}),Object.entries(t).filter(e=>{let[t,s]=e;return"text"===s.type}).map(e=>{let[t,s]=e;return g(t,s)}),(0,l.jsx)("p",{className:"font-bold mt-4",children:"Customize Font"}),Object.entries(t).filter(e=>{let[t,s]=e;return"select"===s.type}).map(e=>{let[t,s]=e;return g(t,s)}),(0,l.jsx)("p",{className:"font-bold mt-4",children:"Customize Color"}),Object.entries(t).filter(e=>{let[t,s]=e;return"color"===s.type}).map(e=>{let[t,s]=e;return g(t,s)})]})}),(0,l.jsxs)("div",{className:"flex justify-end gap-2 mt-3",children:[(0,l.jsx)(j,{title:"Save",onClick:x,className:"max-w-min",Icon:S.FJM}),(0,l.jsx)(j,{title:"Reset",onClick:()=>{s({Light:eC,Dark:ek,Weaviate:eI,WCD:eE}),r(eI),c("Themes reset","SUCCESS")},className:"max-w-min",Icon:N.B4e})]})]})},eR=e=>{let{title:t,modal_id:s,text:a,triggerAccept:n,triggerString:r,triggerValue:o}=e;return(0,l.jsx)("dialog",{id:s,className:"modal",children:(0,l.jsxs)("div",{className:"modal-box flex flex-col gap-2",children:[(0,l.jsx)("h3",{className:"font-bold text-lg",children:t}),(0,l.jsx)("p",{className:"whitespace-pre-wrap",children:a}),(0,l.jsx)("div",{className:"modal-action",children:(0,l.jsxs)("form",{method:"dialog",className:"flex gap-2",children:[n&&r&&(0,l.jsx)(j,{type:"submit",title:r,onClick:()=>{n(o)}}),(0,l.jsx)(j,{type:"submit",title:"Cancel",selected_color:"bg-warning-verba",selected:!0})]})})]})})},eA=s(80624),eD=s(59743),eF=e=>{let{credentials:t,addStatusMessage:s}=e,[n,o]=(0,a.useState)(1),[c,i]=(0,a.useState)([]),[d,x]=(0,a.useState)(0),u=async()=>{let e=await X(n,20,t);e&&(i(e.suggestions),x(e.total_count))};(0,a.useEffect)(()=>{u()},[]),(0,a.useEffect)(()=>{u()},[n]);let m=e=>{let t=document.getElementById(e);t instanceof HTMLDialogElement&&t.showModal()},g=e=>{try{let t=(0,eA.D)(e);return(0,eD.Q)(t,{addSuffix:!0})}catch(e){return console.error("Error parsing timestamp:",e),"Invalid date"}},f=async e=>{await Y(e,t),await u(),s("Suggestion deleted","SUCCESS")},b=e=>{navigator.clipboard.writeText(e).then(()=>{console.log("Copied to clipboard")})};return(0,l.jsxs)("div",{className:"flex flex-col w-full h-full p-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsxs)("p",{className:"text-2xl font-bold",children:["Manage Suggestions (",d,")"]}),(0,l.jsx)(j,{title:"Refresh",className:"max-w-min",onClick:()=>{u()},Icon:r.A$d})]}),(0,l.jsx)("div",{className:"flex-grow overflow-y-auto",children:(0,l.jsx)("div",{className:"gap-4 flex flex-col p-4 text-text-verba",children:(0,l.jsx)("div",{className:"flex flex-col gap-2",children:c.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2 p-4 border-2 bg-bg-alt-verba rounded-xl",children:[(0,l.jsxs)("div",{className:"flex flex-col items-start justify-start gap-2 w-2/3",children:[(0,l.jsx)("p",{className:"font-bold flex text-xs text-start text-text-alt-verba",children:g(e.timestamp)}),(0,l.jsx)("p",{className:"text-sm text-text-verba truncate max-w-full",title:e.query,children:e.query})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(j,{onClick:()=>b(e.query),Icon:r.On2}),(0,l.jsx)(j,{onClick:()=>m("remove_suggestion"+e.uuid),Icon:r.VOs})]}),(0,l.jsx)(eR,{modal_id:"remove_suggestion"+e.uuid,title:"Remove Suggestion",text:"Do you want to remove this suggestion?",triggerString:"Delete",triggerValue:e.uuid,triggerAccept:f})]},"Suggestion"+e.uuid))})})}),c.length>0&&(0,l.jsxs)("div",{className:"flex justify-center items-center gap-2 p-3 bg-bg-alt-verba",children:[(0,l.jsx)(j,{title:"Previous Page",onClick:()=>{1==n?o(1):o(e=>e-1)},className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",Icon:S.O18}),(0,l.jsxs)("p",{className:"text-xs flex text-text-verba",children:["Page ",n]}),(0,l.jsx)(j,{title:"Next Page",onClick:()=>{20*n<=d?o(e=>e+1):o(1)},className:"btn-sm min-w-min max-w-[200px]",text_class_name:"text-xs",Icon:S.Rdr})]})]})},eP=e=>{let{credentials:t,addStatusMessage:s}=e,[n,o]=(0,a.useState)(null),[c,i]=(0,a.useState)(!1),[d,x]=(0,a.useState)(null),u=async()=>{i(!0);let e=await K(t);(null==e?void 0:e.error)===""&&(o(e.node_payload),x(e.collection_payload)),i(!1)};(0,a.useEffect)(()=>{i(!0),u(),i(!1)},[]);let m=async()=>{await Z("DOCUMENTS",t)?(s("All documents reset","SUCCESS"),u()):s("Failed to reset documents","ERROR")},g=async()=>{await Z("ALL",t)?(s("Verba reset","SUCCESS"),u()):s("Failed to reset Verba","ERROR")},f=async()=>{await Z("CONFIG",t)?(s("Config reset","SUCCESS"),u()):s("Failed to reset config","ERROR")},b=async()=>{await Z("SUGGESTIONS",t)?(s("Suggestions reset","SUCCESS"),u()):s("Failed to reset suggestions","ERROR")},h=e=>{let t=document.getElementById(e);t instanceof HTMLDialogElement&&t.showModal()};return(0,l.jsxs)("div",{className:"flex flex-col w-full h-full p-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("p",{className:"text-2xl font-bold",children:"Admin Panel"}),(0,l.jsx)(j,{title:"Refresh",loading:c,onClick:u,className:"max-w-min",Icon:r.A$d})]}),(0,l.jsx)("div",{className:"flex-grow overflow-y-auto",children:(0,l.jsxs)("div",{className:"gap-4 flex flex-col p-4 text-text-verba",children:[(0,l.jsx)("p",{className:"font-bold text-lg",children:"Resetting Verba"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2 justify-between",children:(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsx)(j,{title:"Clear Documents",onClick:()=>h("reset-documents"),Icon:r.emU}),(0,l.jsx)(j,{title:"Clear Config",onClick:()=>h("reset-configs"),Icon:S.LDL}),(0,l.jsx)(j,{title:"Clear Everything",onClick:()=>h("reset-verba"),Icon:r.VOs}),(0,l.jsx)(j,{title:"Clear Suggestions",onClick:()=>h("reset-suggestions"),Icon:r.VOs})]})}),(0,l.jsx)("p",{className:"font-bold text-lg",children:"Weaviate Information"}),(0,l.jsxs)("div",{className:"flex flex-col border-2 gap-2 border-bg-verba shadow-sm p-4 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm lg:text-base font-semibold text-text-alt-verba",children:"Connected to"}),(0,l.jsx)("p",{className:"   text-text-verba",children:t.url})]}),(0,l.jsxs)("div",{className:"flex flex-col border-2 gap-2 border-bg-verba shadow-sm p-4 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm lg:text-base font-semibold text-text-alt-verba",children:"Deployment"}),(0,l.jsx)("p",{className:" text-text-verba",children:t.deployment})]}),(0,l.jsxs)("div",{className:"flex flex-col border-2 gap-2 border-secondary-verba shadow-sm p-4 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm lg:text-base font-semibold text-text-alt-verba",children:"Version"}),n?(0,l.jsx)("p",{className:"text-text-verba",children:n.weaviate_version}):(0,l.jsx)("span",{className:"loading loading-spinner loading-sm"})]}),(0,l.jsxs)("div",{className:"flex flex-col border-2 border-bg-verba shadow-sm p-4 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)("p",{className:"text-text-alt-verba text-sm lg:text-base font-semibold",children:"Nodes"}),n?(0,l.jsx)("p",{className:"text-text-alt-verba text-sm lg:text-base font-semibold",children:n.node_count}):(0,l.jsx)("span",{className:"loading loading-spinner loading-sm"})]}),n?(0,l.jsx)("ul",{className:"flex flex-col mt-2 list-disc list-inside",children:n.nodes.map(e=>(0,l.jsxs)("li",{className:"text-sm text-text-verba flex justify-between",children:[(0,l.jsx)("span",{className:"w-64 truncate",children:e.name}),(0,l.jsxs)("span",{children:["(",e.status," - ",e.shards," shards)"]})]},"Node"+e.name))}):(0,l.jsx)("span",{className:"loading loading-dots loading-sm mt-2"})]}),(0,l.jsxs)("div",{className:"flex flex-col border-2 border-bg-verba shadow-sm p-4 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)("p",{className:"text-text-alt-verba text-sm lg:text-base font-semibold",children:"Collections"}),d?(0,l.jsx)("p",{className:"text-text-alt-verba text-sm lg:text-base font-semibold",children:d.collection_count}):(0,l.jsx)("span",{className:"loading loading-spinner loading-sm"})]}),d?(0,l.jsx)("ul",{className:"flex flex-col mt-2 list-disc list-inside",children:d.collections.map(e=>(0,l.jsxs)("li",{className:"text-sm text-text-verba flex justify-between",children:[(0,l.jsx)("span",{className:"w-128 truncate",children:e.name}),(0,l.jsxs)("span",{children:[e.count," objects"]})]},"Collection"+e.name))}):(0,l.jsx)("span",{className:"loading loading-dots loading-sm mt-2"})]})]})}),(0,l.jsx)(eR,{modal_id:"reset-documents",title:"Reset Documents",text:"Are you sure you want to reset all documents? This will clear all documents and chunks from Verba.",triggerAccept:m,triggerString:"Reset"}),(0,l.jsx)(eR,{modal_id:"reset-configs",title:"Reset Config",text:"Are you sure you want to reset the config?",triggerAccept:f,triggerString:"Reset"}),(0,l.jsx)(eR,{modal_id:"reset-verba",title:"Reset Verba",text:"Are you sure you want to reset Verba? This will delete all collections related to Verba.",triggerAccept:g,triggerString:"Reset"}),(0,l.jsx)(eR,{modal_id:"reset-suggestions",title:"Reset Suggestions",text:"Are you sure you want to reset all autocomplete suggestions?",triggerAccept:b,triggerString:"Reset"})]})},ez=e=>{let{selectedTheme:t,themes:s,setThemes:n,addStatusMessage:o,setSelectedTheme:c,credentials:i}=e,[d,x]=(0,a.useState)("INFO");return console.log("Selected Theme in SettingsView:",t),console.log("Available Themes:",s),(0,l.jsxs)("div",{className:"flex justify-center gap-3 h-[80vh] ",children:[(0,l.jsx)("div",{className:"w-1/3 flex",children:(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,l.jsx)("div",{className:"bg-bg-alt-verba rounded-2xl flex gap-2 p-6 items-center justify-between h-min w-full",children:(0,l.jsx)("div",{className:"flex gap-2 justify-start ",children:(0,l.jsx)(Q,{tooltip_text:"Customize Verba's Theme, reset collections, logout or report issues.",display_text:"Settings"})})}),(0,l.jsxs)("div",{className:"bg-bg-alt-verba gap-2 rounded-2xl flex flex-col p-6 w-full overflow-y-auto overflow-x-hidden",children:[(0,l.jsx)(j,{title:"Admin",onClick:()=>x("INFO"),selected:"INFO"===d,selected_color:"bg-secondary-verba",Icon:eS.Xn2}),(0,l.jsx)(j,{title:"Customize Theme",onClick:()=>x("THEME"),selected:"THEME"===d,selected_color:"bg-secondary-verba",Icon:S._TT}),(0,l.jsx)(j,{title:"Manage Suggestions",onClick:()=>x("SUGGESTIONS"),selected:"SUGGESTIONS"===d,selected_color:"bg-secondary-verba",Icon:r.aTL})]}),(0,l.jsxs)("div",{className:"bg-bg-alt-verba gap-2 rounded-2xl flex flex-col p-6 w-full overflow-y-auto overflow-x-hidden",children:[(0,l.jsx)(j,{title:"Logout",onClick:()=>window.location.reload(),Icon:r.p$f}),(0,l.jsx)(j,{title:"Report Issue",onClick:()=>window.open("https://github.com/weaviate/Verba/issues/new/choose","_blank"),Icon:C.N3m})]})]})}),(0,l.jsx)("div",{className:"w-2/3 flex",children:(0,l.jsx)("div",{className:"flex flex-col gap-2 w-full",children:(0,l.jsxs)("div",{className:"bg-bg-alt-verba gap-2 rounded-2xl flex flex-col p-6 h-full w-full overflow-y-auto overflow-x-hidden",children:["THEME"===d&&(0,l.jsx)(eO,{themes:s,credentials:i,setThemes:n,setSelectedTheme:c,selectedTheme:t,addStatusMessage:o}),"INFO"===d&&(0,l.jsx)(eP,{addStatusMessage:o,credentials:i}),"SUGGESTIONS"===d&&(0,l.jsx)(eF,{credentials:i,addStatusMessage:o})]})})})]})},eM=s(34446),eV=s(24635),eG=s(54018),eW=e=>{let{status_messages:t,set_status_messages:s}=e,[n,o]=(0,a.useState)([]);(0,a.useEffect)(()=>{t.length>0&&(o(e=>[...e,...t]),s([]));let e=setInterval(()=>{let e=new Date().getTime();o(t=>t.filter(t=>e-new Date(t.timestamp).getTime()<5e3))},1e3);return()=>clearInterval(e)},[t,s]);let c=e=>{switch(e){case"INFO":default:return"bg-button-verba";case"WARNING":return"bg-secondary-verba";case"SUCCESS":return"bg-primary-verba";case"ERROR":return"bg-warning-verba"}},i=e=>{switch(e){case"INFO":default:return(0,l.jsx)(C.hCA,{size:15});case"WARNING":return(0,l.jsx)(r.OvZ,{size:15});case"SUCCESS":return(0,l.jsx)(eG.vuX,{size:15});case"ERROR":return(0,l.jsx)(C.yZ3,{size:15})}};return(0,l.jsx)("div",{className:"fixed bottom-4 right-4 space-y-2",children:(0,l.jsx)(eM.M,{children:n.filter(e=>{let t=new Date(e.timestamp).getTime();return new Date().getTime()-t<5e3}).map((e,t)=>(0,l.jsx)(eV.E.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},className:"".concat(c(e.type)," text-text-verba p-4 min-w-[300px] rounded-lg z-10 shadow-md"),children:(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[i(e.type),(0,l.jsx)("p",{className:"text-xs font-bold",children:e.type})]}),(0,l.jsx)("p",{className:"text-base",children:e.message})]})},t))})})},eL=s(49767);function eU(){let[e,t]=(0,a.useState)("CHAT"),[s,r]=(0,a.useState)("Production"),[o,c]=(0,a.useState)(""),[i,d]=(0,a.useState)({Light:eC,Dark:ek,Weaviate:eI,WCD:eE}),[x,u]=(0,a.useState)(i.WCD),[m,g]=(0,a.useState)(!1),[f,b]=(0,a.useState)(!1),[h,p]=(0,a.useState)(!1),[v,j]=(0,a.useState)({deployment:"Weaviate",url:eL.env.WEAVIATE_URL_VERBA||"",key:eL.env.WEAVIATE_API_KEY_VERBA||""}),[y,N]=(0,a.useState)(null),[_,S]=(0,a.useState)([]),[C,k]=(0,a.useState)([]),E=(e,t)=>{let s={message:e,timestamp:new Date().toISOString(),type:t};k(e=>[...e,s])},I=(0,a.useCallback)(async()=>{try{let[e]=await Promise.all([F()]);e?(r(e.production),c(e.gtag),g(!0),j({deployment:"Weaviate",url:e.deployments.WEAVIATE_URL_VERBA,key:e.deployments.WEAVIATE_API_KEY_VERBA})):(console.warn("Could not retrieve health data"),g(!1),b(!1))}catch(e){console.error("Error during initial fetch:",e),g(!1),b(!1)}},[]);(0,a.useEffect)(()=>{I()},[]),(0,a.useEffect)(()=>{if(f){let e=setTimeout(()=>{p(!0)},1e3);return()=>clearTimeout(e)}},[f]);let T=async()=>{let e=await P(v.deployment,v.url,v.key);e&&(e.error?(b(!1),console.error(e.error)):(b(!0),N(e.rag_config),e.themes&&d(e.themes),e.theme&&u(e.theme)))};(0,a.useEffect)(()=>{m&&T()},[m]);let O=(0,a.useCallback)(()=>{Object.entries({"--primary-verba":x.primary_color.color,"--secondary-verba":x.secondary_color.color,"--warning-verba":x.warning_color.color,"--bg-verba":x.bg_color.color,"--bg-alt-verba":x.bg_alt_color.color,"--text-verba":x.text_color.color,"--text-alt-verba":x.text_alt_color.color,"--button-verba":x.button_color.color,"--button-hover-verba":x.button_hover_color.color,"--text-verba-button":x.button_text_color.color,"--text-alt-verba-button":x.button_text_alt_color.color}).forEach(e=>{let[t,s]=e;document.documentElement.style.setProperty(t,s)})},[x]);return(0,a.useEffect)(()=>{O()},[x]),(0,l.jsxs)("main",{className:"min-h-screen bg-bg-verba text-text-verba min-w-screen ".concat("default-font-class"),"data-theme":x.theme,children:[""!==o&&(0,l.jsx)(n.GoogleAnalytics,{gaId:o}),(0,l.jsx)(eW,{status_messages:C,set_status_messages:k}),f&&m&&(0,l.jsxs)("div",{className:"transition-opacity duration-1000 ".concat(h?"opacity-100":"opacity-0"," flex flex-col gap-2 p-5"),children:[(0,l.jsx)(w,{production:s,title:x.title.text,subtitle:x.subtitle.text,imageSrc:x.image.src,version:"v2.0.0",currentPage:e,setCurrentPage:t}),(0,l.jsx)("div",{className:"".concat("CHAT"===e?"":"hidden"),children:(0,l.jsx)(e_,{addStatusMessage:E,credentials:v,RAGConfig:y,setRAGConfig:N,production:s,selectedTheme:x,currentPage:e,documentFilter:_,setDocumentFilter:S})}),(0,l.jsx)("div",{className:"".concat("SETTINGS"===e?"":"hidden"),children:(0,l.jsx)(ez,{selectedTheme:x,setSelectedTheme:u,themes:i,setThemes:d,credentials:v,addStatusMessage:E})})]})]})}}},function(e){e.O(0,[596,689,370,465,929,582,190,400,61,682,306,420,115,176,971,23,744],function(){return e(e.s=47332)}),_N_E=e.O()}]);